{
  "version": 3,
  "sources": ["../worker/node_modules/wrangler/_virtual_unenv_global_polyfill-clear$immediate.js", "../worker/node_modules/unenv/runtime/_internal/utils.mjs", "../worker/node_modules/unenv/runtime/mock/noop.mjs", "../worker/node_modules/unenv/runtime/node/timers/internal/immediate.mjs", "../worker/node_modules/unenv/runtime/node/timers/internal/set-immediate.mjs", "../worker/node_modules/wrangler/_virtual_unenv_global_polyfill-set$immediate.js", "../worker/node_modules/unenv/runtime/node/console/index.mjs", "../worker/node_modules/unenv/runtime/mock/proxy.mjs", "../worker/node_modules/unenv/runtime/node/console/$cloudflare.mjs", "../worker/node_modules/wrangler/_virtual_unenv_global_polyfill-console.js", "../worker/node_modules/unenv/runtime/web/performance/_entry.mjs", "../worker/node_modules/unenv/runtime/web/performance/_performance.mjs", "../worker/node_modules/unenv/runtime/web/performance/_observer.mjs", "../worker/node_modules/unenv/runtime/polyfill/global-this.mjs", "../worker/node_modules/unenv/runtime/polyfill/performance.mjs", "../worker/node_modules/wrangler/_virtual_unenv_global_polyfill-performance.js", "../worker/node_modules/unenv/runtime/mock/empty.mjs", "../worker/node_modules/unenv/runtime/node/process/internal/env.mjs", "../worker/node_modules/unenv/runtime/node/process/internal/time.mjs", "../worker/node_modules/unenv/runtime/node/process/internal/process.mjs", "../worker/node_modules/unenv/runtime/node/process/$cloudflare.mjs", "../worker/node_modules/wrangler/_virtual_unenv_global_polyfill-process.js", "../worker/node_modules/hono/dist/compose.js", "../worker/node_modules/hono/dist/request/constants.js", "../worker/node_modules/hono/dist/utils/body.js", "../worker/node_modules/hono/dist/utils/url.js", "../worker/node_modules/hono/dist/request.js", "../worker/node_modules/hono/dist/utils/html.js", "../worker/node_modules/hono/dist/context.js", "../worker/node_modules/hono/dist/router.js", "../worker/node_modules/hono/dist/utils/constants.js", "../worker/node_modules/hono/dist/hono-base.js", "../worker/node_modules/hono/dist/router/reg-exp-router/matcher.js", "../worker/node_modules/hono/dist/router/reg-exp-router/node.js", "../worker/node_modules/hono/dist/router/reg-exp-router/trie.js", "../worker/node_modules/hono/dist/router/reg-exp-router/router.js", "../worker/node_modules/hono/dist/router/smart-router/router.js", "../worker/node_modules/hono/dist/router/trie-router/node.js", "../worker/node_modules/hono/dist/router/trie-router/router.js", "../worker/node_modules/hono/dist/hono.js", "../worker/src/index.js"],
  "sourceRoot": "./dist",
  "sourcesContent": ["import { clearImmediate } from \"C:/Users/nickc/Dev/DiceBastion/worker/node_modules/unenv/runtime/node/timers/$cloudflare.mjs\";\nglobalThis.clearImmediate = clearImmediate;", "export function rawHeaders(headers) {\n  const rawHeaders2 = [];\n  for (const key in headers) {\n    if (Array.isArray(headers[key])) {\n      for (const h of headers[key]) {\n        rawHeaders2.push(key, h);\n      }\n    } else {\n      rawHeaders2.push(key, headers[key]);\n    }\n  }\n  return rawHeaders2;\n}\nexport function mergeFns(...functions) {\n  return function(...args) {\n    for (const fn of functions) {\n      fn(...args);\n    }\n  };\n}\nexport function createNotImplementedError(name) {\n  return new Error(`[unenv] ${name} is not implemented yet!`);\n}\nexport function notImplemented(name) {\n  const fn = () => {\n    throw createNotImplementedError(name);\n  };\n  return Object.assign(fn, { __unenv__: true });\n}\nexport function notImplementedAsync(name) {\n  const fn = notImplemented(name);\n  fn.__promisify__ = () => notImplemented(name + \".__promisify__\");\n  fn.native = fn;\n  return fn;\n}\nexport function notImplementedClass(name) {\n  return class {\n    __unenv__ = true;\n    constructor() {\n      throw new Error(`[unenv] ${name} is not implemented yet!`);\n    }\n  };\n}\n", "export default Object.assign(() => {\n}, { __unenv__: true });\n", "export class Immediate {\n  _onImmediate;\n  _timeout;\n  constructor(callback, args) {\n    this._onImmediate = callback;\n    if (\"setTimeout\" in globalThis) {\n      this._timeout = setTimeout(callback, 0, ...args);\n    } else {\n      callback(...args);\n    }\n  }\n  ref() {\n    this._timeout?.ref();\n    return this;\n  }\n  unref() {\n    this._timeout?.unref();\n    return this;\n  }\n  hasRef() {\n    return this._timeout?.hasRef() ?? false;\n  }\n  [Symbol.dispose]() {\n    if (\"clearTimeout\" in globalThis) {\n      clearTimeout(this._timeout);\n    }\n  }\n}\n", "import { Immediate } from \"./immediate.mjs\";\nexport function setImmediateFallbackPromises(value) {\n  return new Promise((res) => {\n    res(value);\n  });\n}\nexport function setImmediateFallback(callback, ...args) {\n  return new Immediate(callback, args);\n}\nsetImmediateFallback.__promisify__ = setImmediateFallbackPromises;\nexport function clearImmediateFallback(immediate) {\n  immediate?.[Symbol.dispose]();\n}\n", "import { setImmediate } from \"C:/Users/nickc/Dev/DiceBastion/worker/node_modules/unenv/runtime/node/timers/$cloudflare.mjs\";\nglobalThis.setImmediate = setImmediate;", "import { Writable } from \"node:stream\";\nimport mock from \"../../mock/proxy.mjs\";\nimport noop from \"../../mock/noop.mjs\";\nimport { notImplemented } from \"../../_internal/utils.mjs\";\nconst _console = globalThis.console;\nexport const _ignoreErrors = true;\nexport const _stderr = new Writable();\nexport const _stdout = new Writable();\nexport const log = _console?.log ?? noop;\nexport const info = _console?.info ?? log;\nexport const trace = _console?.trace ?? info;\nexport const debug = _console?.debug ?? log;\nexport const table = _console?.table ?? log;\nexport const error = _console?.error ?? log;\nexport const warn = _console?.warn ?? error;\nexport const createTask = _console?.createTask ?? notImplemented(\"console.createTask\");\nexport const assert = notImplemented(\"console.assert\");\nexport const clear = _console?.clear ?? noop;\nexport const count = _console?.count ?? noop;\nexport const countReset = _console?.countReset ?? noop;\nexport const dir = _console?.dir ?? noop;\nexport const dirxml = _console?.dirxml ?? noop;\nexport const group = _console?.group ?? noop;\nexport const groupEnd = _console?.groupEnd ?? noop;\nexport const groupCollapsed = _console?.groupCollapsed ?? noop;\nexport const profile = _console?.profile ?? noop;\nexport const profileEnd = _console?.profileEnd ?? noop;\nexport const time = _console?.time ?? noop;\nexport const timeEnd = _console?.timeEnd ?? noop;\nexport const timeLog = _console?.timeLog ?? noop;\nexport const timeStamp = _console?.timeStamp ?? noop;\nexport const Console = _console?.Console ?? mock.__createMock__(\"console.Console\");\nexport { default as _times } from \"../../mock/proxy.mjs\";\nexport function context() {\n  return _console;\n}\nexport {\n  default as _stdoutErrorHandler,\n  default as _stderrErrorHandler\n} from \"../../mock/noop.mjs\";\nexport default {\n  assert,\n  clear,\n  Console,\n  count,\n  countReset,\n  debug,\n  dir,\n  dirxml,\n  error,\n  group,\n  groupEnd,\n  groupCollapsed,\n  info,\n  log,\n  profile,\n  profileEnd,\n  table,\n  time,\n  timeEnd,\n  timeLog,\n  timeStamp,\n  trace,\n  warn\n};\n", "const fn = function() {\n};\nfunction createMock(name, overrides = {}) {\n  fn.prototype.name = name;\n  const props = {};\n  return new Proxy(fn, {\n    get(_target, prop) {\n      if (prop === \"caller\") {\n        return null;\n      }\n      if (prop === \"__createMock__\") {\n        return createMock;\n      }\n      if (prop === \"__unenv__\") {\n        return true;\n      }\n      if (prop in overrides) {\n        return overrides[prop];\n      }\n      return props[prop] = props[prop] || createMock(`${name}.${prop.toString()}`);\n    },\n    apply(_target, _this, _args) {\n      return createMock(`${name}()`);\n    },\n    construct(_target, _args, _newT) {\n      return createMock(`[${name}]`);\n    },\n    // @ts-ignore (ES6-only - removed in ES7)\n    // https://github.com/tc39/ecma262/issues/161\n    enumerate() {\n      return [];\n    }\n  });\n}\nexport default createMock(\"mock\");\n", "export {\n  Console,\n  _ignoreErrors,\n  _stderr,\n  _stderrErrorHandler,\n  _stdout,\n  _stdoutErrorHandler,\n  _times\n} from \"./index.mjs\";\nimport {\n  Console as Console2,\n  _ignoreErrors as _ignoreErrors2,\n  _stderr as _stderr2,\n  _stderrErrorHandler as _stderrErrorHandler2,\n  _stdout as _stdout2,\n  _stdoutErrorHandler as _stdoutErrorHandler2,\n  _times as _times2\n} from \"./index.mjs\";\nconst workerdConsole = globalThis[\"console\"];\nexport const {\n  assert,\n  clear,\n  // @ts-expect-error undocumented public API\n  context,\n  count,\n  countReset,\n  // @ts-expect-error undocumented public API\n  createTask,\n  debug,\n  dir,\n  dirxml,\n  error,\n  group,\n  groupCollapsed,\n  groupEnd,\n  info,\n  log,\n  profile,\n  profileEnd,\n  table,\n  time,\n  timeEnd,\n  timeLog,\n  timeStamp,\n  trace,\n  warn\n} = workerdConsole;\nObject.assign(workerdConsole, {\n  Console: Console2,\n  _ignoreErrors: _ignoreErrors2,\n  _stderr: _stderr2,\n  _stderrErrorHandler: _stderrErrorHandler2,\n  _stdout: _stdout2,\n  _stdoutErrorHandler: _stdoutErrorHandler2,\n  _times: _times2\n});\nexport default workerdConsole;\n", "import globalVar from \"C:/Users/nickc/Dev/DiceBastion/worker/node_modules/unenv/runtime/node/console/$cloudflare.mjs\";\nglobalThis.console = globalVar;", "export const _supportedEntryTypes = [\n  \"event\",\n  // PerformanceEntry\n  \"mark\",\n  // PerformanceMark\n  \"measure\",\n  // PerformanceMeasure\n  \"resource\"\n  // PerformanceResourceTiming\n];\nexport class _PerformanceEntry {\n  __unenv__ = true;\n  detail;\n  entryType = \"event\";\n  name;\n  startTime;\n  constructor(name, options) {\n    this.name = name;\n    this.startTime = options?.startTime || performance.now();\n    this.detail = options?.detail;\n  }\n  get duration() {\n    return performance.now() - this.startTime;\n  }\n  toJSON() {\n    return {\n      name: this.name,\n      entryType: this.entryType,\n      startTime: this.startTime,\n      duration: this.duration,\n      detail: this.detail\n    };\n  }\n}\nexport const PerformanceEntry = globalThis.PerformanceEntry || _PerformanceEntry;\nexport class _PerformanceMark extends _PerformanceEntry {\n  entryType = \"mark\";\n}\nexport const PerformanceMark = globalThis.PerformanceMark || _PerformanceMark;\nexport class _PerformanceMeasure extends _PerformanceEntry {\n  entryType = \"measure\";\n}\nexport const PerformanceMeasure = globalThis.PerformanceMeasure || _PerformanceMeasure;\nexport class _PerformanceResourceTiming extends _PerformanceEntry {\n  entryType = \"resource\";\n  serverTiming = [];\n  connectEnd = 0;\n  connectStart = 0;\n  decodedBodySize = 0;\n  domainLookupEnd = 0;\n  domainLookupStart = 0;\n  encodedBodySize = 0;\n  fetchStart = 0;\n  initiatorType = \"\";\n  name = \"\";\n  nextHopProtocol = \"\";\n  redirectEnd = 0;\n  redirectStart = 0;\n  requestStart = 0;\n  responseEnd = 0;\n  responseStart = 0;\n  secureConnectionStart = 0;\n  startTime = 0;\n  transferSize = 0;\n  workerStart = 0;\n  responseStatus = 0;\n}\nexport const PerformanceResourceTiming = globalThis.PerformanceResourceTiming || _PerformanceResourceTiming;\n", "import { createNotImplementedError } from \"../../_internal/utils.mjs\";\nimport mock from \"../../mock/proxy.mjs\";\nimport { _PerformanceMark, _PerformanceMeasure } from \"./_entry.mjs\";\nconst _timeOrigin = Date.now();\nexport class _Performance {\n  __unenv__ = true;\n  timeOrigin = _timeOrigin;\n  eventCounts = /* @__PURE__ */ new Map();\n  _entries = [];\n  _resourceTimingBufferSize = 0;\n  navigation = mock.__createMock__(\"PerformanceNavigation\");\n  timing = mock.__createMock__(\"PerformanceTiming\");\n  onresourcetimingbufferfull = null;\n  now() {\n    if (globalThis?.performance?.now && this.timeOrigin === _timeOrigin) {\n      return globalThis.performance.now();\n    }\n    return Date.now() - this.timeOrigin;\n  }\n  clearMarks(markName) {\n    this._entries = markName ? this._entries.filter((e) => e.name !== markName) : this._entries.filter((e) => e.entryType !== \"mark\");\n  }\n  clearMeasures(measureName) {\n    this._entries = measureName ? this._entries.filter((e) => e.name !== measureName) : this._entries.filter((e) => e.entryType !== \"measure\");\n  }\n  clearResourceTimings() {\n    this._entries = this._entries.filter(\n      (e) => e.entryType !== \"resource\" || e.entryType !== \"navigation\"\n    );\n  }\n  getEntries() {\n    return this._entries;\n  }\n  getEntriesByName(name, type) {\n    return this._entries.filter(\n      (e) => e.name === name && (!type || e.entryType === type)\n    );\n  }\n  getEntriesByType(type) {\n    return this._entries.filter(\n      (e) => e.entryType === type\n    );\n  }\n  mark(name, options) {\n    const entry = new _PerformanceMark(name, options);\n    this._entries.push(entry);\n    return entry;\n  }\n  measure(measureName, startOrMeasureOptions, endMark) {\n    let start;\n    let end;\n    if (typeof startOrMeasureOptions === \"string\") {\n      start = this.getEntriesByName(startOrMeasureOptions, \"mark\")[0]?.startTime;\n      end = this.getEntriesByName(endMark, \"mark\")[0]?.startTime;\n    } else {\n      start = Number.parseFloat(startOrMeasureOptions?.start) || performance.now();\n      end = Number.parseFloat(startOrMeasureOptions?.end) || performance.now();\n    }\n    const entry = new _PerformanceMeasure(measureName, {\n      startTime: start,\n      detail: { start, end }\n    });\n    this._entries.push(entry);\n    return entry;\n  }\n  setResourceTimingBufferSize(maxSize) {\n    this._resourceTimingBufferSize = maxSize;\n  }\n  toJSON() {\n    return this;\n  }\n  addEventListener(type, listener, options) {\n    throw createNotImplementedError(\"Performance.addEventListener\");\n  }\n  removeEventListener(type, listener, options) {\n    throw createNotImplementedError(\"Performance.removeEventListener\");\n  }\n  dispatchEvent(event) {\n    throw createNotImplementedError(\"Performance.dispatchEvent\");\n  }\n}\nexport const Performance = globalThis.Performance || _Performance;\nexport const performance = globalThis.performance || new Performance();\n", "import { createNotImplementedError } from \"../../_internal/utils.mjs\";\nimport { _supportedEntryTypes } from \"./_entry.mjs\";\nexport class _PerformanceObserver {\n  __unenv__ = true;\n  static supportedEntryTypes = _supportedEntryTypes;\n  _callback = null;\n  constructor(callback) {\n    this._callback = callback;\n  }\n  takeRecords() {\n    return [];\n  }\n  disconnect() {\n    throw createNotImplementedError(\"PerformanceObserver.disconnect\");\n  }\n  observe(options) {\n    throw createNotImplementedError(\"PerformanceObserver.observe\");\n  }\n}\nexport const PerformanceObserver = globalThis.PerformanceObserver || _PerformanceObserver;\nexport class _PerformanceObserverEntryList {\n  __unenv__ = true;\n  getEntries() {\n    return [];\n  }\n  getEntriesByName(_name, _type) {\n    return [];\n  }\n  getEntriesByType(type) {\n    return [];\n  }\n}\nexport const PerformanceObserverEntryList = globalThis.PerformanceObserverEntryList || _PerformanceObserverEntryList;\n", "function getGlobal() {\n  if (typeof globalThis !== \"undefined\") {\n    return globalThis;\n  }\n  if (typeof self !== \"undefined\") {\n    return self;\n  }\n  if (typeof window !== \"undefined\") {\n    return window;\n  }\n  if (typeof global !== \"undefined\") {\n    return global;\n  }\n  return {};\n}\nexport default getGlobal();\n", "import {\n  performance,\n  Performance,\n  PerformanceEntry,\n  PerformanceMark,\n  PerformanceMeasure,\n  PerformanceObserver,\n  PerformanceObserverEntryList,\n  PerformanceResourceTiming\n} from \"../web/performance/index.mjs\";\nimport _global from \"./global-this.mjs\";\n_global.performance = _global.performance || performance;\n_global.Performance = _global.Performance || Performance;\n_global.PerformanceEntry = _global.PerformanceEntry || PerformanceEntry;\n_global.PerformanceMark = _global.PerformanceMark || PerformanceMark;\n_global.PerformanceMeasure = _global.PerformanceMeasure || PerformanceMeasure;\n_global.PerformanceObserver = _global.PerformanceObserver || PerformanceObserver;\n_global.PerformanceObserverEntryList = _global.PerformanceObserverEntryList || PerformanceObserverEntryList;\n_global.PerformanceResourceTiming = _global.PerformanceResourceTiming || PerformanceResourceTiming;\nexport default _global.performance;\n", "import globalVar from \"C:/Users/nickc/Dev/DiceBastion/worker/node_modules/unenv/runtime/polyfill/performance.mjs\";\nglobalThis.performance = globalVar;", "export default Object.freeze(\n  Object.create(null, {\n    __unenv__: { get: () => true }\n  })\n);\n", "const _envShim = /* @__PURE__ */ Object.create(null);\nconst _processEnv = globalThis.process?.env;\nconst _getEnv = (useShim) => _processEnv || globalThis.__env__ || (useShim ? _envShim : globalThis);\nexport const env = new Proxy(_envShim, {\n  get(_, prop) {\n    const env2 = _getEnv();\n    return env2[prop] ?? _envShim[prop];\n  },\n  has(_, prop) {\n    const env2 = _getEnv();\n    return prop in env2 || prop in _envShim;\n  },\n  set(_, prop, value) {\n    const env2 = _getEnv(true);\n    env2[prop] = value;\n    return true;\n  },\n  deleteProperty(_, prop) {\n    const env2 = _getEnv(true);\n    delete env2[prop];\n    return true;\n  },\n  ownKeys() {\n    const env2 = _getEnv();\n    return Object.keys(env2);\n  }\n});\n", "export const hrtime = Object.assign(\n  function hrtime2(startTime) {\n    const now = Date.now();\n    const seconds = Math.trunc(now / 1e3);\n    const nanos = now % 1e3 * 1e6;\n    if (startTime) {\n      let diffSeconds = seconds - startTime[0];\n      let diffNanos = nanos - startTime[0];\n      if (diffNanos < 0) {\n        diffSeconds = diffSeconds - 1;\n        diffNanos = 1e9 + diffNanos;\n      }\n      return [diffSeconds, diffNanos];\n    }\n    return [seconds, nanos];\n  },\n  {\n    bigint: function bigint() {\n      return BigInt(Date.now() * 1e6);\n    }\n  }\n);\nexport const nextTick = globalThis.queueMicrotask ? (cb, ...args) => {\n  globalThis.queueMicrotask(cb.bind(void 0, ...args));\n} : _createNextTickWithTimeout();\nfunction _createNextTickWithTimeout() {\n  let queue = [];\n  let draining = false;\n  let currentQueue;\n  let queueIndex = -1;\n  function cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n      return;\n    }\n    draining = false;\n    if (currentQueue.length > 0) {\n      queue = [...currentQueue, ...queue];\n    } else {\n      queueIndex = -1;\n    }\n    if (queue.length > 0) {\n      drainQueue();\n    }\n  }\n  function drainQueue() {\n    if (draining) {\n      return;\n    }\n    const timeout = setTimeout(cleanUpNextTick);\n    draining = true;\n    let len = queue.length;\n    while (len) {\n      currentQueue = queue;\n      queue = [];\n      while (++queueIndex < len) {\n        if (currentQueue) {\n          currentQueue[queueIndex]();\n        }\n      }\n      queueIndex = -1;\n      len = queue.length;\n    }\n    currentQueue = void 0;\n    draining = false;\n    clearTimeout(timeout);\n  }\n  const nextTick2 = (cb, ...args) => {\n    queue.push(cb.bind(void 0, ...args));\n    if (queue.length === 1 && !draining) {\n      setTimeout(drainQueue);\n    }\n  };\n  return nextTick2;\n}\n", "import mock from \"../../../mock/proxy.mjs\";\nimport empty from \"../../../mock/empty.mjs\";\nimport { notImplemented } from \"../../../_internal/utils.mjs\";\nimport { env } from \"./env.mjs\";\nimport { hrtime, nextTick } from \"./time.mjs\";\nexport { hrtime, nextTick } from \"./time.mjs\";\nexport { env } from \"./env.mjs\";\nexport const title = \"unenv\";\nexport const argv = [];\nexport const version = \"\";\nexport const versions = {\n  ares: \"\",\n  http_parser: \"\",\n  icu: \"\",\n  modules: \"\",\n  node: \"\",\n  openssl: \"\",\n  uv: \"\",\n  v8: \"\",\n  zlib: \"\"\n};\nfunction noop() {\n  return process;\n}\nexport const on = noop;\nexport const addListener = noop;\nexport const once = noop;\nexport const off = noop;\nexport const removeListener = noop;\nexport const removeAllListeners = noop;\nexport const emit = function emit2(event) {\n  if (event === \"message\" || event === \"multipleResolves\") {\n    return process;\n  }\n  return false;\n};\nexport const prependListener = noop;\nexport const prependOnceListener = noop;\nexport const listeners = function(name) {\n  return [];\n};\nexport const listenerCount = () => 0;\nexport const binding = function(name) {\n  throw new Error(\"[unenv] process.binding is not supported\");\n};\nlet _cwd = \"/\";\nexport const cwd = function cwd2() {\n  return _cwd;\n};\nexport const chdir = function chdir2(dir) {\n  _cwd = dir;\n};\nexport const umask = function umask2() {\n  return 0;\n};\nexport const getegid = function getegid2() {\n  return 1e3;\n};\nexport const geteuid = function geteuid2() {\n  return 1e3;\n};\nexport const getgid = function getgid2() {\n  return 1e3;\n};\nexport const getuid = function getuid2() {\n  return 1e3;\n};\nexport const getgroups = function getgroups2() {\n  return [];\n};\nexport const getBuiltinModule = (_name) => void 0;\nexport const abort = notImplemented(\"process.abort\");\nexport const allowedNodeEnvironmentFlags = /* @__PURE__ */ new Set();\nexport const arch = \"\";\nexport const argv0 = \"\";\nexport const config = empty;\nconst connected = false;\nexport const constrainedMemory = () => 0;\nexport const availableMemory = () => 0;\nexport const cpuUsage = notImplemented(\"process.cpuUsage\");\nexport const debugPort = 0;\nexport const dlopen = notImplemented(\"process.dlopen\");\nconst disconnect = noop;\nexport const emitWarning = noop;\nexport const eventNames = notImplemented(\"process.eventNames\");\nexport const execArgv = [];\nexport const execPath = \"\";\nexport const exit = notImplemented(\"process.exit\");\nexport const features = /* @__PURE__ */ Object.create({\n  inspector: void 0,\n  debug: void 0,\n  uv: void 0,\n  ipv6: void 0,\n  tls_alpn: void 0,\n  tls_sni: void 0,\n  tls_ocsp: void 0,\n  tls: void 0,\n  cached_builtins: void 0\n});\nexport const getActiveResourcesInfo = () => [];\nexport const getMaxListeners = notImplemented(\n  \"process.getMaxListeners\"\n);\nexport const kill = notImplemented(\"process.kill\");\nexport const memoryUsage = Object.assign(\n  () => ({\n    arrayBuffers: 0,\n    rss: 0,\n    external: 0,\n    heapTotal: 0,\n    heapUsed: 0\n  }),\n  { rss: () => 0 }\n);\nexport const pid = 1e3;\nexport const platform = \"\";\nexport const ppid = 1e3;\nexport const rawListeners = notImplemented(\n  \"process.rawListeners\"\n);\nexport const release = /* @__PURE__ */ Object.create({\n  name: \"\",\n  lts: \"\",\n  sourceUrl: void 0,\n  headersUrl: void 0\n});\nexport const report = /* @__PURE__ */ Object.create({\n  compact: void 0,\n  directory: void 0,\n  filename: void 0,\n  getReport: notImplemented(\"process.report.getReport\"),\n  reportOnFatalError: void 0,\n  reportOnSignal: void 0,\n  reportOnUncaughtException: void 0,\n  signal: void 0,\n  writeReport: notImplemented(\"process.report.writeReport\")\n});\nexport const resourceUsage = notImplemented(\n  \"process.resourceUsage\"\n);\nexport const setegid = notImplemented(\"process.setegid\");\nexport const seteuid = notImplemented(\"process.seteuid\");\nexport const setgid = notImplemented(\"process.setgid\");\nexport const setgroups = notImplemented(\"process.setgroups\");\nexport const setuid = notImplemented(\"process.setuid\");\nexport const setMaxListeners = notImplemented(\n  \"process.setMaxListeners\"\n);\nexport const setSourceMapsEnabled = notImplemented(\"process.setSourceMapsEnabled\");\nexport const stdout = mock.__createMock__(\"process.stdout\");\nexport const stderr = mock.__createMock__(\"process.stderr\");\nexport const stdin = mock.__createMock__(\"process.stdin\");\nconst traceDeprecation = false;\nexport const uptime = () => 0;\nexport const exitCode = 0;\nexport const setUncaughtExceptionCaptureCallback = notImplemented(\"process.setUncaughtExceptionCaptureCallback\");\nexport const hasUncaughtExceptionCaptureCallback = () => false;\nexport const sourceMapsEnabled = false;\nexport const loadEnvFile = notImplemented(\n  \"process.loadEnvFile\"\n);\nconst mainModule = void 0;\nconst permission = {\n  has: () => false\n};\nconst channel = {\n  ref() {\n  },\n  unref() {\n  }\n};\nconst throwDeprecation = false;\nexport const finalization = {\n  register() {\n  },\n  unregister() {\n  },\n  registerBeforeExit() {\n  }\n};\nexport const assert = notImplemented(\"process.assert\");\nexport const openStdin = notImplemented(\"process.openStdin\");\nexport const _debugEnd = notImplemented(\"process._debugEnd\");\nexport const _debugProcess = notImplemented(\"process._debugProcess\");\nexport const _fatalException = notImplemented(\"process._fatalException\");\nexport const _getActiveHandles = notImplemented(\"process._getActiveHandles\");\nexport const _getActiveRequests = notImplemented(\"process._getActiveRequests\");\nexport const _kill = notImplemented(\"process._kill\");\nexport const _preload_modules = [];\nexport const _rawDebug = notImplemented(\"process._rawDebug\");\nexport const _startProfilerIdleNotifier = notImplemented(\n  \"process._startProfilerIdleNotifier\"\n);\nexport const _stopProfilerIdleNotifier = notImplemented(\n  \"process.__stopProfilerIdleNotifier\"\n);\nexport const _tickCallback = notImplemented(\"process._tickCallback\");\nexport const _linkedBinding = notImplemented(\"process._linkedBinding\");\nexport const domain = void 0;\nexport const initgroups = notImplemented(\"process.initgroups\");\nexport const moduleLoadList = [];\nexport const reallyExit = noop;\nexport const _exiting = false;\nexport const _events = [];\nexport const _eventsCount = 0;\nexport const _maxListeners = 0;\nexport const process = {\n  // @ts-expect-error\n  _events,\n  _eventsCount,\n  _exiting,\n  _maxListeners,\n  _debugEnd,\n  _debugProcess,\n  _fatalException,\n  _getActiveHandles,\n  _getActiveRequests,\n  _kill,\n  _preload_modules,\n  _rawDebug,\n  _startProfilerIdleNotifier,\n  _stopProfilerIdleNotifier,\n  _tickCallback,\n  domain,\n  initgroups,\n  moduleLoadList,\n  reallyExit,\n  exitCode,\n  abort,\n  addListener,\n  allowedNodeEnvironmentFlags,\n  hasUncaughtExceptionCaptureCallback,\n  setUncaughtExceptionCaptureCallback,\n  loadEnvFile,\n  sourceMapsEnabled,\n  throwDeprecation,\n  mainModule,\n  permission,\n  channel,\n  arch,\n  argv,\n  argv0,\n  assert,\n  binding,\n  chdir,\n  config,\n  connected,\n  constrainedMemory,\n  availableMemory,\n  cpuUsage,\n  cwd,\n  debugPort,\n  dlopen,\n  disconnect,\n  emit,\n  emitWarning,\n  env,\n  eventNames,\n  execArgv,\n  execPath,\n  exit,\n  finalization,\n  features,\n  getBuiltinModule,\n  getegid,\n  geteuid,\n  getgid,\n  getgroups,\n  getuid,\n  getActiveResourcesInfo,\n  getMaxListeners,\n  hrtime,\n  kill,\n  listeners,\n  listenerCount,\n  memoryUsage,\n  nextTick,\n  on,\n  off,\n  once,\n  openStdin,\n  pid,\n  platform,\n  ppid,\n  prependListener,\n  prependOnceListener,\n  rawListeners,\n  release,\n  removeAllListeners,\n  removeListener,\n  report,\n  resourceUsage,\n  setegid,\n  seteuid,\n  setgid,\n  setgroups,\n  setuid,\n  setMaxListeners,\n  setSourceMapsEnabled,\n  stderr,\n  stdin,\n  stdout,\n  title,\n  traceDeprecation,\n  umask,\n  uptime,\n  version,\n  versions\n};\n", "export {\n  _debugEnd,\n  _debugProcess,\n  _events,\n  _eventsCount,\n  _exiting,\n  _fatalException,\n  _getActiveHandles,\n  _getActiveRequests,\n  _kill,\n  _linkedBinding,\n  _maxListeners,\n  _preload_modules,\n  _rawDebug,\n  _startProfilerIdleNotifier,\n  _stopProfilerIdleNotifier,\n  _tickCallback,\n  abort,\n  addListener,\n  allowedNodeEnvironmentFlags,\n  arch,\n  argv,\n  argv0,\n  assert,\n  availableMemory,\n  binding,\n  chdir,\n  config,\n  constrainedMemory,\n  cpuUsage,\n  cwd,\n  debugPort,\n  dlopen,\n  domain,\n  emit,\n  emitWarning,\n  eventNames,\n  execArgv,\n  execPath,\n  exitCode,\n  features,\n  getActiveResourcesInfo,\n  getMaxListeners,\n  getegid,\n  geteuid,\n  getgid,\n  getgroups,\n  getuid,\n  hasUncaughtExceptionCaptureCallback,\n  hrtime,\n  initgroups,\n  kill,\n  listenerCount,\n  listeners,\n  loadEnvFile,\n  memoryUsage,\n  moduleLoadList,\n  off,\n  on,\n  once,\n  openStdin,\n  pid,\n  ppid,\n  prependListener,\n  prependOnceListener,\n  rawListeners,\n  reallyExit,\n  release,\n  removeAllListeners,\n  removeListener,\n  report,\n  resourceUsage,\n  setMaxListeners,\n  setSourceMapsEnabled,\n  setUncaughtExceptionCaptureCallback,\n  setegid,\n  seteuid,\n  setgid,\n  setgroups,\n  setuid,\n  sourceMapsEnabled,\n  stderr,\n  stdin,\n  stdout,\n  title,\n  umask,\n  uptime,\n  version,\n  versions\n} from \"./internal/process.mjs\";\nimport {\n  _debugEnd as _debugEnd2,\n  _debugProcess as _debugProcess2,\n  _events as _events2,\n  _eventsCount as _eventsCount2,\n  _exiting as _exiting2,\n  _fatalException as _fatalException2,\n  _getActiveHandles as _getActiveHandles2,\n  _getActiveRequests as _getActiveRequests2,\n  _kill as _kill2,\n  _linkedBinding as _linkedBinding2,\n  _maxListeners as _maxListeners2,\n  _preload_modules as _preload_modules2,\n  _rawDebug as _rawDebug2,\n  _startProfilerIdleNotifier as _startProfilerIdleNotifier2,\n  _stopProfilerIdleNotifier as _stopProfilerIdleNotifier2,\n  _tickCallback as _tickCallback2,\n  abort as abort2,\n  addListener as addListener2,\n  allowedNodeEnvironmentFlags as allowedNodeEnvironmentFlags2,\n  arch as arch2,\n  argv as argv2,\n  argv0 as argv02,\n  assert as assert2,\n  availableMemory as availableMemory2,\n  binding as binding2,\n  chdir as chdir2,\n  config as config2,\n  constrainedMemory as constrainedMemory2,\n  cpuUsage as cpuUsage2,\n  cwd as cwd2,\n  debugPort as debugPort2,\n  dlopen as dlopen2,\n  domain as domain2,\n  emit as emit2,\n  emitWarning as emitWarning2,\n  eventNames as eventNames2,\n  execArgv as execArgv2,\n  execPath as execPath2,\n  exitCode as exitCode2,\n  features as features2,\n  getActiveResourcesInfo as getActiveResourcesInfo2,\n  getMaxListeners as getMaxListeners2,\n  getegid as getegid2,\n  geteuid as geteuid2,\n  getgid as getgid2,\n  getgroups as getgroups2,\n  getuid as getuid2,\n  hasUncaughtExceptionCaptureCallback as hasUncaughtExceptionCaptureCallback2,\n  hrtime as hrtime2,\n  initgroups as initgroups2,\n  kill as kill2,\n  listenerCount as listenerCount2,\n  listeners as listeners2,\n  loadEnvFile as loadEnvFile2,\n  memoryUsage as memoryUsage2,\n  moduleLoadList as moduleLoadList2,\n  off as off2,\n  on as on2,\n  once as once2,\n  openStdin as openStdin2,\n  pid as pid2,\n  ppid as ppid2,\n  prependListener as prependListener2,\n  prependOnceListener as prependOnceListener2,\n  rawListeners as rawListeners2,\n  reallyExit as reallyExit2,\n  release as release2,\n  removeAllListeners as removeAllListeners2,\n  removeListener as removeListener2,\n  report as report2,\n  resourceUsage as resourceUsage2,\n  setMaxListeners as setMaxListeners2,\n  setSourceMapsEnabled as setSourceMapsEnabled2,\n  setUncaughtExceptionCaptureCallback as setUncaughtExceptionCaptureCallback2,\n  setegid as setegid2,\n  seteuid as seteuid2,\n  setgid as setgid2,\n  setgroups as setgroups2,\n  setuid as setuid2,\n  sourceMapsEnabled as sourceMapsEnabled2,\n  stderr as stderr2,\n  stdin as stdin2,\n  stdout as stdout2,\n  title as title2,\n  umask as umask2,\n  uptime as uptime2,\n  version as version2,\n  versions as versions2\n} from \"./internal/process.mjs\";\nconst unpatchedGlobalThisProcess = globalThis[\"process\"];\nexport const getBuiltinModule = unpatchedGlobalThisProcess.getBuiltinModule;\nconst workerdProcess = getBuiltinModule(\"node:process\");\nexport const { env, exit, nextTick, platform } = workerdProcess;\nconst _process = {\n  /**\n   * manually unroll unenv-polyfilled-symbols to make it tree-shakeable\n   */\n  // @ts-expect-error (not typed)\n  _debugEnd: _debugEnd2,\n  _debugProcess: _debugProcess2,\n  _events: _events2,\n  _eventsCount: _eventsCount2,\n  _exiting: _exiting2,\n  _fatalException: _fatalException2,\n  _getActiveHandles: _getActiveHandles2,\n  _getActiveRequests: _getActiveRequests2,\n  _kill: _kill2,\n  _linkedBinding: _linkedBinding2,\n  _maxListeners: _maxListeners2,\n  _preload_modules: _preload_modules2,\n  _rawDebug: _rawDebug2,\n  _startProfilerIdleNotifier: _startProfilerIdleNotifier2,\n  _stopProfilerIdleNotifier: _stopProfilerIdleNotifier2,\n  _tickCallback: _tickCallback2,\n  abort: abort2,\n  addListener: addListener2,\n  allowedNodeEnvironmentFlags: allowedNodeEnvironmentFlags2,\n  arch: arch2,\n  argv: argv2,\n  argv0: argv02,\n  assert: assert2,\n  availableMemory: availableMemory2,\n  binding: binding2,\n  chdir: chdir2,\n  config: config2,\n  constrainedMemory: constrainedMemory2,\n  cpuUsage: cpuUsage2,\n  cwd: cwd2,\n  debugPort: debugPort2,\n  dlopen: dlopen2,\n  domain: domain2,\n  emit: emit2,\n  emitWarning: emitWarning2,\n  eventNames: eventNames2,\n  execArgv: execArgv2,\n  execPath: execPath2,\n  exit,\n  exitCode: exitCode2,\n  features: features2,\n  getActiveResourcesInfo: getActiveResourcesInfo2,\n  getMaxListeners: getMaxListeners2,\n  getegid: getegid2,\n  geteuid: geteuid2,\n  getgid: getgid2,\n  getgroups: getgroups2,\n  getuid: getuid2,\n  hasUncaughtExceptionCaptureCallback: hasUncaughtExceptionCaptureCallback2,\n  hrtime: hrtime2,\n  initgroups: initgroups2,\n  kill: kill2,\n  listenerCount: listenerCount2,\n  listeners: listeners2,\n  loadEnvFile: loadEnvFile2,\n  memoryUsage: memoryUsage2,\n  moduleLoadList: moduleLoadList2,\n  off: off2,\n  on: on2,\n  once: once2,\n  openStdin: openStdin2,\n  pid: pid2,\n  platform,\n  ppid: ppid2,\n  prependListener: prependListener2,\n  prependOnceListener: prependOnceListener2,\n  rawListeners: rawListeners2,\n  reallyExit: reallyExit2,\n  release: release2,\n  removeAllListeners: removeAllListeners2,\n  removeListener: removeListener2,\n  report: report2,\n  resourceUsage: resourceUsage2,\n  setMaxListeners: setMaxListeners2,\n  setSourceMapsEnabled: setSourceMapsEnabled2,\n  setUncaughtExceptionCaptureCallback: setUncaughtExceptionCaptureCallback2,\n  setegid: setegid2,\n  seteuid: seteuid2,\n  setgid: setgid2,\n  setgroups: setgroups2,\n  setuid: setuid2,\n  sourceMapsEnabled: sourceMapsEnabled2,\n  stderr: stderr2,\n  stdin: stdin2,\n  stdout: stdout2,\n  title: title2,\n  umask: umask2,\n  uptime: uptime2,\n  version: version2,\n  versions: versions2,\n  /**\n   * manually unroll workerd-polyfilled-symbols to make it tree-shakeable\n   */\n  env,\n  getBuiltinModule,\n  nextTick\n};\nexport default _process;\n", "import globalVar from \"C:/Users/nickc/Dev/DiceBastion/worker/node_modules/unenv/runtime/node/process/$cloudflare.mjs\";\nglobalThis.process = globalVar;", "// src/compose.ts\nvar compose = (middleware, onError, onNotFound) => {\n  return (context, next) => {\n    let index = -1;\n    return dispatch(0);\n    async function dispatch(i) {\n      if (i <= index) {\n        throw new Error(\"next() called multiple times\");\n      }\n      index = i;\n      let res;\n      let isError = false;\n      let handler;\n      if (middleware[i]) {\n        handler = middleware[i][0][0];\n        context.req.routeIndex = i;\n      } else {\n        handler = i === middleware.length && next || void 0;\n      }\n      if (handler) {\n        try {\n          res = await handler(context, () => dispatch(i + 1));\n        } catch (err) {\n          if (err instanceof Error && onError) {\n            context.error = err;\n            res = await onError(err, context);\n            isError = true;\n          } else {\n            throw err;\n          }\n        }\n      } else {\n        if (context.finalized === false && onNotFound) {\n          res = await onNotFound(context);\n        }\n      }\n      if (res && (context.finalized === false || isError)) {\n        context.res = res;\n      }\n      return context;\n    }\n  };\n};\nexport {\n  compose\n};\n", "// src/request/constants.ts\nvar GET_MATCH_RESULT = Symbol();\nexport {\n  GET_MATCH_RESULT\n};\n", "// src/utils/body.ts\nimport { HonoRequest } from \"../request.js\";\nvar parseBody = async (request, options = /* @__PURE__ */ Object.create(null)) => {\n  const { all = false, dot = false } = options;\n  const headers = request instanceof HonoRequest ? request.raw.headers : request.headers;\n  const contentType = headers.get(\"Content-Type\");\n  if (contentType?.startsWith(\"multipart/form-data\") || contentType?.startsWith(\"application/x-www-form-urlencoded\")) {\n    return parseFormData(request, { all, dot });\n  }\n  return {};\n};\nasync function parseFormData(request, options) {\n  const formData = await request.formData();\n  if (formData) {\n    return convertFormDataToBodyData(formData, options);\n  }\n  return {};\n}\nfunction convertFormDataToBodyData(formData, options) {\n  const form = /* @__PURE__ */ Object.create(null);\n  formData.forEach((value, key) => {\n    const shouldParseAllValues = options.all || key.endsWith(\"[]\");\n    if (!shouldParseAllValues) {\n      form[key] = value;\n    } else {\n      handleParsingAllValues(form, key, value);\n    }\n  });\n  if (options.dot) {\n    Object.entries(form).forEach(([key, value]) => {\n      const shouldParseDotValues = key.includes(\".\");\n      if (shouldParseDotValues) {\n        handleParsingNestedValues(form, key, value);\n        delete form[key];\n      }\n    });\n  }\n  return form;\n}\nvar handleParsingAllValues = (form, key, value) => {\n  if (form[key] !== void 0) {\n    if (Array.isArray(form[key])) {\n      ;\n      form[key].push(value);\n    } else {\n      form[key] = [form[key], value];\n    }\n  } else {\n    if (!key.endsWith(\"[]\")) {\n      form[key] = value;\n    } else {\n      form[key] = [value];\n    }\n  }\n};\nvar handleParsingNestedValues = (form, key, value) => {\n  let nestedForm = form;\n  const keys = key.split(\".\");\n  keys.forEach((key2, index) => {\n    if (index === keys.length - 1) {\n      nestedForm[key2] = value;\n    } else {\n      if (!nestedForm[key2] || typeof nestedForm[key2] !== \"object\" || Array.isArray(nestedForm[key2]) || nestedForm[key2] instanceof File) {\n        nestedForm[key2] = /* @__PURE__ */ Object.create(null);\n      }\n      nestedForm = nestedForm[key2];\n    }\n  });\n};\nexport {\n  parseBody\n};\n", "// src/utils/url.ts\nvar splitPath = (path) => {\n  const paths = path.split(\"/\");\n  if (paths[0] === \"\") {\n    paths.shift();\n  }\n  return paths;\n};\nvar splitRoutingPath = (routePath) => {\n  const { groups, path } = extractGroupsFromPath(routePath);\n  const paths = splitPath(path);\n  return replaceGroupMarks(paths, groups);\n};\nvar extractGroupsFromPath = (path) => {\n  const groups = [];\n  path = path.replace(/\\{[^}]+\\}/g, (match, index) => {\n    const mark = `@${index}`;\n    groups.push([mark, match]);\n    return mark;\n  });\n  return { groups, path };\n};\nvar replaceGroupMarks = (paths, groups) => {\n  for (let i = groups.length - 1; i >= 0; i--) {\n    const [mark] = groups[i];\n    for (let j = paths.length - 1; j >= 0; j--) {\n      if (paths[j].includes(mark)) {\n        paths[j] = paths[j].replace(mark, groups[i][1]);\n        break;\n      }\n    }\n  }\n  return paths;\n};\nvar patternCache = {};\nvar getPattern = (label, next) => {\n  if (label === \"*\") {\n    return \"*\";\n  }\n  const match = label.match(/^\\:([^\\{\\}]+)(?:\\{(.+)\\})?$/);\n  if (match) {\n    const cacheKey = `${label}#${next}`;\n    if (!patternCache[cacheKey]) {\n      if (match[2]) {\n        patternCache[cacheKey] = next && next[0] !== \":\" && next[0] !== \"*\" ? [cacheKey, match[1], new RegExp(`^${match[2]}(?=/${next})`)] : [label, match[1], new RegExp(`^${match[2]}$`)];\n      } else {\n        patternCache[cacheKey] = [label, match[1], true];\n      }\n    }\n    return patternCache[cacheKey];\n  }\n  return null;\n};\nvar tryDecode = (str, decoder) => {\n  try {\n    return decoder(str);\n  } catch {\n    return str.replace(/(?:%[0-9A-Fa-f]{2})+/g, (match) => {\n      try {\n        return decoder(match);\n      } catch {\n        return match;\n      }\n    });\n  }\n};\nvar tryDecodeURI = (str) => tryDecode(str, decodeURI);\nvar getPath = (request) => {\n  const url = request.url;\n  const start = url.indexOf(\"/\", url.indexOf(\":\") + 4);\n  let i = start;\n  for (; i < url.length; i++) {\n    const charCode = url.charCodeAt(i);\n    if (charCode === 37) {\n      const queryIndex = url.indexOf(\"?\", i);\n      const path = url.slice(start, queryIndex === -1 ? void 0 : queryIndex);\n      return tryDecodeURI(path.includes(\"%25\") ? path.replace(/%25/g, \"%2525\") : path);\n    } else if (charCode === 63) {\n      break;\n    }\n  }\n  return url.slice(start, i);\n};\nvar getQueryStrings = (url) => {\n  const queryIndex = url.indexOf(\"?\", 8);\n  return queryIndex === -1 ? \"\" : \"?\" + url.slice(queryIndex + 1);\n};\nvar getPathNoStrict = (request) => {\n  const result = getPath(request);\n  return result.length > 1 && result.at(-1) === \"/\" ? result.slice(0, -1) : result;\n};\nvar mergePath = (base, sub, ...rest) => {\n  if (rest.length) {\n    sub = mergePath(sub, ...rest);\n  }\n  return `${base?.[0] === \"/\" ? \"\" : \"/\"}${base}${sub === \"/\" ? \"\" : `${base?.at(-1) === \"/\" ? \"\" : \"/\"}${sub?.[0] === \"/\" ? sub.slice(1) : sub}`}`;\n};\nvar checkOptionalParameter = (path) => {\n  if (path.charCodeAt(path.length - 1) !== 63 || !path.includes(\":\")) {\n    return null;\n  }\n  const segments = path.split(\"/\");\n  const results = [];\n  let basePath = \"\";\n  segments.forEach((segment) => {\n    if (segment !== \"\" && !/\\:/.test(segment)) {\n      basePath += \"/\" + segment;\n    } else if (/\\:/.test(segment)) {\n      if (/\\?/.test(segment)) {\n        if (results.length === 0 && basePath === \"\") {\n          results.push(\"/\");\n        } else {\n          results.push(basePath);\n        }\n        const optionalSegment = segment.replace(\"?\", \"\");\n        basePath += \"/\" + optionalSegment;\n        results.push(basePath);\n      } else {\n        basePath += \"/\" + segment;\n      }\n    }\n  });\n  return results.filter((v, i, a) => a.indexOf(v) === i);\n};\nvar _decodeURI = (value) => {\n  if (!/[%+]/.test(value)) {\n    return value;\n  }\n  if (value.indexOf(\"+\") !== -1) {\n    value = value.replace(/\\+/g, \" \");\n  }\n  return value.indexOf(\"%\") !== -1 ? tryDecode(value, decodeURIComponent_) : value;\n};\nvar _getQueryParam = (url, key, multiple) => {\n  let encoded;\n  if (!multiple && key && !/[%+]/.test(key)) {\n    let keyIndex2 = url.indexOf(`?${key}`, 8);\n    if (keyIndex2 === -1) {\n      keyIndex2 = url.indexOf(`&${key}`, 8);\n    }\n    while (keyIndex2 !== -1) {\n      const trailingKeyCode = url.charCodeAt(keyIndex2 + key.length + 1);\n      if (trailingKeyCode === 61) {\n        const valueIndex = keyIndex2 + key.length + 2;\n        const endIndex = url.indexOf(\"&\", valueIndex);\n        return _decodeURI(url.slice(valueIndex, endIndex === -1 ? void 0 : endIndex));\n      } else if (trailingKeyCode == 38 || isNaN(trailingKeyCode)) {\n        return \"\";\n      }\n      keyIndex2 = url.indexOf(`&${key}`, keyIndex2 + 1);\n    }\n    encoded = /[%+]/.test(url);\n    if (!encoded) {\n      return void 0;\n    }\n  }\n  const results = {};\n  encoded ??= /[%+]/.test(url);\n  let keyIndex = url.indexOf(\"?\", 8);\n  while (keyIndex !== -1) {\n    const nextKeyIndex = url.indexOf(\"&\", keyIndex + 1);\n    let valueIndex = url.indexOf(\"=\", keyIndex);\n    if (valueIndex > nextKeyIndex && nextKeyIndex !== -1) {\n      valueIndex = -1;\n    }\n    let name = url.slice(\n      keyIndex + 1,\n      valueIndex === -1 ? nextKeyIndex === -1 ? void 0 : nextKeyIndex : valueIndex\n    );\n    if (encoded) {\n      name = _decodeURI(name);\n    }\n    keyIndex = nextKeyIndex;\n    if (name === \"\") {\n      continue;\n    }\n    let value;\n    if (valueIndex === -1) {\n      value = \"\";\n    } else {\n      value = url.slice(valueIndex + 1, nextKeyIndex === -1 ? void 0 : nextKeyIndex);\n      if (encoded) {\n        value = _decodeURI(value);\n      }\n    }\n    if (multiple) {\n      if (!(results[name] && Array.isArray(results[name]))) {\n        results[name] = [];\n      }\n      ;\n      results[name].push(value);\n    } else {\n      results[name] ??= value;\n    }\n  }\n  return key ? results[key] : results;\n};\nvar getQueryParam = _getQueryParam;\nvar getQueryParams = (url, key) => {\n  return _getQueryParam(url, key, true);\n};\nvar decodeURIComponent_ = decodeURIComponent;\nexport {\n  checkOptionalParameter,\n  decodeURIComponent_,\n  getPath,\n  getPathNoStrict,\n  getPattern,\n  getQueryParam,\n  getQueryParams,\n  getQueryStrings,\n  mergePath,\n  splitPath,\n  splitRoutingPath,\n  tryDecode\n};\n", "// src/request.ts\nimport { HTTPException } from \"./http-exception.js\";\nimport { GET_MATCH_RESULT } from \"./request/constants.js\";\nimport { parseBody } from \"./utils/body.js\";\nimport { decodeURIComponent_, getQueryParam, getQueryParams, tryDecode } from \"./utils/url.js\";\nvar tryDecodeURIComponent = (str) => tryDecode(str, decodeURIComponent_);\nvar HonoRequest = class {\n  raw;\n  #validatedData;\n  #matchResult;\n  routeIndex = 0;\n  path;\n  bodyCache = {};\n  constructor(request, path = \"/\", matchResult = [[]]) {\n    this.raw = request;\n    this.path = path;\n    this.#matchResult = matchResult;\n    this.#validatedData = {};\n  }\n  param(key) {\n    return key ? this.#getDecodedParam(key) : this.#getAllDecodedParams();\n  }\n  #getDecodedParam(key) {\n    const paramKey = this.#matchResult[0][this.routeIndex][1][key];\n    const param = this.#getParamValue(paramKey);\n    return param && /\\%/.test(param) ? tryDecodeURIComponent(param) : param;\n  }\n  #getAllDecodedParams() {\n    const decoded = {};\n    const keys = Object.keys(this.#matchResult[0][this.routeIndex][1]);\n    for (const key of keys) {\n      const value = this.#getParamValue(this.#matchResult[0][this.routeIndex][1][key]);\n      if (value !== void 0) {\n        decoded[key] = /\\%/.test(value) ? tryDecodeURIComponent(value) : value;\n      }\n    }\n    return decoded;\n  }\n  #getParamValue(paramKey) {\n    return this.#matchResult[1] ? this.#matchResult[1][paramKey] : paramKey;\n  }\n  query(key) {\n    return getQueryParam(this.url, key);\n  }\n  queries(key) {\n    return getQueryParams(this.url, key);\n  }\n  header(name) {\n    if (name) {\n      return this.raw.headers.get(name) ?? void 0;\n    }\n    const headerData = {};\n    this.raw.headers.forEach((value, key) => {\n      headerData[key] = value;\n    });\n    return headerData;\n  }\n  async parseBody(options) {\n    return this.bodyCache.parsedBody ??= await parseBody(this, options);\n  }\n  #cachedBody = (key) => {\n    const { bodyCache, raw } = this;\n    const cachedBody = bodyCache[key];\n    if (cachedBody) {\n      return cachedBody;\n    }\n    const anyCachedKey = Object.keys(bodyCache)[0];\n    if (anyCachedKey) {\n      return bodyCache[anyCachedKey].then((body) => {\n        if (anyCachedKey === \"json\") {\n          body = JSON.stringify(body);\n        }\n        return new Response(body)[key]();\n      });\n    }\n    return bodyCache[key] = raw[key]();\n  };\n  json() {\n    return this.#cachedBody(\"text\").then((text) => JSON.parse(text));\n  }\n  text() {\n    return this.#cachedBody(\"text\");\n  }\n  arrayBuffer() {\n    return this.#cachedBody(\"arrayBuffer\");\n  }\n  blob() {\n    return this.#cachedBody(\"blob\");\n  }\n  formData() {\n    return this.#cachedBody(\"formData\");\n  }\n  addValidatedData(target, data) {\n    this.#validatedData[target] = data;\n  }\n  valid(target) {\n    return this.#validatedData[target];\n  }\n  get url() {\n    return this.raw.url;\n  }\n  get method() {\n    return this.raw.method;\n  }\n  get [GET_MATCH_RESULT]() {\n    return this.#matchResult;\n  }\n  get matchedRoutes() {\n    return this.#matchResult[0].map(([[, route]]) => route);\n  }\n  get routePath() {\n    return this.#matchResult[0].map(([[, route]]) => route)[this.routeIndex].path;\n  }\n};\nvar cloneRawRequest = async (req) => {\n  if (!req.raw.bodyUsed) {\n    return req.raw.clone();\n  }\n  const cacheKey = Object.keys(req.bodyCache)[0];\n  if (!cacheKey) {\n    throw new HTTPException(500, {\n      message: \"Cannot clone request: body was already consumed and not cached. Please use HonoRequest methods (e.g., req.json(), req.text()) instead of consuming req.raw directly.\"\n    });\n  }\n  const requestInit = {\n    body: await req[cacheKey](),\n    cache: req.raw.cache,\n    credentials: req.raw.credentials,\n    headers: req.header(),\n    integrity: req.raw.integrity,\n    keepalive: req.raw.keepalive,\n    method: req.method,\n    mode: req.raw.mode,\n    redirect: req.raw.redirect,\n    referrer: req.raw.referrer,\n    referrerPolicy: req.raw.referrerPolicy,\n    signal: req.raw.signal\n  };\n  return new Request(req.url, requestInit);\n};\nexport {\n  HonoRequest,\n  cloneRawRequest\n};\n", "// src/utils/html.ts\nvar HtmlEscapedCallbackPhase = {\n  Stringify: 1,\n  BeforeStream: 2,\n  Stream: 3\n};\nvar raw = (value, callbacks) => {\n  const escapedString = new String(value);\n  escapedString.isEscaped = true;\n  escapedString.callbacks = callbacks;\n  return escapedString;\n};\nvar escapeRe = /[&<>'\"]/;\nvar stringBufferToString = async (buffer, callbacks) => {\n  let str = \"\";\n  callbacks ||= [];\n  const resolvedBuffer = await Promise.all(buffer);\n  for (let i = resolvedBuffer.length - 1; ; i--) {\n    str += resolvedBuffer[i];\n    i--;\n    if (i < 0) {\n      break;\n    }\n    let r = resolvedBuffer[i];\n    if (typeof r === \"object\") {\n      callbacks.push(...r.callbacks || []);\n    }\n    const isEscaped = r.isEscaped;\n    r = await (typeof r === \"object\" ? r.toString() : r);\n    if (typeof r === \"object\") {\n      callbacks.push(...r.callbacks || []);\n    }\n    if (r.isEscaped ?? isEscaped) {\n      str += r;\n    } else {\n      const buf = [str];\n      escapeToBuffer(r, buf);\n      str = buf[0];\n    }\n  }\n  return raw(str, callbacks);\n};\nvar escapeToBuffer = (str, buffer) => {\n  const match = str.search(escapeRe);\n  if (match === -1) {\n    buffer[0] += str;\n    return;\n  }\n  let escape;\n  let index;\n  let lastIndex = 0;\n  for (index = match; index < str.length; index++) {\n    switch (str.charCodeAt(index)) {\n      case 34:\n        escape = \"&quot;\";\n        break;\n      case 39:\n        escape = \"&#39;\";\n        break;\n      case 38:\n        escape = \"&amp;\";\n        break;\n      case 60:\n        escape = \"&lt;\";\n        break;\n      case 62:\n        escape = \"&gt;\";\n        break;\n      default:\n        continue;\n    }\n    buffer[0] += str.substring(lastIndex, index) + escape;\n    lastIndex = index + 1;\n  }\n  buffer[0] += str.substring(lastIndex, index);\n};\nvar resolveCallbackSync = (str) => {\n  const callbacks = str.callbacks;\n  if (!callbacks?.length) {\n    return str;\n  }\n  const buffer = [str];\n  const context = {};\n  callbacks.forEach((c) => c({ phase: HtmlEscapedCallbackPhase.Stringify, buffer, context }));\n  return buffer[0];\n};\nvar resolveCallback = async (str, phase, preserveCallbacks, context, buffer) => {\n  if (typeof str === \"object\" && !(str instanceof String)) {\n    if (!(str instanceof Promise)) {\n      str = str.toString();\n    }\n    if (str instanceof Promise) {\n      str = await str;\n    }\n  }\n  const callbacks = str.callbacks;\n  if (!callbacks?.length) {\n    return Promise.resolve(str);\n  }\n  if (buffer) {\n    buffer[0] += str;\n  } else {\n    buffer = [str];\n  }\n  const resStr = Promise.all(callbacks.map((c) => c({ phase, buffer, context }))).then(\n    (res) => Promise.all(\n      res.filter(Boolean).map((str2) => resolveCallback(str2, phase, false, context, buffer))\n    ).then(() => buffer[0])\n  );\n  if (preserveCallbacks) {\n    return raw(await resStr, callbacks);\n  } else {\n    return resStr;\n  }\n};\nexport {\n  HtmlEscapedCallbackPhase,\n  escapeToBuffer,\n  raw,\n  resolveCallback,\n  resolveCallbackSync,\n  stringBufferToString\n};\n", "// src/context.ts\nimport { HonoRequest } from \"./request.js\";\nimport { HtmlEscapedCallbackPhase, resolveCallback } from \"./utils/html.js\";\nvar TEXT_PLAIN = \"text/plain; charset=UTF-8\";\nvar setDefaultContentType = (contentType, headers) => {\n  return {\n    \"Content-Type\": contentType,\n    ...headers\n  };\n};\nvar Context = class {\n  #rawRequest;\n  #req;\n  env = {};\n  #var;\n  finalized = false;\n  error;\n  #status;\n  #executionCtx;\n  #res;\n  #layout;\n  #renderer;\n  #notFoundHandler;\n  #preparedHeaders;\n  #matchResult;\n  #path;\n  constructor(req, options) {\n    this.#rawRequest = req;\n    if (options) {\n      this.#executionCtx = options.executionCtx;\n      this.env = options.env;\n      this.#notFoundHandler = options.notFoundHandler;\n      this.#path = options.path;\n      this.#matchResult = options.matchResult;\n    }\n  }\n  get req() {\n    this.#req ??= new HonoRequest(this.#rawRequest, this.#path, this.#matchResult);\n    return this.#req;\n  }\n  get event() {\n    if (this.#executionCtx && \"respondWith\" in this.#executionCtx) {\n      return this.#executionCtx;\n    } else {\n      throw Error(\"This context has no FetchEvent\");\n    }\n  }\n  get executionCtx() {\n    if (this.#executionCtx) {\n      return this.#executionCtx;\n    } else {\n      throw Error(\"This context has no ExecutionContext\");\n    }\n  }\n  get res() {\n    return this.#res ||= new Response(null, {\n      headers: this.#preparedHeaders ??= new Headers()\n    });\n  }\n  set res(_res) {\n    if (this.#res && _res) {\n      _res = new Response(_res.body, _res);\n      for (const [k, v] of this.#res.headers.entries()) {\n        if (k === \"content-type\") {\n          continue;\n        }\n        if (k === \"set-cookie\") {\n          const cookies = this.#res.headers.getSetCookie();\n          _res.headers.delete(\"set-cookie\");\n          for (const cookie of cookies) {\n            _res.headers.append(\"set-cookie\", cookie);\n          }\n        } else {\n          _res.headers.set(k, v);\n        }\n      }\n    }\n    this.#res = _res;\n    this.finalized = true;\n  }\n  render = (...args) => {\n    this.#renderer ??= (content) => this.html(content);\n    return this.#renderer(...args);\n  };\n  setLayout = (layout) => this.#layout = layout;\n  getLayout = () => this.#layout;\n  setRenderer = (renderer) => {\n    this.#renderer = renderer;\n  };\n  header = (name, value, options) => {\n    if (this.finalized) {\n      this.#res = new Response(this.#res.body, this.#res);\n    }\n    const headers = this.#res ? this.#res.headers : this.#preparedHeaders ??= new Headers();\n    if (value === void 0) {\n      headers.delete(name);\n    } else if (options?.append) {\n      headers.append(name, value);\n    } else {\n      headers.set(name, value);\n    }\n  };\n  status = (status) => {\n    this.#status = status;\n  };\n  set = (key, value) => {\n    this.#var ??= /* @__PURE__ */ new Map();\n    this.#var.set(key, value);\n  };\n  get = (key) => {\n    return this.#var ? this.#var.get(key) : void 0;\n  };\n  get var() {\n    if (!this.#var) {\n      return {};\n    }\n    return Object.fromEntries(this.#var);\n  }\n  #newResponse(data, arg, headers) {\n    const responseHeaders = this.#res ? new Headers(this.#res.headers) : this.#preparedHeaders ?? new Headers();\n    if (typeof arg === \"object\" && \"headers\" in arg) {\n      const argHeaders = arg.headers instanceof Headers ? arg.headers : new Headers(arg.headers);\n      for (const [key, value] of argHeaders) {\n        if (key.toLowerCase() === \"set-cookie\") {\n          responseHeaders.append(key, value);\n        } else {\n          responseHeaders.set(key, value);\n        }\n      }\n    }\n    if (headers) {\n      for (const [k, v] of Object.entries(headers)) {\n        if (typeof v === \"string\") {\n          responseHeaders.set(k, v);\n        } else {\n          responseHeaders.delete(k);\n          for (const v2 of v) {\n            responseHeaders.append(k, v2);\n          }\n        }\n      }\n    }\n    const status = typeof arg === \"number\" ? arg : arg?.status ?? this.#status;\n    return new Response(data, { status, headers: responseHeaders });\n  }\n  newResponse = (...args) => this.#newResponse(...args);\n  body = (data, arg, headers) => this.#newResponse(data, arg, headers);\n  text = (text, arg, headers) => {\n    return !this.#preparedHeaders && !this.#status && !arg && !headers && !this.finalized ? new Response(text) : this.#newResponse(\n      text,\n      arg,\n      setDefaultContentType(TEXT_PLAIN, headers)\n    );\n  };\n  json = (object, arg, headers) => {\n    return this.#newResponse(\n      JSON.stringify(object),\n      arg,\n      setDefaultContentType(\"application/json\", headers)\n    );\n  };\n  html = (html, arg, headers) => {\n    const res = (html2) => this.#newResponse(html2, arg, setDefaultContentType(\"text/html; charset=UTF-8\", headers));\n    return typeof html === \"object\" ? resolveCallback(html, HtmlEscapedCallbackPhase.Stringify, false, {}).then(res) : res(html);\n  };\n  redirect = (location, status) => {\n    const locationString = String(location);\n    this.header(\n      \"Location\",\n      !/[^\\x00-\\xFF]/.test(locationString) ? locationString : encodeURI(locationString)\n    );\n    return this.newResponse(null, status ?? 302);\n  };\n  notFound = () => {\n    this.#notFoundHandler ??= () => new Response();\n    return this.#notFoundHandler(this);\n  };\n};\nexport {\n  Context,\n  TEXT_PLAIN\n};\n", "// src/router.ts\nvar METHOD_NAME_ALL = \"ALL\";\nvar METHOD_NAME_ALL_LOWERCASE = \"all\";\nvar METHODS = [\"get\", \"post\", \"put\", \"delete\", \"options\", \"patch\"];\nvar MESSAGE_MATCHER_IS_ALREADY_BUILT = \"Can not add a route since the matcher is already built.\";\nvar UnsupportedPathError = class extends Error {\n};\nexport {\n  MESSAGE_MATCHER_IS_ALREADY_BUILT,\n  METHODS,\n  METHOD_NAME_ALL,\n  METHOD_NAME_ALL_LOWERCASE,\n  UnsupportedPathError\n};\n", "// src/utils/constants.ts\nvar COMPOSED_HANDLER = \"__COMPOSED_HANDLER\";\nexport {\n  COMPOSED_HANDLER\n};\n", "// src/hono-base.ts\nimport { compose } from \"./compose.js\";\nimport { Context } from \"./context.js\";\nimport { METHODS, METHOD_NAME_ALL, METHOD_NAME_ALL_LOWERCASE } from \"./router.js\";\nimport { COMPOSED_HANDLER } from \"./utils/constants.js\";\nimport { getPath, getPathNoStrict, mergePath } from \"./utils/url.js\";\nvar notFoundHandler = (c) => {\n  return c.text(\"404 Not Found\", 404);\n};\nvar errorHandler = (err, c) => {\n  if (\"getResponse\" in err) {\n    const res = err.getResponse();\n    return c.newResponse(res.body, res);\n  }\n  console.error(err);\n  return c.text(\"Internal Server Error\", 500);\n};\nvar Hono = class {\n  get;\n  post;\n  put;\n  delete;\n  options;\n  patch;\n  all;\n  on;\n  use;\n  router;\n  getPath;\n  _basePath = \"/\";\n  #path = \"/\";\n  routes = [];\n  constructor(options = {}) {\n    const allMethods = [...METHODS, METHOD_NAME_ALL_LOWERCASE];\n    allMethods.forEach((method) => {\n      this[method] = (args1, ...args) => {\n        if (typeof args1 === \"string\") {\n          this.#path = args1;\n        } else {\n          this.#addRoute(method, this.#path, args1);\n        }\n        args.forEach((handler) => {\n          this.#addRoute(method, this.#path, handler);\n        });\n        return this;\n      };\n    });\n    this.on = (method, path, ...handlers) => {\n      for (const p of [path].flat()) {\n        this.#path = p;\n        for (const m of [method].flat()) {\n          handlers.map((handler) => {\n            this.#addRoute(m.toUpperCase(), this.#path, handler);\n          });\n        }\n      }\n      return this;\n    };\n    this.use = (arg1, ...handlers) => {\n      if (typeof arg1 === \"string\") {\n        this.#path = arg1;\n      } else {\n        this.#path = \"*\";\n        handlers.unshift(arg1);\n      }\n      handlers.forEach((handler) => {\n        this.#addRoute(METHOD_NAME_ALL, this.#path, handler);\n      });\n      return this;\n    };\n    const { strict, ...optionsWithoutStrict } = options;\n    Object.assign(this, optionsWithoutStrict);\n    this.getPath = strict ?? true ? options.getPath ?? getPath : getPathNoStrict;\n  }\n  #clone() {\n    const clone = new Hono({\n      router: this.router,\n      getPath: this.getPath\n    });\n    clone.errorHandler = this.errorHandler;\n    clone.#notFoundHandler = this.#notFoundHandler;\n    clone.routes = this.routes;\n    return clone;\n  }\n  #notFoundHandler = notFoundHandler;\n  errorHandler = errorHandler;\n  route(path, app) {\n    const subApp = this.basePath(path);\n    app.routes.map((r) => {\n      let handler;\n      if (app.errorHandler === errorHandler) {\n        handler = r.handler;\n      } else {\n        handler = async (c, next) => (await compose([], app.errorHandler)(c, () => r.handler(c, next))).res;\n        handler[COMPOSED_HANDLER] = r.handler;\n      }\n      subApp.#addRoute(r.method, r.path, handler);\n    });\n    return this;\n  }\n  basePath(path) {\n    const subApp = this.#clone();\n    subApp._basePath = mergePath(this._basePath, path);\n    return subApp;\n  }\n  onError = (handler) => {\n    this.errorHandler = handler;\n    return this;\n  };\n  notFound = (handler) => {\n    this.#notFoundHandler = handler;\n    return this;\n  };\n  mount(path, applicationHandler, options) {\n    let replaceRequest;\n    let optionHandler;\n    if (options) {\n      if (typeof options === \"function\") {\n        optionHandler = options;\n      } else {\n        optionHandler = options.optionHandler;\n        if (options.replaceRequest === false) {\n          replaceRequest = (request) => request;\n        } else {\n          replaceRequest = options.replaceRequest;\n        }\n      }\n    }\n    const getOptions = optionHandler ? (c) => {\n      const options2 = optionHandler(c);\n      return Array.isArray(options2) ? options2 : [options2];\n    } : (c) => {\n      let executionContext = void 0;\n      try {\n        executionContext = c.executionCtx;\n      } catch {\n      }\n      return [c.env, executionContext];\n    };\n    replaceRequest ||= (() => {\n      const mergedPath = mergePath(this._basePath, path);\n      const pathPrefixLength = mergedPath === \"/\" ? 0 : mergedPath.length;\n      return (request) => {\n        const url = new URL(request.url);\n        url.pathname = url.pathname.slice(pathPrefixLength) || \"/\";\n        return new Request(url, request);\n      };\n    })();\n    const handler = async (c, next) => {\n      const res = await applicationHandler(replaceRequest(c.req.raw), ...getOptions(c));\n      if (res) {\n        return res;\n      }\n      await next();\n    };\n    this.#addRoute(METHOD_NAME_ALL, mergePath(path, \"*\"), handler);\n    return this;\n  }\n  #addRoute(method, path, handler) {\n    method = method.toUpperCase();\n    path = mergePath(this._basePath, path);\n    const r = { basePath: this._basePath, path, method, handler };\n    this.router.add(method, path, [handler, r]);\n    this.routes.push(r);\n  }\n  #handleError(err, c) {\n    if (err instanceof Error) {\n      return this.errorHandler(err, c);\n    }\n    throw err;\n  }\n  #dispatch(request, executionCtx, env, method) {\n    if (method === \"HEAD\") {\n      return (async () => new Response(null, await this.#dispatch(request, executionCtx, env, \"GET\")))();\n    }\n    const path = this.getPath(request, { env });\n    const matchResult = this.router.match(method, path);\n    const c = new Context(request, {\n      path,\n      matchResult,\n      env,\n      executionCtx,\n      notFoundHandler: this.#notFoundHandler\n    });\n    if (matchResult[0].length === 1) {\n      let res;\n      try {\n        res = matchResult[0][0][0][0](c, async () => {\n          c.res = await this.#notFoundHandler(c);\n        });\n      } catch (err) {\n        return this.#handleError(err, c);\n      }\n      return res instanceof Promise ? res.then(\n        (resolved) => resolved || (c.finalized ? c.res : this.#notFoundHandler(c))\n      ).catch((err) => this.#handleError(err, c)) : res ?? this.#notFoundHandler(c);\n    }\n    const composed = compose(matchResult[0], this.errorHandler, this.#notFoundHandler);\n    return (async () => {\n      try {\n        const context = await composed(c);\n        if (!context.finalized) {\n          throw new Error(\n            \"Context is not finalized. Did you forget to return a Response object or `await next()`?\"\n          );\n        }\n        return context.res;\n      } catch (err) {\n        return this.#handleError(err, c);\n      }\n    })();\n  }\n  fetch = (request, ...rest) => {\n    return this.#dispatch(request, rest[1], rest[0], request.method);\n  };\n  request = (input, requestInit, Env, executionCtx) => {\n    if (input instanceof Request) {\n      return this.fetch(requestInit ? new Request(input, requestInit) : input, Env, executionCtx);\n    }\n    input = input.toString();\n    return this.fetch(\n      new Request(\n        /^https?:\\/\\//.test(input) ? input : `http://localhost${mergePath(\"/\", input)}`,\n        requestInit\n      ),\n      Env,\n      executionCtx\n    );\n  };\n  fire = () => {\n    addEventListener(\"fetch\", (event) => {\n      event.respondWith(this.#dispatch(event.request, event, void 0, event.request.method));\n    });\n  };\n};\nexport {\n  Hono as HonoBase\n};\n", "// src/router/reg-exp-router/matcher.ts\nimport { METHOD_NAME_ALL } from \"../../router.js\";\nvar emptyParam = [];\nfunction match(method, path) {\n  const matchers = this.buildAllMatchers();\n  const match2 = (method2, path2) => {\n    const matcher = matchers[method2] || matchers[METHOD_NAME_ALL];\n    const staticMatch = matcher[2][path2];\n    if (staticMatch) {\n      return staticMatch;\n    }\n    const match3 = path2.match(matcher[0]);\n    if (!match3) {\n      return [[], emptyParam];\n    }\n    const index = match3.indexOf(\"\", 1);\n    return [matcher[1][index], match3];\n  };\n  this.match = match2;\n  return match2(method, path);\n}\nexport {\n  emptyParam,\n  match\n};\n", "// src/router/reg-exp-router/node.ts\nvar LABEL_REG_EXP_STR = \"[^/]+\";\nvar ONLY_WILDCARD_REG_EXP_STR = \".*\";\nvar TAIL_WILDCARD_REG_EXP_STR = \"(?:|/.*)\";\nvar PATH_ERROR = Symbol();\nvar regExpMetaChars = new Set(\".\\\\+*[^]$()\");\nfunction compareKey(a, b) {\n  if (a.length === 1) {\n    return b.length === 1 ? a < b ? -1 : 1 : -1;\n  }\n  if (b.length === 1) {\n    return 1;\n  }\n  if (a === ONLY_WILDCARD_REG_EXP_STR || a === TAIL_WILDCARD_REG_EXP_STR) {\n    return 1;\n  } else if (b === ONLY_WILDCARD_REG_EXP_STR || b === TAIL_WILDCARD_REG_EXP_STR) {\n    return -1;\n  }\n  if (a === LABEL_REG_EXP_STR) {\n    return 1;\n  } else if (b === LABEL_REG_EXP_STR) {\n    return -1;\n  }\n  return a.length === b.length ? a < b ? -1 : 1 : b.length - a.length;\n}\nvar Node = class {\n  #index;\n  #varIndex;\n  #children = /* @__PURE__ */ Object.create(null);\n  insert(tokens, index, paramMap, context, pathErrorCheckOnly) {\n    if (tokens.length === 0) {\n      if (this.#index !== void 0) {\n        throw PATH_ERROR;\n      }\n      if (pathErrorCheckOnly) {\n        return;\n      }\n      this.#index = index;\n      return;\n    }\n    const [token, ...restTokens] = tokens;\n    const pattern = token === \"*\" ? restTokens.length === 0 ? [\"\", \"\", ONLY_WILDCARD_REG_EXP_STR] : [\"\", \"\", LABEL_REG_EXP_STR] : token === \"/*\" ? [\"\", \"\", TAIL_WILDCARD_REG_EXP_STR] : token.match(/^\\:([^\\{\\}]+)(?:\\{(.+)\\})?$/);\n    let node;\n    if (pattern) {\n      const name = pattern[1];\n      let regexpStr = pattern[2] || LABEL_REG_EXP_STR;\n      if (name && pattern[2]) {\n        if (regexpStr === \".*\") {\n          throw PATH_ERROR;\n        }\n        regexpStr = regexpStr.replace(/^\\((?!\\?:)(?=[^)]+\\)$)/, \"(?:\");\n        if (/\\((?!\\?:)/.test(regexpStr)) {\n          throw PATH_ERROR;\n        }\n      }\n      node = this.#children[regexpStr];\n      if (!node) {\n        if (Object.keys(this.#children).some(\n          (k) => k !== ONLY_WILDCARD_REG_EXP_STR && k !== TAIL_WILDCARD_REG_EXP_STR\n        )) {\n          throw PATH_ERROR;\n        }\n        if (pathErrorCheckOnly) {\n          return;\n        }\n        node = this.#children[regexpStr] = new Node();\n        if (name !== \"\") {\n          node.#varIndex = context.varIndex++;\n        }\n      }\n      if (!pathErrorCheckOnly && name !== \"\") {\n        paramMap.push([name, node.#varIndex]);\n      }\n    } else {\n      node = this.#children[token];\n      if (!node) {\n        if (Object.keys(this.#children).some(\n          (k) => k.length > 1 && k !== ONLY_WILDCARD_REG_EXP_STR && k !== TAIL_WILDCARD_REG_EXP_STR\n        )) {\n          throw PATH_ERROR;\n        }\n        if (pathErrorCheckOnly) {\n          return;\n        }\n        node = this.#children[token] = new Node();\n      }\n    }\n    node.insert(restTokens, index, paramMap, context, pathErrorCheckOnly);\n  }\n  buildRegExpStr() {\n    const childKeys = Object.keys(this.#children).sort(compareKey);\n    const strList = childKeys.map((k) => {\n      const c = this.#children[k];\n      return (typeof c.#varIndex === \"number\" ? `(${k})@${c.#varIndex}` : regExpMetaChars.has(k) ? `\\\\${k}` : k) + c.buildRegExpStr();\n    });\n    if (typeof this.#index === \"number\") {\n      strList.unshift(`#${this.#index}`);\n    }\n    if (strList.length === 0) {\n      return \"\";\n    }\n    if (strList.length === 1) {\n      return strList[0];\n    }\n    return \"(?:\" + strList.join(\"|\") + \")\";\n  }\n};\nexport {\n  Node,\n  PATH_ERROR\n};\n", "// src/router/reg-exp-router/trie.ts\nimport { Node } from \"./node.js\";\nvar Trie = class {\n  #context = { varIndex: 0 };\n  #root = new Node();\n  insert(path, index, pathErrorCheckOnly) {\n    const paramAssoc = [];\n    const groups = [];\n    for (let i = 0; ; ) {\n      let replaced = false;\n      path = path.replace(/\\{[^}]+\\}/g, (m) => {\n        const mark = `@\\\\${i}`;\n        groups[i] = [mark, m];\n        i++;\n        replaced = true;\n        return mark;\n      });\n      if (!replaced) {\n        break;\n      }\n    }\n    const tokens = path.match(/(?::[^\\/]+)|(?:\\/\\*$)|./g) || [];\n    for (let i = groups.length - 1; i >= 0; i--) {\n      const [mark] = groups[i];\n      for (let j = tokens.length - 1; j >= 0; j--) {\n        if (tokens[j].indexOf(mark) !== -1) {\n          tokens[j] = tokens[j].replace(mark, groups[i][1]);\n          break;\n        }\n      }\n    }\n    this.#root.insert(tokens, index, paramAssoc, this.#context, pathErrorCheckOnly);\n    return paramAssoc;\n  }\n  buildRegExp() {\n    let regexp = this.#root.buildRegExpStr();\n    if (regexp === \"\") {\n      return [/^$/, [], []];\n    }\n    let captureIndex = 0;\n    const indexReplacementMap = [];\n    const paramReplacementMap = [];\n    regexp = regexp.replace(/#(\\d+)|@(\\d+)|\\.\\*\\$/g, (_, handlerIndex, paramIndex) => {\n      if (handlerIndex !== void 0) {\n        indexReplacementMap[++captureIndex] = Number(handlerIndex);\n        return \"$()\";\n      }\n      if (paramIndex !== void 0) {\n        paramReplacementMap[Number(paramIndex)] = ++captureIndex;\n        return \"\";\n      }\n      return \"\";\n    });\n    return [new RegExp(`^${regexp}`), indexReplacementMap, paramReplacementMap];\n  }\n};\nexport {\n  Trie\n};\n", "// src/router/reg-exp-router/router.ts\nimport {\n  MESSAGE_MATCHER_IS_ALREADY_BUILT,\n  METHOD_NAME_ALL,\n  UnsupportedPathError\n} from \"../../router.js\";\nimport { checkOptionalParameter } from \"../../utils/url.js\";\nimport { match, emptyParam } from \"./matcher.js\";\nimport { PATH_ERROR } from \"./node.js\";\nimport { Trie } from \"./trie.js\";\nvar nullMatcher = [/^$/, [], /* @__PURE__ */ Object.create(null)];\nvar wildcardRegExpCache = /* @__PURE__ */ Object.create(null);\nfunction buildWildcardRegExp(path) {\n  return wildcardRegExpCache[path] ??= new RegExp(\n    path === \"*\" ? \"\" : `^${path.replace(\n      /\\/\\*$|([.\\\\+*[^\\]$()])/g,\n      (_, metaChar) => metaChar ? `\\\\${metaChar}` : \"(?:|/.*)\"\n    )}$`\n  );\n}\nfunction clearWildcardRegExpCache() {\n  wildcardRegExpCache = /* @__PURE__ */ Object.create(null);\n}\nfunction buildMatcherFromPreprocessedRoutes(routes) {\n  const trie = new Trie();\n  const handlerData = [];\n  if (routes.length === 0) {\n    return nullMatcher;\n  }\n  const routesWithStaticPathFlag = routes.map(\n    (route) => [!/\\*|\\/:/.test(route[0]), ...route]\n  ).sort(\n    ([isStaticA, pathA], [isStaticB, pathB]) => isStaticA ? 1 : isStaticB ? -1 : pathA.length - pathB.length\n  );\n  const staticMap = /* @__PURE__ */ Object.create(null);\n  for (let i = 0, j = -1, len = routesWithStaticPathFlag.length; i < len; i++) {\n    const [pathErrorCheckOnly, path, handlers] = routesWithStaticPathFlag[i];\n    if (pathErrorCheckOnly) {\n      staticMap[path] = [handlers.map(([h]) => [h, /* @__PURE__ */ Object.create(null)]), emptyParam];\n    } else {\n      j++;\n    }\n    let paramAssoc;\n    try {\n      paramAssoc = trie.insert(path, j, pathErrorCheckOnly);\n    } catch (e) {\n      throw e === PATH_ERROR ? new UnsupportedPathError(path) : e;\n    }\n    if (pathErrorCheckOnly) {\n      continue;\n    }\n    handlerData[j] = handlers.map(([h, paramCount]) => {\n      const paramIndexMap = /* @__PURE__ */ Object.create(null);\n      paramCount -= 1;\n      for (; paramCount >= 0; paramCount--) {\n        const [key, value] = paramAssoc[paramCount];\n        paramIndexMap[key] = value;\n      }\n      return [h, paramIndexMap];\n    });\n  }\n  const [regexp, indexReplacementMap, paramReplacementMap] = trie.buildRegExp();\n  for (let i = 0, len = handlerData.length; i < len; i++) {\n    for (let j = 0, len2 = handlerData[i].length; j < len2; j++) {\n      const map = handlerData[i][j]?.[1];\n      if (!map) {\n        continue;\n      }\n      const keys = Object.keys(map);\n      for (let k = 0, len3 = keys.length; k < len3; k++) {\n        map[keys[k]] = paramReplacementMap[map[keys[k]]];\n      }\n    }\n  }\n  const handlerMap = [];\n  for (const i in indexReplacementMap) {\n    handlerMap[i] = handlerData[indexReplacementMap[i]];\n  }\n  return [regexp, handlerMap, staticMap];\n}\nfunction findMiddleware(middleware, path) {\n  if (!middleware) {\n    return void 0;\n  }\n  for (const k of Object.keys(middleware).sort((a, b) => b.length - a.length)) {\n    if (buildWildcardRegExp(k).test(path)) {\n      return [...middleware[k]];\n    }\n  }\n  return void 0;\n}\nvar RegExpRouter = class {\n  name = \"RegExpRouter\";\n  #middleware;\n  #routes;\n  constructor() {\n    this.#middleware = { [METHOD_NAME_ALL]: /* @__PURE__ */ Object.create(null) };\n    this.#routes = { [METHOD_NAME_ALL]: /* @__PURE__ */ Object.create(null) };\n  }\n  add(method, path, handler) {\n    const middleware = this.#middleware;\n    const routes = this.#routes;\n    if (!middleware || !routes) {\n      throw new Error(MESSAGE_MATCHER_IS_ALREADY_BUILT);\n    }\n    if (!middleware[method]) {\n      ;\n      [middleware, routes].forEach((handlerMap) => {\n        handlerMap[method] = /* @__PURE__ */ Object.create(null);\n        Object.keys(handlerMap[METHOD_NAME_ALL]).forEach((p) => {\n          handlerMap[method][p] = [...handlerMap[METHOD_NAME_ALL][p]];\n        });\n      });\n    }\n    if (path === \"/*\") {\n      path = \"*\";\n    }\n    const paramCount = (path.match(/\\/:/g) || []).length;\n    if (/\\*$/.test(path)) {\n      const re = buildWildcardRegExp(path);\n      if (method === METHOD_NAME_ALL) {\n        Object.keys(middleware).forEach((m) => {\n          middleware[m][path] ||= findMiddleware(middleware[m], path) || findMiddleware(middleware[METHOD_NAME_ALL], path) || [];\n        });\n      } else {\n        middleware[method][path] ||= findMiddleware(middleware[method], path) || findMiddleware(middleware[METHOD_NAME_ALL], path) || [];\n      }\n      Object.keys(middleware).forEach((m) => {\n        if (method === METHOD_NAME_ALL || method === m) {\n          Object.keys(middleware[m]).forEach((p) => {\n            re.test(p) && middleware[m][p].push([handler, paramCount]);\n          });\n        }\n      });\n      Object.keys(routes).forEach((m) => {\n        if (method === METHOD_NAME_ALL || method === m) {\n          Object.keys(routes[m]).forEach(\n            (p) => re.test(p) && routes[m][p].push([handler, paramCount])\n          );\n        }\n      });\n      return;\n    }\n    const paths = checkOptionalParameter(path) || [path];\n    for (let i = 0, len = paths.length; i < len; i++) {\n      const path2 = paths[i];\n      Object.keys(routes).forEach((m) => {\n        if (method === METHOD_NAME_ALL || method === m) {\n          routes[m][path2] ||= [\n            ...findMiddleware(middleware[m], path2) || findMiddleware(middleware[METHOD_NAME_ALL], path2) || []\n          ];\n          routes[m][path2].push([handler, paramCount - len + i + 1]);\n        }\n      });\n    }\n  }\n  match = match;\n  buildAllMatchers() {\n    const matchers = /* @__PURE__ */ Object.create(null);\n    Object.keys(this.#routes).concat(Object.keys(this.#middleware)).forEach((method) => {\n      matchers[method] ||= this.#buildMatcher(method);\n    });\n    this.#middleware = this.#routes = void 0;\n    clearWildcardRegExpCache();\n    return matchers;\n  }\n  #buildMatcher(method) {\n    const routes = [];\n    let hasOwnRoute = method === METHOD_NAME_ALL;\n    [this.#middleware, this.#routes].forEach((r) => {\n      const ownRoute = r[method] ? Object.keys(r[method]).map((path) => [path, r[method][path]]) : [];\n      if (ownRoute.length !== 0) {\n        hasOwnRoute ||= true;\n        routes.push(...ownRoute);\n      } else if (method !== METHOD_NAME_ALL) {\n        routes.push(\n          ...Object.keys(r[METHOD_NAME_ALL]).map((path) => [path, r[METHOD_NAME_ALL][path]])\n        );\n      }\n    });\n    if (!hasOwnRoute) {\n      return null;\n    } else {\n      return buildMatcherFromPreprocessedRoutes(routes);\n    }\n  }\n};\nexport {\n  RegExpRouter\n};\n", "// src/router/smart-router/router.ts\nimport { MESSAGE_MATCHER_IS_ALREADY_BUILT, UnsupportedPathError } from \"../../router.js\";\nvar SmartRouter = class {\n  name = \"SmartRouter\";\n  #routers = [];\n  #routes = [];\n  constructor(init) {\n    this.#routers = init.routers;\n  }\n  add(method, path, handler) {\n    if (!this.#routes) {\n      throw new Error(MESSAGE_MATCHER_IS_ALREADY_BUILT);\n    }\n    this.#routes.push([method, path, handler]);\n  }\n  match(method, path) {\n    if (!this.#routes) {\n      throw new Error(\"Fatal error\");\n    }\n    const routers = this.#routers;\n    const routes = this.#routes;\n    const len = routers.length;\n    let i = 0;\n    let res;\n    for (; i < len; i++) {\n      const router = routers[i];\n      try {\n        for (let i2 = 0, len2 = routes.length; i2 < len2; i2++) {\n          router.add(...routes[i2]);\n        }\n        res = router.match(method, path);\n      } catch (e) {\n        if (e instanceof UnsupportedPathError) {\n          continue;\n        }\n        throw e;\n      }\n      this.match = router.match.bind(router);\n      this.#routers = [router];\n      this.#routes = void 0;\n      break;\n    }\n    if (i === len) {\n      throw new Error(\"Fatal error\");\n    }\n    this.name = `SmartRouter + ${this.activeRouter.name}`;\n    return res;\n  }\n  get activeRouter() {\n    if (this.#routes || this.#routers.length !== 1) {\n      throw new Error(\"No active router has been determined yet.\");\n    }\n    return this.#routers[0];\n  }\n};\nexport {\n  SmartRouter\n};\n", "// src/router/trie-router/node.ts\nimport { METHOD_NAME_ALL } from \"../../router.js\";\nimport { getPattern, splitPath, splitRoutingPath } from \"../../utils/url.js\";\nvar emptyParams = /* @__PURE__ */ Object.create(null);\nvar Node = class {\n  #methods;\n  #children;\n  #patterns;\n  #order = 0;\n  #params = emptyParams;\n  constructor(method, handler, children) {\n    this.#children = children || /* @__PURE__ */ Object.create(null);\n    this.#methods = [];\n    if (method && handler) {\n      const m = /* @__PURE__ */ Object.create(null);\n      m[method] = { handler, possibleKeys: [], score: 0 };\n      this.#methods = [m];\n    }\n    this.#patterns = [];\n  }\n  insert(method, path, handler) {\n    this.#order = ++this.#order;\n    let curNode = this;\n    const parts = splitRoutingPath(path);\n    const possibleKeys = [];\n    for (let i = 0, len = parts.length; i < len; i++) {\n      const p = parts[i];\n      const nextP = parts[i + 1];\n      const pattern = getPattern(p, nextP);\n      const key = Array.isArray(pattern) ? pattern[0] : p;\n      if (key in curNode.#children) {\n        curNode = curNode.#children[key];\n        if (pattern) {\n          possibleKeys.push(pattern[1]);\n        }\n        continue;\n      }\n      curNode.#children[key] = new Node();\n      if (pattern) {\n        curNode.#patterns.push(pattern);\n        possibleKeys.push(pattern[1]);\n      }\n      curNode = curNode.#children[key];\n    }\n    curNode.#methods.push({\n      [method]: {\n        handler,\n        possibleKeys: possibleKeys.filter((v, i, a) => a.indexOf(v) === i),\n        score: this.#order\n      }\n    });\n    return curNode;\n  }\n  #getHandlerSets(node, method, nodeParams, params) {\n    const handlerSets = [];\n    for (let i = 0, len = node.#methods.length; i < len; i++) {\n      const m = node.#methods[i];\n      const handlerSet = m[method] || m[METHOD_NAME_ALL];\n      const processedSet = {};\n      if (handlerSet !== void 0) {\n        handlerSet.params = /* @__PURE__ */ Object.create(null);\n        handlerSets.push(handlerSet);\n        if (nodeParams !== emptyParams || params && params !== emptyParams) {\n          for (let i2 = 0, len2 = handlerSet.possibleKeys.length; i2 < len2; i2++) {\n            const key = handlerSet.possibleKeys[i2];\n            const processed = processedSet[handlerSet.score];\n            handlerSet.params[key] = params?.[key] && !processed ? params[key] : nodeParams[key] ?? params?.[key];\n            processedSet[handlerSet.score] = true;\n          }\n        }\n      }\n    }\n    return handlerSets;\n  }\n  search(method, path) {\n    const handlerSets = [];\n    this.#params = emptyParams;\n    const curNode = this;\n    let curNodes = [curNode];\n    const parts = splitPath(path);\n    const curNodesQueue = [];\n    for (let i = 0, len = parts.length; i < len; i++) {\n      const part = parts[i];\n      const isLast = i === len - 1;\n      const tempNodes = [];\n      for (let j = 0, len2 = curNodes.length; j < len2; j++) {\n        const node = curNodes[j];\n        const nextNode = node.#children[part];\n        if (nextNode) {\n          nextNode.#params = node.#params;\n          if (isLast) {\n            if (nextNode.#children[\"*\"]) {\n              handlerSets.push(\n                ...this.#getHandlerSets(nextNode.#children[\"*\"], method, node.#params)\n              );\n            }\n            handlerSets.push(...this.#getHandlerSets(nextNode, method, node.#params));\n          } else {\n            tempNodes.push(nextNode);\n          }\n        }\n        for (let k = 0, len3 = node.#patterns.length; k < len3; k++) {\n          const pattern = node.#patterns[k];\n          const params = node.#params === emptyParams ? {} : { ...node.#params };\n          if (pattern === \"*\") {\n            const astNode = node.#children[\"*\"];\n            if (astNode) {\n              handlerSets.push(...this.#getHandlerSets(astNode, method, node.#params));\n              astNode.#params = params;\n              tempNodes.push(astNode);\n            }\n            continue;\n          }\n          const [key, name, matcher] = pattern;\n          if (!part && !(matcher instanceof RegExp)) {\n            continue;\n          }\n          const child = node.#children[key];\n          const restPathString = parts.slice(i).join(\"/\");\n          if (matcher instanceof RegExp) {\n            const m = matcher.exec(restPathString);\n            if (m) {\n              params[name] = m[0];\n              handlerSets.push(...this.#getHandlerSets(child, method, node.#params, params));\n              if (Object.keys(child.#children).length) {\n                child.#params = params;\n                const componentCount = m[0].match(/\\//)?.length ?? 0;\n                const targetCurNodes = curNodesQueue[componentCount] ||= [];\n                targetCurNodes.push(child);\n              }\n              continue;\n            }\n          }\n          if (matcher === true || matcher.test(part)) {\n            params[name] = part;\n            if (isLast) {\n              handlerSets.push(...this.#getHandlerSets(child, method, params, node.#params));\n              if (child.#children[\"*\"]) {\n                handlerSets.push(\n                  ...this.#getHandlerSets(child.#children[\"*\"], method, params, node.#params)\n                );\n              }\n            } else {\n              child.#params = params;\n              tempNodes.push(child);\n            }\n          }\n        }\n      }\n      curNodes = tempNodes.concat(curNodesQueue.shift() ?? []);\n    }\n    if (handlerSets.length > 1) {\n      handlerSets.sort((a, b) => {\n        return a.score - b.score;\n      });\n    }\n    return [handlerSets.map(({ handler, params }) => [handler, params])];\n  }\n};\nexport {\n  Node\n};\n", "// src/router/trie-router/router.ts\nimport { checkOptionalParameter } from \"../../utils/url.js\";\nimport { Node } from \"./node.js\";\nvar TrieRouter = class {\n  name = \"TrieRouter\";\n  #node;\n  constructor() {\n    this.#node = new Node();\n  }\n  add(method, path, handler) {\n    const results = checkOptionalParameter(path);\n    if (results) {\n      for (let i = 0, len = results.length; i < len; i++) {\n        this.#node.insert(method, results[i], handler);\n      }\n      return;\n    }\n    this.#node.insert(method, path, handler);\n  }\n  match(method, path) {\n    return this.#node.search(method, path);\n  }\n};\nexport {\n  TrieRouter\n};\n", "// src/hono.ts\nimport { HonoBase } from \"./hono-base.js\";\nimport { RegExpRouter } from \"./router/reg-exp-router/index.js\";\nimport { SmartRouter } from \"./router/smart-router/index.js\";\nimport { TrieRouter } from \"./router/trie-router/index.js\";\nvar Hono = class extends HonoBase {\n  constructor(options = {}) {\n    super(options);\n    this.router = options.router ?? new SmartRouter({\n      routers: [new RegExpRouter(), new TrieRouter()]\n    });\n  }\n};\nexport {\n  Hono\n};\n", "import { Hono } from 'hono'\r\n\r\n// Replace generic cors with strict configurable CORS + debug logging\r\nconst app = new Hono()\r\napp.use('*', async (c, next) => {\r\n  const allowed = (c.env.ALLOWED_ORIGIN || '').split(',').map(s=>s.trim()).filter(Boolean)\r\n  const origin = c.req.header('Origin')\r\n  const debugMode = ['1','true','yes'].includes(String(c.req.query('debug') || c.env.DEBUG || '').toLowerCase())\r\n  const allowOrigin = (origin && allowed.includes(origin)) ? origin : ''\r\n  if (allowOrigin) c.res.headers.set('Access-Control-Allow-Origin', allowOrigin)\r\n  c.res.headers.set('Vary','Origin')\r\n  c.res.headers.set('Access-Control-Allow-Headers','Content-Type, Idempotency-Key')\r\n  c.res.headers.set('Access-Control-Allow-Methods','GET,POST,OPTIONS')\r\n  if (debugMode) {\r\n    try { console.log('CORS', { origin, allowOrigin, allowed }) } catch {}\r\n    c.res.headers.set('X-Debug-Origin', origin || '')\r\n    c.res.headers.set('X-Debug-Allow', allowOrigin || '')\r\n  }\r\n  if (c.req.method === 'OPTIONS') return new Response('', { headers: c.res.headers })\r\n  await next()\r\n})\r\n\r\n// Helpers\r\nconst addMonths = (date, months) => {\r\n  const d = new Date(date)\r\n  const day = d.getUTCDate()\r\n  const target = new Date(Date.UTC(d.getUTCFullYear(), d.getUTCMonth() + months + 1, 0))\r\n  const clampedDay = Math.min(day, target.getUTCDate())\r\n  return new Date(Date.UTC(d.getUTCFullYear(), d.getUTCMonth() + months, clampedDay, d.getUTCHours(), d.getUTCMinutes(), d.getUTCSeconds()))\r\n}\r\n\r\nconst toIso = (d) => new Date(d).toISOString()\r\n\r\n// --- Schema compatibility helpers (users/user_id vs members/member_id) ---\r\nlet __schemaCache\r\nasync function getSchema(db){\r\n  if (__schemaCache) return __schemaCache\r\n  // Detect memberships FK column (prefer user_id if present, else member_id)\r\n  const mcols = await db.prepare('PRAGMA table_info(memberships)').all().catch(()=>({ results: [] }))\r\n  const mnames = new Set((mcols?.results||[]).map(c => String(c.name||'').toLowerCase()))\r\n  const fkColumn = mnames.has('user_id') ? 'user_id' : (mnames.has('member_id') ? 'member_id' : 'user_id')\r\n  // Identity is consolidated to users\r\n  const identityTable = 'users'\r\n  // Detect id column in users (user_id vs id)\r\n  let idColumn = 'user_id'\r\n  try {\r\n    const ic = await db.prepare('PRAGMA table_info(users)').all().catch(()=>({ results: [] }))\r\n    const inames = new Set((ic?.results||[]).map(r => String(r.name||'').toLowerCase()))\r\n    if (inames.has('user_id')) idColumn = 'user_id'\r\n    else if (inames.has('id')) idColumn = 'id'\r\n    else {\r\n      const pk = (ic?.results||[]).find(r => r.pk === 1)\r\n      if (pk && pk.name) idColumn = String(pk.name)\r\n    }\r\n  } catch {}\r\n  __schemaCache = { fkColumn, identityTable, idColumn }\r\n  return __schemaCache\r\n}\r\n\r\nasync function ensureSchema(db, fkColumn){\r\n  // memberships columns only (assume tickets already has user_id from migrations)\r\n  try {\r\n    const mc = await db.prepare('PRAGMA table_info(memberships)').all().catch(()=>({ results: [] }))\r\n    const mnames = new Set((mc?.results||[]).map(r => String(r.name||'').toLowerCase()))\r\n    const alter = []\r\n    if (!mnames.has('amount')) alter.push('ALTER TABLE memberships ADD COLUMN amount TEXT')\r\n    if (!mnames.has('currency')) alter.push('ALTER TABLE memberships ADD COLUMN currency TEXT')\r\n    if (!mnames.has('consent_at')) alter.push('ALTER TABLE memberships ADD COLUMN consent_at TEXT')\r\n    if (!mnames.has('idempotency_key')) alter.push('ALTER TABLE memberships ADD COLUMN idempotency_key TEXT')\r\n    if (!mnames.has('payment_status')) alter.push('ALTER TABLE memberships ADD COLUMN payment_status TEXT')\r\n    if (!mnames.has('payment_instrument_id')) alter.push('ALTER TABLE memberships ADD COLUMN payment_instrument_id TEXT')\r\n    if (!mnames.has('renewal_failed_at')) alter.push('ALTER TABLE memberships ADD COLUMN renewal_failed_at TEXT')\r\n    if (!mnames.has('renewal_attempts')) alter.push('ALTER TABLE memberships ADD COLUMN renewal_attempts INTEGER DEFAULT 0')\r\n    for (const sql of alter) { await db.prepare(sql).run().catch(()=>{}) }\r\n  } catch {}\r\n  // tickets columns (post consolidation, expect user_id)\r\n  try {\r\n    const tc = await db.prepare('PRAGMA table_info(tickets)').all().catch(()=>({ results: [] }))\r\n    const tnames = new Set((tc?.results||[]).map(r => String(r.name||'').toLowerCase()))\r\n    const talter = []\r\n    if (!tnames.has('amount')) talter.push('ALTER TABLE tickets ADD COLUMN amount TEXT')\r\n    if (!tnames.has('currency')) talter.push('ALTER TABLE tickets ADD COLUMN currency TEXT')\r\n    if (!tnames.has('consent_at')) talter.push('ALTER TABLE tickets ADD COLUMN consent_at TEXT')\r\n    if (!tnames.has('idempotency_key')) talter.push('ALTER TABLE tickets ADD COLUMN idempotency_key TEXT')\r\n    if (!tnames.has('payment_status')) talter.push('ALTER TABLE tickets ADD COLUMN payment_status TEXT')\r\n    if (!tnames.has('created_at')) talter.push('ALTER TABLE tickets ADD COLUMN created_at TEXT')\r\n    for (const sql of talter) { await db.prepare(sql).run().catch(()=>{}) }\r\n  } catch {}\r\n  // Create payment_instruments table if not exists\r\n  try {\r\n    await db.prepare(`\r\n      CREATE TABLE IF NOT EXISTS payment_instruments (\r\n        id INTEGER PRIMARY KEY AUTOINCREMENT,\r\n        user_id INTEGER NOT NULL,\r\n        instrument_id TEXT NOT NULL,\r\n        card_type TEXT,\r\n        last_4 TEXT,\r\n        expiry_month INTEGER,\r\n        expiry_year INTEGER,\r\n        created_at TEXT NOT NULL,\r\n        updated_at TEXT NOT NULL,\r\n        is_active INTEGER DEFAULT 1,\r\n        UNIQUE(user_id, instrument_id)\r\n      )\r\n    `).run().catch(()=>{})\r\n  } catch {}\r\n  // Create renewal_log table for tracking renewal attempts\r\n  try {\r\n    await db.prepare(`\r\n      CREATE TABLE IF NOT EXISTS renewal_log (\r\n        id INTEGER PRIMARY KEY AUTOINCREMENT,\r\n        membership_id INTEGER NOT NULL,\r\n        attempt_date TEXT NOT NULL,\r\n        status TEXT NOT NULL,\r\n        payment_id TEXT,\r\n        error_message TEXT,\r\n        amount TEXT,\r\n        currency TEXT\r\n      )\r\n    `).run().catch(()=>{})\r\n  } catch {}\r\n  // Create transactions table for all payment records\r\n  try {\r\n    await db.prepare(`\r\n      CREATE TABLE IF NOT EXISTS transactions (\r\n        id INTEGER PRIMARY KEY AUTOINCREMENT,\r\n        transaction_type TEXT NOT NULL,\r\n        reference_id INTEGER,\r\n        user_id INTEGER,\r\n        email TEXT,\r\n        name TEXT,\r\n        order_ref TEXT UNIQUE,\r\n        checkout_id TEXT,\r\n        payment_id TEXT,\r\n        amount TEXT,\r\n        currency TEXT,\r\n        payment_status TEXT,\r\n        idempotency_key TEXT,\r\n        consent_at TEXT,\r\n        created_at TEXT NOT NULL DEFAULT (strftime('%Y-%m-%dT%H:%M:%fZ','now')),\r\n        updated_at TEXT\r\n      )\r\n    `).run().catch(()=>{})\r\n  } catch {}\r\n}\r\n\r\n// One-time migration: copy payment data from memberships/tickets to transactions\r\nasync function migrateToTransactions(db) {\r\n  try {\r\n    // Check if migration already ran\r\n    const check = await db.prepare('SELECT COUNT(*) as count FROM transactions').first()\r\n    if (check && check.count > 0) {\r\n      console.log('Transactions table already has data, skipping migration')\r\n      return\r\n    }\r\n    \r\n    console.log('Starting migration to transactions table...')\r\n    \r\n    // Migrate memberships\r\n    const memberships = await db.prepare(`\r\n      SELECT id, user_id, email, name, order_ref, checkout_id, payment_id, amount, currency, \r\n             payment_status, idempotency_key, consent_at, created_at\r\n      FROM memberships\r\n      WHERE order_ref IS NOT NULL OR checkout_id IS NOT NULL\r\n    `).all()\r\n    \r\n    for (const m of (memberships.results || [])) {\r\n      await db.prepare(`\r\n        INSERT INTO transactions (transaction_type, reference_id, user_id, email, name, order_ref, \r\n                                  checkout_id, payment_id, amount, currency, payment_status, \r\n                                  idempotency_key, consent_at, created_at)\r\n        VALUES ('membership', ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\r\n      `).bind(\r\n        m.id, m.user_id, m.email, m.name, m.order_ref, m.checkout_id, m.payment_id,\r\n        m.amount, m.currency, m.payment_status, m.idempotency_key, m.consent_at,\r\n        m.created_at || toIso(new Date())\r\n      ).run().catch(e => console.error('Failed to migrate membership', m.id, e))\r\n    }\r\n    \r\n    // Migrate tickets\r\n    const tickets = await db.prepare(`\r\n      SELECT id, user_id, order_ref, checkout_id, payment_id, amount, currency,\r\n             payment_status, idempotency_key, consent_at, created_at\r\n      FROM tickets\r\n      WHERE order_ref IS NOT NULL OR checkout_id IS NOT NULL\r\n    `).all()\r\n    \r\n    for (const t of (tickets.results || [])) {\r\n      // Get email/name from user if available\r\n      let email = null, name = null\r\n      if (t.user_id) {\r\n        const user = await db.prepare('SELECT email, name FROM users WHERE user_id = ?').bind(t.user_id).first()\r\n        email = user?.email\r\n        name = user?.name\r\n      }\r\n      \r\n      await db.prepare(`\r\n        INSERT INTO transactions (transaction_type, reference_id, user_id, email, name, order_ref,\r\n                                  checkout_id, payment_id, amount, currency, payment_status,\r\n                                  idempotency_key, consent_at, created_at)\r\n        VALUES ('ticket', ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\r\n      `).bind(\r\n        t.id, t.user_id, email, name, t.order_ref, t.checkout_id, t.payment_id,\r\n        t.amount, t.currency, t.payment_status, t.idempotency_key, t.consent_at,\r\n        t.created_at || toIso(new Date())\r\n      ).run().catch(e => console.error('Failed to migrate ticket', t.id, e))\r\n    }\r\n    \r\n    console.log(`Migrated ${memberships.results?.length || 0} memberships and ${tickets.results?.length || 0} tickets to transactions`)\r\n  } catch (e) {\r\n    console.error('Migration to transactions failed:', e)\r\n  }\r\n}\r\n\r\nasync function findIdentityByEmail(db, email){\r\n  const s = await getSchema(db)\r\n  const row = await db.prepare(`SELECT * FROM ${s.identityTable} WHERE email = ?`).bind(email).first()\r\n  if (!row) return null\r\n  if (typeof row.id === 'undefined') row.id = row[s.idColumn]\r\n  return row\r\n}\r\n\r\nasync function getOrCreateIdentity(db, email, name){\r\n  const s = await getSchema(db)\r\n  let existing = await db.prepare(`SELECT * FROM ${s.identityTable} WHERE email = ?`).bind(email).first()\r\n  if (existing){ if (typeof existing.id === 'undefined') existing.id = existing[s.idColumn]; return existing }\r\n  await db.prepare(`INSERT INTO ${s.identityTable} (email, name) VALUES (?, ?)`).bind(email, name || null).run()\r\n  existing = await db.prepare(`SELECT * FROM ${s.identityTable} WHERE email = ?`).bind(email).first()\r\n  if (existing && typeof existing.id === 'undefined') existing.id = existing[s.idColumn]\r\n  return existing\r\n}\r\n\r\nasync function getActiveMembership(db, identityId) {\r\n  const now = new Date().toISOString()\r\n  // Detect available FK columns on memberships\r\n  const mc = await db.prepare('PRAGMA table_info(memberships)').all().catch(()=>({ results: [] }))\r\n  const mnames = new Set((mc?.results||[]).map(r => String(r.name||'').toLowerCase()))\r\n  let where = '', binds = []\r\n  if (mnames.has('user_id') && mnames.has('member_id')) {\r\n    where = '(user_id = ? OR member_id = ?)'\r\n    binds = [identityId, identityId, now]\r\n  } else if (mnames.has('user_id')) {\r\n    where = 'user_id = ?'\r\n    binds = [identityId, now]\r\n  } else {\r\n    where = 'member_id = ?'\r\n    binds = [identityId, now]\r\n  }\r\n  return await db.prepare(`SELECT * FROM memberships WHERE ${where} AND status = \"active\" AND end_date >= ? ORDER BY end_date DESC LIMIT 1`).bind(...binds).first()\r\n}\r\n\r\n// Fetch pricing/details for a plan from the services table\r\nasync function getServiceForPlan(db, planCode) {\r\n  return await db.prepare('SELECT * FROM services WHERE code = ? AND active = 1 LIMIT 1').bind(planCode).first()\r\n}\r\n\r\n// Obtain SumUp OAuth token to verify payments server-side\r\nasync function sumupToken(env, scopes = 'payments') {\r\n  const body = new URLSearchParams({ grant_type: 'client_credentials', client_id: env.SUMUP_CLIENT_ID, client_secret: env.SUMUP_CLIENT_SECRET, scope: scopes })\r\n  const res = await fetch('https://api.sumup.com/token', { method: 'POST', headers: { 'Content-Type': 'application/x-www-form-urlencoded' }, body })\r\n  if (!res.ok) { const txt = await res.text().catch(()=>{}); throw new Error(`Failed to get SumUp token (${res.status}): ${txt}`) }\r\n  const json = await res.json(); \r\n  const granted = (json.scope||'').split(/\\s+/).filter(Boolean)\r\n  const required = scopes.split(/\\s+/).filter(Boolean)\r\n  const missing = required.filter(s => !granted.includes(s))\r\n  if (missing.length > 0) { throw new Error(`SumUp OAuth token missing required scopes: ${missing.join(', ')} (granted: [${granted.join(', ')}])`) }\r\n  return json\r\n}\r\n\r\n// Create or get SumUp customer for a user\r\nasync function getOrCreateSumUpCustomer(env, user) {\r\n  console.log('getOrCreateSumUpCustomer called with user:', JSON.stringify(user))\r\n  const { access_token } = await sumupToken(env, 'payments payment_instruments')\r\n  const userId = user.user_id || user.id\r\n  console.log('Resolved userId:', userId, 'from user.user_id:', user.user_id, 'or user.id:', user.id)\r\n  const customerId = `USER-${userId}`\r\n  console.log('Customer ID to use:', customerId)\r\n  \r\n  // Try to get existing customer first\r\n  const getRes = await fetch(`https://api.sumup.com/v0.1/customers/${customerId}`, {\r\n    headers: { \r\n      'Authorization': `Bearer ${access_token}`,\r\n      'Content-Type': 'application/json'\r\n    }\r\n  })\r\n  \r\n  if (getRes.ok) {\r\n    const customer = await getRes.json()\r\n    console.log('Found existing SumUp customer:', customerId)\r\n    return customer.customer_id\r\n  }\r\n  \r\n  // Customer doesn't exist, create new one\r\n  console.log('Creating new SumUp customer:', customerId)\r\n  const createRes = await fetch('https://api.sumup.com/v0.1/customers', {\r\n    method: 'POST',\r\n    headers: {\r\n      'Authorization': `Bearer ${access_token}`,\r\n      'Content-Type': 'application/json'\r\n    },\r\n    body: JSON.stringify({\r\n      customer_id: customerId,\r\n      personal_details: {\r\n        email: user.email,\r\n        first_name: user.name ? user.name.split(' ')[0] : 'Customer',\r\n        last_name: user.name ? user.name.split(' ').slice(1).join(' ') || 'Member' : 'Member'\r\n      }\r\n    })\r\n  })\r\n  \r\n  if (!createRes.ok) {\r\n    const txt = await createRes.text()\r\n    console.error('Failed to create SumUp customer:', createRes.status, txt)\r\n    throw new Error(`Failed to create SumUp customer (${createRes.status}): ${txt}`)\r\n  }\r\n  \r\n  const customer = await createRes.json()\r\n  console.log('Created SumUp customer - Full response:', JSON.stringify(customer))\r\n  console.log('Returning customer_id:', customer.customer_id)\r\n  return customer.customer_id\r\n}\r\n\r\nasync function createCheckout(env, { amount, currency, orderRef, title, description, savePaymentInstrument = false, customerId = null }) {\r\n  const { access_token } = await sumupToken(env, savePaymentInstrument ? 'payments payment_instruments' : 'payments')\r\n  const returnUrl = new URL(env.RETURN_URL)\r\n  returnUrl.searchParams.set('orderRef', orderRef)\r\n  const body = { \r\n    amount: Number(amount), \r\n    currency, \r\n    checkout_reference: orderRef, \r\n    merchant_code: env.SUMUP_MERCHANT_CODE, \r\n    description: description || title, \r\n    return_url: returnUrl.toString()\r\n  }\r\n  // Request card tokenization using SumUp's recurring payment flow\r\n  if (savePaymentInstrument && customerId) {\r\n    body.purpose = 'SETUP_RECURRING_PAYMENT'\r\n    body.customer_id = customerId\r\n  }\r\n  const res = await fetch('https://api.sumup.com/v0.1/checkouts', { method: 'POST', headers: { 'Authorization': `Bearer ${access_token}`, 'Content-Type': 'application/json' }, body: JSON.stringify(body) })\r\n  if (!res.ok) { const txt = await res.text(); throw new Error(`Create checkout failed: ${txt}`) }\r\n  const json = await res.json()\r\n  if (!json || !json.id) throw new Error('missing_checkout_id')\r\n  return json\r\n}\r\n\r\nasync function fetchPayment(env, paymentId) {\r\n  const { access_token } = await sumupToken(env, 'payments')\r\n  const res = await fetch(`https://api.sumup.com/v0.1/checkouts/${paymentId}`, { headers: { Authorization: `Bearer ${access_token}` } })\r\n  if (!res.ok) throw new Error('Failed to fetch payment')\r\n  return res.json()\r\n}\r\n\r\n// Save payment instrument from a successful payment\r\nasync function savePaymentInstrument(db, userId, checkoutId, env) {\r\n  try {\r\n    const { access_token } = await sumupToken(env, 'payments payment_instruments')\r\n    \r\n    // Get the checkout details\r\n    const checkoutRes = await fetch(`https://api.sumup.com/v0.1/checkouts/${checkoutId}`, {\r\n      headers: { Authorization: `Bearer ${access_token}` }\r\n    })\r\n    if (!checkoutRes.ok) {\r\n      console.error('Failed to fetch checkout:', checkoutRes.status, await checkoutRes.text())\r\n      return null\r\n    }\r\n    const checkout = await checkoutRes.json()\r\n    console.log('Checkout response for tokenization:', JSON.stringify(checkout))\r\n    \r\n    // With purpose=SETUP_RECURRING_PAYMENT, the payment_instrument should be in the response\r\n    if (checkout.payment_instrument) {\r\n      const instrument = checkout.payment_instrument\r\n      console.log('Found payment_instrument:', JSON.stringify(instrument))\r\n      \r\n      const now = toIso(new Date())\r\n      const instrumentId = instrument.token || instrument.id\r\n      \r\n      if (!instrumentId) {\r\n        console.error('Payment instrument missing token/id')\r\n        return null\r\n      }\r\n      \r\n      // Deactivate old instruments\r\n      await db.prepare('UPDATE payment_instruments SET is_active = 0 WHERE user_id = ?').bind(userId).run()\r\n      \r\n      // Save new instrument\r\n      await db.prepare(`\r\n        INSERT INTO payment_instruments (user_id, instrument_id, card_type, last_4, expiry_month, expiry_year, created_at, updated_at, is_active)\r\n        VALUES (?, ?, ?, ?, ?, ?, ?, ?, 1)\r\n        ON CONFLICT(user_id, instrument_id) DO UPDATE SET is_active = 1, updated_at = ?\r\n      `).bind(\r\n        userId,\r\n        instrumentId,\r\n        instrument.type || instrument.card_type || null,\r\n        instrument.last_4_digits || instrument.last_4 || null,\r\n        instrument.expiry_month || null,\r\n        instrument.expiry_year || null,\r\n        now,\r\n        now,\r\n        now\r\n      ).run()\r\n      \r\n      console.log('Successfully saved payment instrument:', instrumentId)\r\n      return instrumentId\r\n    }\r\n    \r\n    console.warn('No payment_instrument found in checkout response')\r\n    console.warn('Ensure purpose=SETUP_RECURRING_PAYMENT and customer_id were set in checkout creation')\r\n    return null\r\n  } catch (e) {\r\n    console.error('Failed to save payment instrument:', e)\r\n    return null\r\n  }\r\n}\r\n\r\n// Charge a saved payment instrument\r\nasync function chargePaymentInstrument(env, userId, instrumentId, amount, currency, orderRef, description) {\r\n  try {\r\n    const { access_token } = await sumupToken(env, 'payments payment_instruments')\r\n    \r\n    // Verify customer exists in SumUp Customer API\r\n    const customerId = `USER-${userId}`\r\n    const customerCheckRes = await fetch(`https://api.sumup.com/v0.1/customers/${customerId}`, {\r\n      headers: {\r\n        'Authorization': `Bearer ${access_token}`,\r\n        'Content-Type': 'application/json'\r\n      }\r\n    })\r\n    \r\n    if (!customerCheckRes.ok) {\r\n      console.error(`Customer ${customerId} not found in SumUp Customer API`)\r\n      throw new Error(`Customer ${customerId} does not exist. Cannot process recurring payment.`)\r\n    }\r\n    \r\n    // Create checkout\r\n    const checkoutBody = {\r\n      amount: Number(amount),\r\n      currency,\r\n      checkout_reference: orderRef,\r\n      merchant_code: env.SUMUP_MERCHANT_CODE,\r\n      description\r\n    }\r\n    \r\n    const checkoutRes = await fetch('https://api.sumup.com/v0.1/checkouts', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Authorization': `Bearer ${access_token}`,\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify(checkoutBody)\r\n    })\r\n    \r\n    if (!checkoutRes.ok) {\r\n      const txt = await checkoutRes.text()\r\n      throw new Error(`Checkout creation failed: ${txt}`)\r\n    }\r\n    \r\n    const checkout = await checkoutRes.json()\r\n    console.log('Created checkout for renewal:', checkout.id)\r\n    \r\n    // Process payment with the saved token\r\n    // Per SumUp documentation: Both token and customer_id fields are required for recurring payments\r\n    // The customer_id must match the customer that was used during SETUP_RECURRING_PAYMENT\r\n    const paymentBody = {\r\n      payment_type: 'card',\r\n      token: instrumentId,\r\n      customer_id: customerId\r\n    }\r\n    \r\n    const paymentRes = await fetch(`https://api.sumup.com/v0.1/checkouts/${checkout.id}`, {\r\n      method: 'PUT',\r\n      headers: {\r\n        'Authorization': `Bearer ${access_token}`,\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify(paymentBody)\r\n    })\r\n    \r\n    if (!paymentRes.ok) {\r\n      const txt = await paymentRes.text()\r\n      throw new Error(`Payment processing failed: ${txt}`)\r\n    }\r\n    \r\n    const payment = await paymentRes.json()\r\n    console.log('Processed recurring payment:', payment.id, payment.status)\r\n    return payment\r\n  } catch (e) {\r\n    console.error('Charge payment instrument error:', e)\r\n    throw e\r\n  }\r\n}\r\n\r\n// Get active payment instrument for user\r\nasync function getActivePaymentInstrument(db, userId) {\r\n  return await db.prepare('SELECT * FROM payment_instruments WHERE user_id = ? AND is_active = 1 ORDER BY created_at DESC LIMIT 1')\r\n    .bind(userId).first()\r\n}\r\n\r\n// Process renewal for a single membership\r\nasync function processMembershipRenewal(db, membership, env) {\r\n  const s = await getSchema(db)\r\n  const userId = (typeof membership.user_id !== 'undefined' && membership.user_id !== null) ? membership.user_id : membership.member_id\r\n  \r\n  // Get payment instrument\r\n  const instrument = await getActivePaymentInstrument(db, userId)\r\n  if (!instrument) {\r\n    await db.prepare('UPDATE memberships SET renewal_failed_at = ?, renewal_attempts = renewal_attempts + 1 WHERE id = ?')\r\n      .bind(toIso(new Date()), membership.id).run()\r\n    await db.prepare('INSERT INTO renewal_log (membership_id, attempt_date, status, error_message) VALUES (?, ?, ?, ?)')\r\n      .bind(membership.id, toIso(new Date()), 'failed', 'No active payment instrument').run()\r\n    return { success: false, error: 'no_instrument' }\r\n  }\r\n  \r\n  // Get service details\r\n  const svc = await getServiceForPlan(db, membership.plan)\r\n  if (!svc) {\r\n    return { success: false, error: 'plan_not_found' }\r\n  }\r\n  \r\n  const amount = Number(svc.amount)\r\n  const currency = svc.currency || env.CURRENCY || 'GBP'\r\n  const orderRef = `RENEWAL-${membership.id}-${crypto.randomUUID()}`\r\n  \r\n  try {\r\n    // Charge the payment instrument\r\n    const payment = await chargePaymentInstrument(\r\n      env,\r\n      userId,\r\n      instrument.instrument_id,\r\n      amount,\r\n      currency,\r\n      orderRef,\r\n      `Renewal: Dice Bastion ${membership.plan} membership`\r\n    )\r\n    \r\n    // If successful, extend membership\r\n    if (payment && (payment.status === 'PAID' || payment.status === 'SUCCESSFUL')) {\r\n      const months = Number(svc.months || 0)\r\n      const currentEnd = new Date(membership.end_date)\r\n      const newEnd = addMonths(currentEnd, months)\r\n      \r\n      // Update membership\r\n      await db.prepare(`\r\n        UPDATE memberships \r\n        SET end_date = ?, \r\n            renewal_failed_at = NULL, \r\n            renewal_attempts = 0\r\n        WHERE id = ?\r\n      `).bind(toIso(newEnd), membership.id).run()\r\n      \r\n      // Create transaction record for renewal\r\n      const user = await db.prepare('SELECT email, name FROM users WHERE user_id = ?').bind(userId).first()\r\n      await db.prepare(`\r\n        INSERT INTO transactions (transaction_type, reference_id, user_id, email, name, order_ref,\r\n                                  payment_id, amount, currency, payment_status)\r\n        VALUES ('renewal', ?, ?, ?, ?, ?, ?, ?, ?, 'PAID')\r\n      `).bind(membership.id, userId, user?.email, user?.name, orderRef, payment.id, String(amount), currency).run()\r\n      \r\n      // Log renewal attempt\r\n      await db.prepare('INSERT INTO renewal_log (membership_id, attempt_date, status, payment_id, amount, currency) VALUES (?, ?, ?, ?, ?, ?)')\r\n        .bind(membership.id, toIso(new Date()), 'success', payment.id, String(amount), currency).run()\r\n      \r\n      return { success: true, newEndDate: toIso(newEnd), paymentId: payment.id }\r\n    } else {\r\n      throw new Error(`Payment not successful: ${payment?.status || 'UNKNOWN'}`)\r\n    }\r\n  } catch (e) {\r\n    await db.prepare('UPDATE memberships SET renewal_failed_at = ?, renewal_attempts = renewal_attempts + 1 WHERE id = ?')\r\n      .bind(toIso(new Date()), membership.id).run()\r\n    await db.prepare('INSERT INTO renewal_log (membership_id, attempt_date, status, error_message, amount, currency) VALUES (?, ?, ?, ?, ?, ?)')\r\n      .bind(membership.id, toIso(new Date()), 'failed', String(e.message || e), String(amount), currency).run()\r\n    \r\n    return { success: false, error: String(e.message || e) }\r\n  }\r\n}\r\n\r\n// Turnstile verification with optional debug logging\r\nasync function verifyTurnstile(env, token, ip, debug){\r\n  if (!env.TURNSTILE_SECRET) { if (debug) console.log('turnstile: secret missing -> bypass'); return true }\r\n  if (!token) { if (debug) console.log('turnstile: missing token'); return false }\r\n  const form = new URLSearchParams(); form.set('secret', env.TURNSTILE_SECRET); form.set('response', token); if (ip) form.set('remoteip', ip)\r\n  let res, j = {};\r\n  try {\r\n    res = await fetch('https://challenges.cloudflare.com/turnstile/v0/siteverify', { method:'POST', body: form })\r\n    j = await res.json().catch(()=>({}))\r\n  } catch (e) {\r\n    if (debug) console.log('turnstile: siteverify fetch error', String(e))\r\n    return false\r\n  }\r\n  if (debug) console.log('turnstile: siteverify', { status: res?.status, success: j?.['success'], errors: j?.['error-codes'], hostname: j?.hostname })\r\n  return !!j.success\r\n}\r\n\r\nconst EMAIL_RE = /^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$/\r\nconst UUID_RE = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i\r\nconst EVT_UUID_RE = /^EVT-\\d+-[0-9a-f\\-]{36}$/i\r\n\r\nfunction clampStr(v, max){ return (v||'').substring(0, max) }\r\n\r\n// MailerSend email helper\r\nasync function sendEmail(env, { to, subject, html, text }) {\r\n  if (!env.MAILERSEND_API_KEY) {\r\n    console.warn('MAILERSEND_API_KEY not configured, skipping email')\r\n    return { skipped: true }\r\n  }\r\n  \r\n  try {\r\n    const body = {\r\n      from: { email: env.MAILERSEND_FROM_EMAIL || 'noreply@dicebastion.com', name: env.MAILERSEND_FROM_NAME || 'Dice Bastion' },\r\n      to: [{ email: to }],\r\n      subject,\r\n      html,\r\n      text: text || html.replace(/<[^>]*>/g, '')\r\n    }\r\n    \r\n    const res = await fetch('https://api.mailersend.com/v1/email', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Authorization': `Bearer ${env.MAILERSEND_API_KEY}`,\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify(body)\r\n    })\r\n    \r\n    if (!res.ok) {\r\n      const txt = await res.text()\r\n      console.error('MailerSend error:', txt)\r\n      return { success: false, error: txt }\r\n    }\r\n    \r\n    return { success: true }\r\n  } catch (e) {\r\n    console.error('Email send error:', e)\r\n    return { success: false, error: String(e) }\r\n  }\r\n}\r\n\r\n// Generate email templates\r\nfunction getRenewalSuccessEmail(membership, user, newEndDate) {\r\n  const planNames = { monthly: 'Monthly', quarterly: 'Quarterly', annual: 'Annual' }\r\n  const planName = planNames[membership.plan] || membership.plan\r\n  \r\n  return {\r\n    subject: `Your Dice Bastion ${planName} Membership Has Been Renewed`,\r\n    html: `\r\n      <h2>Membership Renewed Successfully</h2>\r\n      <p>Hi ${user.name || 'there'},</p>\r\n      <p>Great news! Your <strong>${planName} Membership</strong> has been automatically renewed.</p>\r\n      <ul>\r\n        <li><strong>Plan:</strong> ${planName}</li>\r\n        <li><strong>Amount:</strong> \u00A3${membership.amount}</li>\r\n        <li><strong>New End Date:</strong> ${new Date(newEndDate).toLocaleDateString('en-GB', { year: 'numeric', month: 'long', day: 'numeric' })}</li>\r\n      </ul>\r\n      <p>Your membership will continue uninterrupted. If you wish to cancel auto-renewal, you can do so from your <a href=\"https://dicebastion.com/account\">account page</a>.</p>\r\n      <p>Thank you for being a valued member!</p>\r\n      <p>\u2014 The Dice Bastion Team</p>\r\n    `\r\n  }\r\n}\r\n\r\nfunction getRenewalFailedEmail(membership, user) {\r\n  const planNames = { monthly: 'Monthly', quarterly: 'Quarterly', annual: 'Annual' }\r\n  const planName = planNames[membership.plan] || membership.plan\r\n  \r\n  return {\r\n    subject: `Action Required: Dice Bastion Membership Renewal Failed`,\r\n    html: `\r\n      <h2>Membership Renewal Failed</h2>\r\n      <p>Hi ${user.name || 'there'},</p>\r\n      <p>We were unable to automatically renew your <strong>${planName} Membership</strong>.</p>\r\n      <p>Your membership will expire on <strong>${new Date(membership.end_date).toLocaleDateString('en-GB', { year: 'numeric', month: 'long', day: 'numeric' })}</strong>.</p>\r\n      <p><strong>What to do next:</strong></p>\r\n      <ul>\r\n        <li>Update your payment method at <a href=\"https://dicebastion.com/account\">dicebastion.com/account</a></li>\r\n        <li>Or purchase a new membership at <a href=\"https://dicebastion.com/memberships\">dicebastion.com/memberships</a></li>\r\n      </ul>\r\n      <p>If you have any questions, please don't hesitate to contact us.</p>\r\n      <p>\u2014 The Dice Bastion Team</p>\r\n    `\r\n  }\r\n}\r\n\r\nfunction getTicketConfirmationEmail(event, user, transaction) {\r\n  const eventDate = new Date(event.event_date).toLocaleDateString('en-GB', { \r\n    weekday: 'long', \r\n    year: 'numeric', \r\n    month: 'long', \r\n    day: 'numeric' \r\n  })\r\n  const eventTime = event.event_time || 'TBC'\r\n  const amount = transaction.amount || '0.00'\r\n  const currency = transaction.currency || 'GBP'\r\n  const sym = currency === 'GBP' ? '\u00A3' : currency === 'EUR' ? '\u20AC' : '$'\r\n  \r\n  return {\r\n    subject: `Ticket Confirmed: ${event.event_name}`,\r\n    html: `\r\n      <h2>Your Ticket is Confirmed!</h2>\r\n      <p>Hi ${user.name || 'there'},</p>\r\n      <p>Thank you for purchasing a ticket to <strong>${event.event_name}</strong>!</p>\r\n      \r\n      <h3>Event Details:</h3>\r\n      <ul>\r\n        <li><strong>Event:</strong> ${event.event_name}</li>\r\n        <li><strong>Date:</strong> ${eventDate}</li>\r\n        <li><strong>Time:</strong> ${eventTime}</li>\r\n        <li><strong>Location:</strong> ${event.location || 'Dice Bastion'}</li>\r\n        ${event.description ? `<li><strong>Description:</strong> ${event.description}</li>` : ''}\r\n      </ul>\r\n      \r\n      <h3>Payment Details:</h3>\r\n      <ul>\r\n        <li><strong>Amount Paid:</strong> ${sym}${amount}</li>\r\n        <li><strong>Order Reference:</strong> ${transaction.order_ref}</li>\r\n      </ul>\r\n      \r\n      <p>Please bring this email or show your order reference at the event check-in.</p>\r\n      \r\n      ${event.additional_info ? `<p><strong>Important Information:</strong><br>${event.additional_info}</p>` : ''}\r\n      \r\n      <p>Looking forward to seeing you there!</p>\r\n      <p>\u2014 The Dice Bastion Team</p>\r\n    `,\r\n    text: `\r\nYour Ticket is Confirmed!\r\n\r\nHi ${user.name || 'there'},\r\n\r\nThank you for purchasing a ticket to ${event.event_name}!\r\n\r\nEVENT DETAILS:\r\n- Event: ${event.event_name}\r\n- Date: ${eventDate}\r\n- Time: ${eventTime}\r\n- Location: ${event.location || 'Dice Bastion'}\r\n${event.description ? `- Description: ${event.description}` : ''}\r\n\r\nPAYMENT DETAILS:\r\n- Amount Paid: ${sym}${amount}\r\n- Order Reference: ${transaction.order_ref}\r\n\r\nPlease bring this email or show your order reference at the event check-in.\r\n\r\n${event.additional_info ? `Important Information: ${event.additional_info}` : ''}\r\n\r\nLooking forward to seeing you there!\r\n\r\n\u2014 The Dice Bastion Team\r\n    `\r\n  }\r\n}\r\n\r\nfunction getWelcomeEmail(membership, user, autoRenew) {\r\n  const planNames = { monthly: 'Monthly', quarterly: 'Quarterly', annual: 'Annual' }\r\n  const planName = planNames[membership.plan] || membership.plan\r\n  \r\n  return {\r\n    subject: `Welcome to Dice Bastion ${planName} Membership!`,\r\n    html: `\r\n      <h2>Welcome to Dice Bastion!</h2>\r\n      <p>Hi ${user.name || 'there'},</p>\r\n      <p>Thank you for becoming a <strong>${planName} Member</strong>!</p>\r\n      <ul>\r\n        <li><strong>Plan:</strong> ${planName}</li>\r\n        <li><strong>Valid Until:</strong> ${new Date(membership.end_date).toLocaleDateString('en-GB', { year: 'numeric', month: 'long', day: 'numeric' })}</li>\r\n        <li><strong>Auto-Renewal:</strong> ${autoRenew ? 'Enabled \u2713' : 'Disabled'}</li>\r\n      </ul>\r\n      ${autoRenew ? '<p>Your membership will automatically renew before expiration. You can manage this at any time from your <a href=\"https://dicebastion.com/account\">account page</a>.</p>' : '<p>Remember to renew your membership before it expires to continue enjoying member benefits!</p>'}\r\n      <p><strong>Member Benefits:</strong></p>\r\n      <ul>\r\n        <li>Discounted event tickets</li>\r\n        <li>Priority booking for tournaments</li>\r\n        <li>Exclusive member events</li>\r\n        <li>And much more!</li>\r\n      </ul>\r\n      <p>See you at the club!</p>\r\n      <p>\u2014 The Dice Bastion Team</p>\r\n    `\r\n  }\r\n}\r\n\r\n// Membership checkout with idempotency + Turnstile\r\napp.post('/membership/checkout', async (c) => {\r\n  try {\r\n    const ip = c.req.header('CF-Connecting-IP')\r\n    const debugMode = ['1','true','yes'].includes(String(c.req.query('debug') || c.env.DEBUG || '').toLowerCase())\r\n    const idem = c.req.header('Idempotency-Key')?.trim()\r\n    const { email, name, plan, privacyConsent, turnstileToken, autoRenew } = await c.req.json()\r\n    if (!email || !plan) return c.json({ error: 'missing_fields' }, 400)\r\n    if (!EMAIL_RE.test(email) || email.length > 320) return c.json({ error:'invalid_email' },400)\r\n    if (!privacyConsent) return c.json({ error: 'privacy_consent_required' }, 400)\r\n    if (name && name.length > 200) return c.json({ error:'name_too_long' },400)\r\n    const tsOk = await verifyTurnstile(c.env, turnstileToken, ip, debugMode)\r\n    if (!tsOk) return c.json({ error:'turnstile_failed' },403)\r\n\r\n    const ident = await getOrCreateIdentity(c.env.DB, email, clampStr(name,200))\r\n    const svc = await getServiceForPlan(c.env.DB, plan)\r\n    if (!svc) return c.json({ error: 'unknown_plan' }, 400)\r\n    const amount = Number(svc.amount)\r\n    if (!Number.isFinite(amount) || amount <= 0) return c.json({ error:'invalid_amount' },400)\r\n    const currency = svc.currency || c.env.CURRENCY || 'GBP'\r\n    const s = await getSchema(c.env.DB)\r\n\r\n    // Ensure schema is up to date\r\n    await ensureSchema(c.env.DB, s.fkColumn)\r\n    await migrateToTransactions(c.env.DB)\r\n\r\n    // Idempotency check in transactions table\r\n    const order_ref = crypto.randomUUID()\r\n    if (idem){\r\n      const existing = await c.env.DB.prepare(`\r\n        SELECT t.*, m.id as membership_id FROM transactions t\r\n        JOIN memberships m ON m.id = t.reference_id\r\n        WHERE t.transaction_type = 'membership' AND t.user_id = ? AND t.idempotency_key = ?\r\n        ORDER BY t.id DESC LIMIT 1\r\n      `).bind(ident.id, idem).first()\r\n      if (existing && existing.checkout_id){\r\n        return c.json({ orderRef: existing.order_ref, checkoutId: existing.checkout_id, reused: true })\r\n      }\r\n    }\r\n\r\n    const autoRenewValue = autoRenew ? 1 : 0\r\n    \r\n    // Insert minimal membership record (business logic only)\r\n    const mc = await c.env.DB.prepare('PRAGMA table_info(memberships)').all().catch(()=>({ results: [] }))\r\n    const mnames = new Set((mc?.results||[]).map(r => String(r.name||'').toLowerCase()))\r\n    const cols = ['plan','status','auto_renew']\r\n    const vals = [plan,'pending', autoRenewValue]\r\n    if (mnames.has('user_id')) { cols.unshift('user_id'); vals.unshift(ident.id) }\r\n    if (mnames.has('member_id')) { cols.unshift('member_id'); vals.unshift(ident.id) }\r\n    const placeholders = cols.map(()=>'?').join(',')\r\n    const mResult = await c.env.DB.prepare(`INSERT INTO memberships (${cols.join(',')}) VALUES (${placeholders}) RETURNING id`).bind(...vals).first()\r\n    const membershipId = mResult?.id || (await c.env.DB.prepare('SELECT last_insert_rowid() as id').first()).id\r\n\r\n    let checkout\r\n    try {\r\n      // Create or get SumUp customer if auto-renewal enabled\r\n      let customerId = null\r\n      if (autoRenewValue === 1) {\r\n        customerId = await getOrCreateSumUpCustomer(c.env, ident)\r\n        console.log('Using SumUp customer ID for auto-renewal:', customerId)\r\n      }\r\n      \r\n      checkout = await createCheckout(c.env, { \r\n        amount, \r\n        currency, \r\n        orderRef: order_ref, \r\n        title: `Dice Bastion ${plan} membership`, \r\n        description: `Membership for ${plan}`,\r\n        savePaymentInstrument: autoRenewValue === 1,\r\n        customerId\r\n      })\r\n    } catch (err) {\r\n      console.error('sumup checkout error', err)\r\n      return c.json({ error: 'sumup_checkout_failed', message: String(err?.message || err) }, 502)\r\n    }\r\n    if (!checkout.id) {\r\n      console.error('membership checkout missing id', checkout)\r\n      return c.json({ error: 'sumup_missing_id' }, 502)\r\n    }\r\n    \r\n    // Store payment details in transactions table\r\n    await c.env.DB.prepare(`\r\n      INSERT INTO transactions (transaction_type, reference_id, user_id, email, name, order_ref, \r\n                                checkout_id, amount, currency, payment_status, idempotency_key, consent_at)\r\n      VALUES ('membership', ?, ?, ?, ?, ?, ?, ?, ?, 'pending', ?, ?)\r\n    `).bind(membershipId, ident.id, email, clampStr(name,200), order_ref, checkout.id, \r\n            String(amount), currency, idem || null, toIso(new Date())).run()\r\n    \r\n    return c.json({ orderRef: order_ref, checkoutId: checkout.id })\r\n  } catch (e) {\r\n    const debugMode = ['1','true','yes'].includes(String(c.req.query('debug') || c.env.DEBUG || '').toLowerCase())\r\n    console.error('membership checkout error', e)\r\n    return c.json(debugMode ? { error: 'internal_error', detail: String(e), stack: String(e?.stack||'') } : { error: 'internal_error' }, 500)\r\n  }\r\n})\r\n\r\napp.get('/membership/status', async (c) => {\r\n  const email = c.req.query('email')\r\n  if (!email) return c.json({ error: 'email required' }, 400)\r\n  const ident = await findIdentityByEmail(c.env.DB, email)\r\n  if (!ident) return c.json({ active: false })\r\n  const active = await getActiveMembership(c.env.DB, ident.id)\r\n  if (!active) return c.json({ active: false })\r\n  return c.json({ active: true, plan: active.plan, endDate: active.end_date })\r\n})\r\n\r\n// Expose active plans/prices for frontend labeling\r\napp.get('/membership/plans', async (c) => {\r\n  const rows = await c.env.DB.prepare('SELECT code, name, description, amount, currency, months FROM services WHERE active = 1 ORDER BY id').all()\r\n  return c.json({ plans: rows.results || [] })\r\n})\r\n\r\napp.get('/membership/confirm', async (c) => {\r\n  const orderRef = c.req.query('orderRef')\r\n  if (!orderRef || !UUID_RE.test(orderRef)) return c.json({ ok:false, error:'invalid_orderRef' },400)\r\n  \r\n  // Get transaction record\r\n  const transaction = await c.env.DB.prepare('SELECT * FROM transactions WHERE order_ref = ? AND transaction_type = \"membership\"').bind(orderRef).first()\r\n  if (!transaction) return c.json({ ok:false, error:'order_not_found' },404)\r\n  \r\n  // Get membership record\r\n  const pending = await c.env.DB.prepare('SELECT * FROM memberships WHERE id = ?').bind(transaction.reference_id).first()\r\n  if (!pending) return c.json({ ok:false, error:'membership_not_found' },404)\r\n  if (pending.status === 'active') {\r\n    // Get card details if auto-renewal is enabled\r\n    let cardLast4 = null\r\n    if (pending.auto_renew === 1 && pending.payment_instrument_id) {\r\n      const instrument = await c.env.DB.prepare('SELECT last_4 FROM payment_instruments WHERE instrument_id = ?')\r\n        .bind(pending.payment_instrument_id).first()\r\n      cardLast4 = instrument?.last_4 || null\r\n    }\r\n    return c.json({ \r\n      ok: true, \r\n      status: 'already_active',\r\n      plan: pending.plan,\r\n      endDate: pending.end_date,\r\n      amount: transaction.amount,\r\n      currency: transaction.currency || 'GBP',\r\n      autoRenew: pending.auto_renew === 1,\r\n      cardLast4\r\n    })\r\n  }\r\n  \r\n  // Verify payment with SumUp\r\n  let payment; \r\n  try { payment = await fetchPayment(c.env, transaction.checkout_id) } \r\n  catch { return c.json({ ok:false, error:'verify_failed' },400) }\r\n  \r\n  const paid = payment && (payment.status === 'PAID' || payment.status === 'SUCCESSFUL')\r\n  if (!paid) return c.json({ ok:false, status: payment?.status || 'PENDING' })\r\n  \r\n  // Verify amount/currency\r\n  if (payment.amount != Number(transaction.amount) || (transaction.currency && payment.currency !== transaction.currency)) {\r\n    return c.json({ ok:false, error:'payment_mismatch' },400)\r\n  }\r\n  \r\n  const s = await getSchema(c.env.DB)\r\n  const identityId = (typeof pending.user_id !== 'undefined' && pending.user_id !== null) ? pending.user_id : pending.member_id\r\n  const activeExisting = await getActiveMembership(c.env.DB, identityId)\r\n  const svc = await getServiceForPlan(c.env.DB, pending.plan)\r\n  if (!svc) return c.json({ ok:false, error:'plan_not_configured' },400)\r\n  const months = Number(svc.months || 0)\r\n  const baseStart = activeExisting ? new Date(activeExisting.end_date) : new Date()\r\n  const end = addMonths(baseStart, months)\r\n  \r\n  // Save payment instrument for auto-renewal ONLY if auto_renew is enabled\r\n  let instrumentId = null\r\n  if (pending.auto_renew === 1) {\r\n    instrumentId = await savePaymentInstrument(c.env.DB, identityId, transaction.checkout_id, c.env)\r\n  }\r\n  \r\n  // Update membership status\r\n  await c.env.DB.prepare(`\r\n    UPDATE memberships \r\n    SET status = \"active\", \r\n        start_date = ?, \r\n        end_date = ?, \r\n        payment_instrument_id = ?\r\n    WHERE id = ?\r\n  `).bind(toIso(baseStart), toIso(end), instrumentId, pending.id).run()\r\n  \r\n  // Update transaction status\r\n  await c.env.DB.prepare(`\r\n    UPDATE transactions \r\n    SET payment_status = \"PAID\",\r\n        payment_id = ?,\r\n        updated_at = ?\r\n    WHERE id = ?\r\n  `).bind(payment.id, toIso(new Date()), transaction.id).run()\r\n  \r\n  // Get user details and send welcome email\r\n  const user = await c.env.DB.prepare('SELECT * FROM users WHERE user_id = ?').bind(identityId).first()\r\n  if (user) {\r\n    const updatedMembership = { ...pending, end_date: toIso(end) }\r\n    const emailContent = getWelcomeEmail(updatedMembership, user, pending.auto_renew === 1)\r\n    await sendEmail(c.env, { to: user.email, ...emailContent })\r\n  }\r\n  \r\n  // Get payment instrument details for display\r\n  let cardLast4 = null\r\n  if (instrumentId) {\r\n    const instrument = await c.env.DB.prepare('SELECT last_4 FROM payment_instruments WHERE instrument_id = ? AND user_id = ?')\r\n      .bind(instrumentId, identityId).first()\r\n    cardLast4 = instrument?.last_4 || null\r\n  }\r\n  \r\n  return c.json({ \r\n    ok: true, \r\n    status: 'active',\r\n    plan: pending.plan,\r\n    endDate: toIso(end),\r\n    amount: transaction.amount,\r\n    currency: transaction.currency || 'GBP',\r\n    autoRenew: pending.auto_renew === 1,\r\n    cardLast4\r\n  })\r\n})\r\n\r\napp.post('/webhooks/sumup', async (c) => {\r\n  const payload = await c.req.json()\r\n  const { id: paymentId, checkout_reference: orderRef, currency } = payload\r\n  if (!paymentId || !orderRef) return c.json({ ok: false }, 400)\r\n\r\n  let payment\r\n  try { payment = await fetchPayment(c.env, paymentId) } catch (e) { return c.json({ ok: false, error: 'verify_failed' }, 400) }\r\n  if (!payment || payment.status !== 'PAID') return c.json({ ok: true })\r\n\r\n  const pending = await c.env.DB.prepare('SELECT * FROM memberships WHERE order_ref = ?').bind(orderRef).first()\r\n  if (!pending) return c.json({ ok: false, error: 'order_not_found' }, 404)\r\n\r\n  const svc = await getServiceForPlan(c.env.DB, pending.plan)\r\n  if (!svc) return c.json({ ok: false, error: 'plan_not_configured' }, 400)\r\n  if (currency && svc.currency && currency !== svc.currency) return c.json({ ok: false, error: 'currency_mismatch' }, 400)\r\n\r\n  const now = new Date()\r\n  const s = await getSchema(c.env.DB)\r\n  const identityId = (typeof pending.user_id !== 'undefined' && pending.user_id !== null) ? pending.user_id : pending.member_id\r\n  const memberActive = await getActiveMembership(c.env.DB, identityId)\r\n  const baseStart = memberActive ? new Date(memberActive.end_date) : now\r\n  const months = Number(svc.months || 0)\r\n  const start = baseStart\r\n  const end = addMonths(baseStart, months)\r\n\r\n  await c.env.DB.prepare('UPDATE memberships SET status = \"active\", start_date = ?, end_date = ?, payment_id = ? WHERE id = ?').bind(toIso(start), toIso(end), paymentId, pending.id).run()\r\n  \r\n  // Send welcome email (critical - works even if user closed browser)\r\n  const user = await c.env.DB.prepare('SELECT * FROM users WHERE user_id = ?').bind(identityId).first()\r\n  if (user) {\r\n    const updatedMembership = { ...pending, end_date: toIso(end) }\r\n    const emailContent = getWelcomeEmail(updatedMembership, user, pending.auto_renew === 1)\r\n    await sendEmail(c.env, { to: user.email, ...emailContent }).catch(err => {\r\n      console.error('Webhook email failed:', err)\r\n      // Don't fail webhook if email fails\r\n    })\r\n  }\r\n  \r\n  return c.json({ ok: true })\r\n})\r\n\r\n// Get event basic info\r\napp.get('/events/:id', async c => {\r\n  const id = c.req.param('id')\r\n  if (!id || isNaN(Number(id))) return c.json({ error:'invalid_event_id' },400)\r\n  const ev = await c.env.DB.prepare('SELECT event_id,event_name,description,event_datetime,location,membership_price,non_membership_price,capacity,tickets_sold,category,image_url FROM events WHERE event_id = ?').bind(Number(id)).first()\r\n  if (!ev) return c.json({ error:'not_found' },404)\r\n  return c.json({ event: ev })\r\n})\r\n\r\n// Create ticket checkout with idempotency + Turnstile\r\napp.post('/events/:id/checkout', async c => {\r\n  try {\r\n    const id = c.req.param('id')\r\n    if (!id || isNaN(Number(id))) return c.json({ error:'invalid_event_id' },400)\r\n    const evId = Number(id)\r\n    const ip = c.req.header('CF-Connecting-IP')\r\n    const debugMode = ['1','true','yes'].includes(String(c.req.query('debug') || c.env.DEBUG || '').toLowerCase())\r\n    const idem = c.req.header('Idempotency-Key')?.trim()\r\n    const { email, name, privacyConsent, turnstileToken } = await c.req.json()\r\n    if (!email) return c.json({ error:'email_required' },400)\r\n    if (!EMAIL_RE.test(email)) return c.json({ error:'invalid_email' },400)\r\n    if (!privacyConsent) return c.json({ error:'privacy_consent_required' },400)\r\n    if (name && name.length > 200) return c.json({ error:'name_too_long' },400)\r\n    const tsOk = await verifyTurnstile(c.env, turnstileToken, ip, debugMode)\r\n    if (!tsOk) return c.json({ error:'turnstile_failed' },403)\r\n\r\n    const ev = await c.env.DB.prepare('SELECT * FROM events WHERE event_id = ?').bind(evId).first()\r\n    if (!ev) return c.json({ error:'event_not_found' },404)\r\n    if (ev.capacity && ev.tickets_sold >= ev.capacity) return c.json({ error:'sold_out' },409)\r\n\r\n    const ident = await getOrCreateIdentity(c.env.DB, email, clampStr(name,200))\r\n    if (!ident || typeof ident.id === 'undefined' || ident.id === null) {\r\n      console.error('identity missing id', ident)\r\n      return c.json({ error:'identity_error' },500)\r\n    }\r\n    const isActive = !!(await getActiveMembership(c.env.DB, ident.id))\r\n    const amount = Number(isActive ? ev.membership_price : ev.non_membership_price)\r\n    if (!Number.isFinite(amount) || amount <= 0) return c.json({ error:'invalid_amount' },400)\r\n    const currency = c.env.CURRENCY || 'GBP'\r\n\r\n    const s = await getSchema(c.env.DB)\r\n    await ensureSchema(c.env.DB, s.fkColumn)\r\n    await migrateToTransactions(c.env.DB)\r\n\r\n    const order_ref = `EVT-${evId}-${crypto.randomUUID()}`\r\n    \r\n    // Idempotency check in transactions table\r\n    if (idem){\r\n      const existing = await c.env.DB.prepare(`\r\n        SELECT t.*, ti.id as ticket_id FROM transactions t\r\n        JOIN tickets ti ON ti.id = t.reference_id\r\n        WHERE t.transaction_type = 'ticket' AND t.user_id = ? AND t.idempotency_key = ?\r\n        ORDER BY t.id DESC LIMIT 1\r\n      `).bind(ident.id, idem).first()\r\n      if (existing && existing.checkout_id){\r\n        return c.json({ orderRef: existing.order_ref, checkoutId: existing.checkout_id, reused: true })\r\n      }\r\n    }\r\n\r\n    // Insert minimal ticket record (business logic only)\r\n    const tinfo = await c.env.DB.prepare('PRAGMA table_info(tickets)').all().catch(()=>({ results: [] }))\r\n    const tnames = new Set((tinfo?.results||[]).map(r => String(r.name||'').toLowerCase()))\r\n    const hasUser = tnames.has('user_id')\r\n    const hasMember = tnames.has('member_id')\r\n    \r\n    const colParts = ['event_id', 'status']\r\n    const bindVals = [evId, 'pending']\r\n    if (hasUser) { colParts.push('user_id'); bindVals.push(ident.id) }\r\n    if (hasMember) { colParts.push('member_id'); bindVals.push(ident.id) }\r\n    if (tnames.has('created_at')) { colParts.push('created_at'); bindVals.push(toIso(new Date())) }\r\n    \r\n    const placeholders = colParts.map(()=>'?').join(',')\r\n    const ticketResult = await c.env.DB.prepare(`INSERT INTO tickets (${colParts.join(',')}) VALUES (${placeholders}) RETURNING id`).bind(...bindVals).first()\r\n    const ticketId = ticketResult?.id || (await c.env.DB.prepare('SELECT last_insert_rowid() as id').first()).id\r\n\r\n    let checkout\r\n    try {\r\n      checkout = await createCheckout(c.env, { amount, currency, orderRef: order_ref, title: ev.event_name, description: `Ticket for ${ev.event_name}` })\r\n    } catch (e) {\r\n      console.error('SumUp checkout failed for event', evId, e)\r\n      return c.json({ error:'sumup_checkout_failed', message:String(e?.message||e) },502)\r\n    }\r\n    if (!checkout.id) {\r\n      console.error('event checkout missing id', checkout)\r\n      return c.json({ error: 'sumup_missing_id' }, 502)\r\n    }\r\n    \r\n    // Store payment details in transactions table\r\n    await c.env.DB.prepare(`\r\n      INSERT INTO transactions (transaction_type, reference_id, user_id, email, name, order_ref,\r\n                                checkout_id, amount, currency, payment_status, idempotency_key, consent_at)\r\n      VALUES ('ticket', ?, ?, ?, ?, ?, ?, ?, ?, 'pending', ?, ?)\r\n    `).bind(ticketId, ident.id, email, clampStr(name,200), order_ref, checkout.id,\r\n            String(amount), currency, idem || null, toIso(new Date())).run()\r\n    \r\n    return c.json({ orderRef: order_ref, checkoutId: checkout.id })\r\n  } catch (e) {\r\n    const debugMode = ['1','true','yes'].includes(String(c.req.query('debug') || c.env.DEBUG || '').toLowerCase())\r\n    console.error('events checkout error', e)\r\n    return c.json(debugMode ? { error:'internal_error', detail: String(e), stack: String(e?.stack||'') } : { error:'internal_error' },500)\r\n  }\r\n})\r\n\r\n// Confirm ticket purchase with payment verification + capacity race guard\r\napp.get('/events/confirm', async c => {\r\n  const orderRef = c.req.query('orderRef')\r\n  if (!orderRef || !EVT_UUID_RE.test(orderRef)) return c.json({ ok:false, error:'invalid_orderRef' },400)\r\n  \r\n  // Get transaction record\r\n  const transaction = await c.env.DB.prepare('SELECT * FROM transactions WHERE order_ref = ? AND transaction_type = \"ticket\"').bind(orderRef).first()\r\n  if (!transaction) return c.json({ ok:false, error:'order_not_found' },404)\r\n  \r\n  // Get ticket record\r\n  const ticket = await c.env.DB.prepare('SELECT * FROM tickets WHERE id = ?').bind(transaction.reference_id).first()\r\n  if (!ticket) return c.json({ ok:false, error:'ticket_not_found' },404)\r\n  if (ticket.status === 'active') {\r\n    const ev = await c.env.DB.prepare('SELECT event_name, event_datetime FROM events WHERE event_id = ?').bind(ticket.event_id).first()\r\n    return c.json({ \r\n      ok: true, \r\n      status: 'already_active',\r\n      eventName: ev?.event_name,\r\n      eventDate: ev?.event_datetime,\r\n      ticketCount: 1,\r\n      amount: transaction.amount,\r\n      currency: transaction.currency || 'GBP'\r\n    })\r\n  }\r\n  \r\n  // Verify payment with SumUp\r\n  let payment\r\n  try { payment = await fetchPayment(c.env, transaction.checkout_id) } \r\n  catch { return c.json({ ok:false, error:'verify_failed' },400) }\r\n  \r\n  const paid = payment && (payment.status === 'PAID' || payment.status === 'SUCCESSFUL')\r\n  if (!paid) return c.json({ ok:false, status: payment?.status || 'PENDING' })\r\n  \r\n  // Verify amount/currency\r\n  if (payment.amount != Number(transaction.amount) || (transaction.currency && payment.currency !== transaction.currency)) {\r\n    return c.json({ ok:false, error:'payment_mismatch' },400)\r\n  }\r\n\r\n  // Get event details\r\n  const ev = await c.env.DB.prepare('SELECT * FROM events WHERE event_id = ?').bind(ticket.event_id).first()\r\n  if (!ev) return c.json({ ok:false, error:'event_not_found' },404)\r\n  \r\n  // Capacity check\r\n  if (ev.capacity && ev.tickets_sold >= ev.capacity) return c.json({ ok:false, error:'sold_out' },409)\r\n  \r\n  // Update ticket and transaction status\r\n  await c.env.DB.batch([\r\n    c.env.DB.prepare('UPDATE tickets SET status = \"active\" WHERE id = ?').bind(ticket.id),\r\n    c.env.DB.prepare('UPDATE transactions SET payment_status = \"PAID\", payment_id = ?, updated_at = ? WHERE id = ?')\r\n      .bind(payment.id, toIso(new Date()), transaction.id),\r\n    // Increment if not exceeded capacity\r\n    c.env.DB.prepare('UPDATE events SET tickets_sold = tickets_sold + 1 WHERE event_id = ? AND (capacity IS NULL OR tickets_sold < capacity)')\r\n      .bind(ticket.event_id)\r\n  ])\r\n  \r\n  // Send confirmation email\r\n  const user = await c.env.DB.prepare('SELECT * FROM users WHERE user_id = ?').bind(transaction.user_id).first()\r\n  if (user) {\r\n    const emailContent = getTicketConfirmationEmail(ev, user, transaction)\r\n    await sendEmail(c.env, { to: user.email, ...emailContent })\r\n  }\r\n  \r\n  return c.json({ \r\n    ok: true, \r\n    status: 'active',\r\n    eventName: ev.event_name,\r\n    eventDate: ev.event_datetime,\r\n    ticketCount: 1,\r\n    amount: transaction.amount,\r\n    currency: transaction.currency || 'GBP'\r\n  })\r\n})\r\n\r\n// Optional tiny debug endpoint\r\napp.get('/_debug/ping', c => {\r\n  const origin = c.req.header('Origin') || ''\r\n  const allowed = (c.env.ALLOWED_ORIGIN || '').split(',').map(s=>s.trim()).filter(Boolean)\r\n  const allow = allowed.includes(origin) ? origin : (allowed[0] || '')\r\n  return c.json({ ok:true, origin, allow, allowed })\r\n})\r\n\r\n// Debug schema inspector\r\napp.get('/_debug/schema', async c => {\r\n  try {\r\n    const s = await getSchema(c.env.DB)\r\n    const memberships = await c.env.DB.prepare('PRAGMA table_info(memberships)').all().catch(()=>({ results: [] }))\r\n    const tickets = await c.env.DB.prepare('PRAGMA table_info(tickets)').all().catch(()=>({ results: [] }))\r\n    const tables = await c.env.DB.prepare(\"SELECT name FROM sqlite_master WHERE type='table'\").all().catch(()=>({ results: [] }))\r\n    const tnames = new Set((tickets?.results||[]).map(r => String(r.name||'').toLowerCase()))\r\n    const ticketFkCol = tnames.has(s.fkColumn) ? s.fkColumn : (tnames.has('member_id') ? 'member_id' : (tnames.has('user_id') ? 'user_id' : null))\r\n    return c.json({ ok:true, schema: s, ticketFkCol, tables: tables.results||[], memberships: memberships.results||[], tickets: tickets.results||[] })\r\n  } catch (e) {\r\n    return c.json({ ok:false, error: String(e) }, 500)\r\n  }\r\n})\r\n\r\n// Debug SumUp OAuth scopes\r\napp.get('/_debug/sumup-scopes', async c => {\r\n  try {\r\n    // Test with payment_instruments scope\r\n    const result = await sumupToken(c.env, 'payments payment_instruments')\r\n    return c.json({ \r\n      ok: true, \r\n      requestedScopes: 'payments payment_instruments',\r\n      grantedScopes: result.scope,\r\n      scopesArray: (result.scope || '').split(/\\s+/).filter(Boolean),\r\n      hasPaymentInstruments: (result.scope || '').includes('payment_instruments'),\r\n      fullResponse: result\r\n    })\r\n  } catch (e) {\r\n    return c.json({ \r\n      ok: false, \r\n      error: String(e.message || e),\r\n      stack: String(e.stack || '')\r\n    }, 500)\r\n  }\r\n})\r\n\r\n// === Auto-Renewal Management Endpoints ===\r\n\r\n// Get auto-renewal status for a user\r\napp.get('/membership/auto-renewal', async (c) => {\r\n  const email = c.req.query('email')\r\n  if (!email || !EMAIL_RE.test(email)) return c.json({ error: 'invalid_email' }, 400)\r\n  \r\n  const ident = await findIdentityByEmail(c.env.DB, email)\r\n  if (!ident) return c.json({ enabled: false, hasPaymentMethod: false })\r\n  \r\n  const membership = await getActiveMembership(c.env.DB, ident.id)\r\n  if (!membership) return c.json({ enabled: false, hasPaymentMethod: false })\r\n  \r\n  const instrument = await getActivePaymentInstrument(c.env.DB, ident.id)\r\n  \r\n  return c.json({\r\n    enabled: membership.auto_renew === 1,\r\n    hasPaymentMethod: !!instrument,\r\n    paymentMethod: instrument ? {\r\n      cardType: instrument.card_type,\r\n      last4: instrument.last_4,\r\n      expiryMonth: instrument.expiry_month,\r\n      expiryYear: instrument.expiry_year\r\n    } : null,\r\n    membershipEndDate: membership.end_date,\r\n    plan: membership.plan\r\n  })\r\n})\r\n\r\n// Toggle auto-renewal on/off\r\napp.post('/membership/auto-renewal/toggle', async (c) => {\r\n  try {\r\n    const { email, enabled } = await c.req.json()\r\n    if (!email || !EMAIL_RE.test(email)) return c.json({ error: 'invalid_email' }, 400)\r\n    if (typeof enabled !== 'boolean') return c.json({ error: 'enabled must be boolean' }, 400)\r\n    \r\n    const ident = await findIdentityByEmail(c.env.DB, email)\r\n    if (!ident) return c.json({ error: 'user_not_found' }, 404)\r\n    \r\n    const membership = await getActiveMembership(c.env.DB, ident.id)\r\n    if (!membership) return c.json({ error: 'no_active_membership' }, 404)\r\n    \r\n    await c.env.DB.prepare('UPDATE memberships SET auto_renew = ? WHERE id = ?')\r\n      .bind(enabled ? 1 : 0, membership.id).run()\r\n    \r\n    return c.json({ ok: true, enabled })\r\n  } catch (e) {\r\n    console.error('Toggle auto-renewal error:', e)\r\n    return c.json({ error: 'internal_error' }, 500)\r\n  }\r\n})\r\n\r\n// Remove saved payment method (disables auto-renewal)\r\napp.post('/membership/payment-method/remove', async (c) => {\r\n  try {\r\n    const { email } = await c.req.json()\r\n    if (!email || !EMAIL_RE.test(email)) return c.json({ error: 'invalid_email' }, 400)\r\n    \r\n    const ident = await findIdentityByEmail(c.env.DB, email)\r\n    if (!ident) return c.json({ error: 'user_not_found' }, 404)\r\n    \r\n    // Deactivate all payment instruments\r\n    await c.env.DB.prepare('UPDATE payment_instruments SET is_active = 0 WHERE user_id = ?')\r\n      .bind(ident.id).run()\r\n    \r\n    // Disable auto-renewal for active memberships\r\n    await c.env.DB.prepare('UPDATE memberships SET auto_renew = 0, payment_instrument_id = NULL WHERE (user_id = ? OR member_id = ?) AND status = \"active\"')\r\n      .bind(ident.id, ident.id).run()\r\n    \r\n    return c.json({ ok: true })\r\n  } catch (e) {\r\n    console.error('Remove payment method error:', e)\r\n    return c.json({ error: 'internal_error' }, 500)\r\n  }\r\n})\r\n\r\n// Test endpoint to manually trigger renewal for a specific user\r\napp.get('/test/renew-user', async (c) => {\r\n  const email = c.req.query('email')\r\n  if (!email) return c.json({ error: 'email required' }, 400)\r\n  \r\n  try {\r\n    await ensureSchema(c.env.DB, 'user_id')\r\n    \r\n    const ident = await findIdentityByEmail(c.env.DB, email)\r\n    if (!ident) return c.json({ error: 'user_not_found' }, 404)\r\n    \r\n    // Check schema for correct column name\r\n    const mc = await c.env.DB.prepare('PRAGMA table_info(memberships)').all()\r\n    const mnames = new Set((mc?.results||[]).map(r => String(r.name||'').toLowerCase()))\r\n    \r\n    let where, binds\r\n    if (mnames.has('user_id') && mnames.has('member_id')) {\r\n      where = '(user_id = ? OR member_id = ?)'\r\n      binds = [ident.id, ident.id]\r\n    } else if (mnames.has('user_id')) {\r\n      where = 'user_id = ?'\r\n      binds = [ident.id]\r\n    } else {\r\n      where = 'member_id = ?'\r\n      binds = [ident.id]\r\n    }\r\n    \r\n    // Find active membership with auto-renewal\r\n    const membership = await c.env.DB.prepare(`\r\n      SELECT * FROM memberships \r\n      WHERE ${where}\r\n        AND status = 'active' \r\n        AND auto_renew = 1\r\n      LIMIT 1\r\n    `).bind(...binds).first()\r\n    \r\n    if (!membership) {\r\n      return c.json({ error: 'no_auto_renew_membership' }, 404)\r\n    }\r\n    \r\n    console.log('Manually triggering renewal for membership:', membership.id)\r\n    const result = await processMembershipRenewal(c.env.DB, membership, c.env)\r\n    \r\n    return c.json({ \r\n      success: result.success, \r\n      membership_id: membership.id,\r\n      result \r\n    })\r\n  } catch (e) {\r\n    console.error('Manual renewal test error:', e)\r\n    return c.json({ error: String(e), stack: String(e.stack || '') }, 500)\r\n  }\r\n})\r\n\r\n// Cron trigger for processing renewals (runs daily)\r\nasync function handleScheduled(event, env, ctx) {\r\n  console.log('Starting membership renewal cron job')\r\n  \r\n  try {\r\n    await ensureSchema(env.DB, 'user_id')\r\n    \r\n    // Find memberships expiring in the next 7 days that have auto-renewal enabled\r\n    const sevenDaysFromNow = toIso(addMonths(new Date(), 0.23)) // ~7 days\r\n    const now = toIso(new Date())\r\n    \r\n    const expiringMemberships = await env.DB.prepare(`\r\n      SELECT * FROM memberships \r\n      WHERE status = 'active' \r\n        AND auto_renew = 1 \r\n        AND end_date <= ? \r\n        AND end_date >= ?\r\n        AND (renewal_attempts IS NULL OR renewal_attempts < 3)\r\n      ORDER BY end_date ASC\r\n    `).bind(sevenDaysFromNow, now).all()\r\n    \r\n    console.log(`Found ${expiringMemberships.results?.length || 0} memberships to renew`)\r\n    \r\n    const results = []\r\n    for (const membership of (expiringMemberships.results || [])) {\r\n      console.log(`Processing renewal for membership ${membership.id}`)\r\n      const result = await processMembershipRenewal(env.DB, membership, env)\r\n      results.push({ membershipId: membership.id, ...result })\r\n      \r\n      // Small delay to avoid rate limiting\r\n      await new Promise(resolve => setTimeout(resolve, 100))\r\n    }\r\n    \r\n    console.log('Renewal cron job completed', { processed: results.length, successful: results.filter(r => r.success).length })\r\n    \r\n    return { success: true, processed: results.length, results }\r\n  } catch (e) {\r\n    console.error('Renewal cron job error:', e)\r\n    return { success: false, error: String(e) }\r\n  }\r\n}\r\n\r\nexport default {\r\n  fetch: app.fetch,\r\n  scheduled: handleScheduled\r\n}\r\n"],
  "mappings": "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",
  "names": ["fn", "assert", "clear", "count", "countReset", "createTask", "debug", "dir", "dirxml", "error", "group", "groupCollapsed", "groupEnd", "info", "log", "profile", "profileEnd", "table", "time", "timeEnd", "timeLog", "timeStamp", "trace", "warn", "performance", "performance", "env2", "nextTick2", "dir", "assert", "getBuiltinModule", "env", "exit", "nextTick", "platform", "assert", "cloudflare_default", "cloudflare_default", "context", "match", "raw", "context", "app", "env", "context", "context", "Node", "Node", "Hono", "Hono", "env", "customer", "title", "savePaymentInstrument", "debug", "cardLast4", "ev", "env"]
}
