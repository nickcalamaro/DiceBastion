PRAGMA defer_foreign_keys=TRUE;
CREATE TABLE services (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  code TEXT NOT NULL UNIQUE,            -- e.g. 'monthly', 'quarterly', 'annual'
  name TEXT,                            -- display name
  description TEXT,                     -- optional longer description
  amount TEXT NOT NULL,                 -- price as string (e.g. '10.00')
  currency TEXT NOT NULL DEFAULT 'GBP', -- ISO currency, e.g. 'GBP'
  months INTEGER NOT NULL,              -- duration in months to add
  active INTEGER NOT NULL DEFAULT 1,    -- 1 active, 0 inactive
  created_at TEXT NOT NULL DEFAULT (strftime('%Y-%m-%dT%H:%M:%fZ','now')),
  updated_at TEXT
);
INSERT INTO "services" VALUES(1,'monthly','Monthly Membership','One month membership','1','GBP',1,1,'2025-10-22T20:27:48.050Z',NULL);
INSERT INTO "services" VALUES(2,'quarterly','Quarterly Membership','Three months membership','25.00','GBP',3,1,'2025-10-22T20:27:48.050Z',NULL);
INSERT INTO "services" VALUES(3,'annual','Annual Membership','Twelve months membership','90.00','GBP',12,1,'2025-10-22T20:27:48.050Z',NULL);
CREATE TABLE users (
    user_id INTEGER PRIMARY KEY AUTOINCREMENT,
    email TEXT NOT NULL UNIQUE,
    name TEXT,
    created_at TEXT NOT NULL DEFAULT (strftime('%Y-%m-%dT%H:%M:%fZ','now'))
, password_hash TEXT, is_admin INTEGER DEFAULT 0, is_active INTEGER DEFAULT 1, last_login_at TEXT, updated_at TEXT);
INSERT INTO "users" VALUES(1,'ncalamaro@gmail.com','Nick Calamaro','2025-11-09T23:08:37.130Z','$2y$10$mUkjTLdjnO72ENwIIP77geShUA7VqOeElwejQvGxf8jgE2VP0YEIu',1,1,'2026-01-05T17:18:11.056Z','2025-12-11 12:12:20');
INSERT INTO "users" VALUES(2,'jenniferluttig99@gmail.com','Jen','2025-11-11T20:31:58.833Z','$2a$10$C2EEM1p2KsjBz2KjDa6InOKtkAvLj.4VRWIjra.6BDKLitDyMVr3m',1,1,'2025-12-11T15:10:43.974Z','2025-11-11T20:31:58.833Z');
INSERT INTO "users" VALUES(3,'nuwkgeh@gmail.com','Biuwegg','2025-11-11T20:39:42.288Z','$2a$12$//7kfyHLLSnPbueGh8emcOaGwOdDx7LGNFMbOteYBeH2vDXblSdvG',0,1,NULL,'2025-11-11T20:39:42.288Z');
INSERT INTO "users" VALUES(4,'mrsantini392@gmail.com','Angelo Santini','2025-11-18T17:06:04.996Z',NULL,0,1,NULL,'2025-11-18T17:06:04.996Z');
INSERT INTO "users" VALUES(5,'soulium58@gmail.com','Angelo Santini','2025-11-18T18:02:23.020Z',NULL,0,1,NULL,'2025-11-18T18:02:23.020Z');
INSERT INTO "users" VALUES(6,'ncalamaro+testing@gmail.com','Nick','2025-11-26T20:12:17.664Z',NULL,0,1,NULL,'2025-11-26T20:12:17.664Z');
INSERT INTO "users" VALUES(7,'ncalamaro+testtest@gmail.com','Nick','2025-11-26T22:28:21.771Z',NULL,0,1,NULL,'2025-11-26T22:28:21.771Z');
INSERT INTO "users" VALUES(8,'ncalamaro+test3@gmail.com','Nick','2025-11-26T22:34:34.746Z',NULL,0,1,NULL,'2025-11-26T22:34:34.746Z');
INSERT INTO "users" VALUES(9,'ncalamaro+test4@gmail.com','Nick','2025-11-26T22:41:15.736Z',NULL,0,1,NULL,'2025-11-26T22:41:15.736Z');
INSERT INTO "users" VALUES(10,'ncalamaro+test5@gmail.com','Nick','2025-11-26T22:50:11.761Z',NULL,0,1,NULL,'2025-11-26T22:50:11.761Z');
INSERT INTO "users" VALUES(11,'ncalamaro+test6@gmail.com','Nick','2025-11-26T22:53:03.028Z',NULL,0,1,NULL,'2025-11-26T22:53:03.028Z');
INSERT INTO "users" VALUES(12,'ncalamaro+test7@gmail.com','Nick','2025-11-26T22:57:14.969Z',NULL,0,1,NULL,'2025-11-26T22:57:14.969Z');
INSERT INTO "users" VALUES(13,'ncalamaro+test8@gmail.com','Nick','2025-11-26T23:23:40.241Z',NULL,0,1,NULL,'2025-11-26T23:23:40.241Z');
INSERT INTO "users" VALUES(14,'ncalamaro+test9@gmail.com','Nick','2025-11-26T23:52:59.748Z',NULL,0,1,NULL,'2025-11-26T23:52:59.748Z');
INSERT INTO "users" VALUES(15,'ncalamaro+test10@gmail.com','Nick','2025-11-26T23:56:32.130Z',NULL,0,1,NULL,'2025-11-26T23:56:32.130Z');
INSERT INTO "users" VALUES(16,'ncalamaro+test11@gmail.com','Nick','2025-11-26T23:58:14.595Z',NULL,0,1,NULL,'2025-11-26T23:58:14.595Z');
INSERT INTO "users" VALUES(17,'ncalamaro+333@gmail.com','Nick','2025-11-27T00:05:16.713Z',NULL,0,1,NULL,'2025-11-27T00:05:16.713Z');
INSERT INTO "users" VALUES(18,'ncalamaro+343@gmail.com','Nick','2025-11-27T00:08:21.477Z',NULL,0,1,NULL,'2025-11-27T00:08:21.477Z');
INSERT INTO "users" VALUES(19,'ncalamaro+345@gmail.com','Nick','2025-11-27T00:16:23.405Z',NULL,0,1,NULL,'2025-11-27T00:16:23.405Z');
INSERT INTO "users" VALUES(20,'ncalamaro+346@gmail.com','Nick','2025-11-27T00:30:35.785Z',NULL,0,1,NULL,'2025-11-27T00:30:35.785Z');
INSERT INTO "users" VALUES(21,'ncalamaro+347@gmail.com','Nick','2025-11-27T00:44:50.095Z',NULL,0,1,NULL,'2025-11-27T00:44:50.095Z');
INSERT INTO "users" VALUES(22,'ncalamaro+447@gmail.com','Nick','2025-11-27T00:49:30.424Z',NULL,0,1,NULL,'2025-11-27T00:49:30.424Z');
INSERT INTO "users" VALUES(23,'ncalamaro+247@gmail.com','Nick','2025-11-27T00:57:44.232Z',NULL,0,1,NULL,'2025-11-27T00:57:44.232Z');
INSERT INTO "users" VALUES(24,'ncalamaro+22@gmail.com','Nick','2025-12-17T10:54:35.761Z',NULL,0,1,NULL,NULL);
INSERT INTO "users" VALUES(25,'e.otsason@gmail.com','Edward Otsason','2026-01-05T11:31:46.601Z',NULL,0,1,NULL,NULL);
INSERT INTO "users" VALUES(26,'mla88tavares@hotmail.co.uk','Michael Tavares','2026-01-05T11:33:05.159Z',NULL,0,1,NULL,NULL);
INSERT INTO "users" VALUES(27,'Colinfabre@hotmail.com','Colin Fabre','2026-01-05T11:38:08.936Z',NULL,0,1,NULL,NULL);
INSERT INTO "users" VALUES(28,'colinfabre@hotmail.com','Colin Fabre','2026-01-05T11:44:25.405Z',NULL,0,1,NULL,NULL);
INSERT INTO "users" VALUES(29,'aitch17@gmail.com','Nicholas Hoare','2026-01-05T11:44:48.411Z',NULL,0,1,NULL,NULL);
INSERT INTO "users" VALUES(30,'keeran.slade@gmail.com','Keeran Slade','2026-01-05T12:07:31.837Z',NULL,0,1,NULL,NULL);
INSERT INTO "users" VALUES(31,'amclmowe@gmail.com','Amber Fiello','2026-01-05T12:08:05.335Z',NULL,0,1,NULL,NULL);
INSERT INTO "users" VALUES(32,'ncalamaro+2479@gmail.com','Nick','2026-01-05T16:29:20.531Z',NULL,0,1,NULL,NULL);
INSERT INTO "users" VALUES(33,'ncalamaro+279@gmail.com','Nick','2026-01-05T16:29:39.411Z',NULL,0,1,NULL,NULL);
INSERT INTO "users" VALUES(34,'ncalamaro+334@gmail.com','Nick','2026-01-05T16:43:45.987Z',NULL,0,1,NULL,NULL);
INSERT INTO "users" VALUES(35,'ncalamaro+1222@gmail.com','Nick','2026-01-05T17:09:53.059Z',NULL,0,1,NULL,NULL);
INSERT INTO "users" VALUES(36,'ncalamaro+12232@gmail.com','Nick','2026-01-05T17:12:30.952Z',NULL,0,1,NULL,NULL);
INSERT INTO "users" VALUES(37,'ncalamaro+9@gmail.com','Nick','2026-01-05T17:15:26.062Z',NULL,0,1,NULL,NULL);
INSERT INTO "users" VALUES(38,'ncalamaro+qkwkhtrbe@gmail.com','Nick','2026-01-06T10:20:16.180Z',NULL,0,1,NULL,NULL);
INSERT INTO "users" VALUES(39,'ncalamaro+12247@gmail.com','Nick','2026-01-06T10:52:26.503Z',NULL,0,1,NULL,NULL);
INSERT INTO "users" VALUES(40,'ncalamaro+2121211247@gmail.com','Nick','2026-01-06T10:56:51.152Z',NULL,0,1,NULL,NULL);
INSERT INTO "users" VALUES(41,'ncalamaro+ftg@gmail.com','Nick','2026-01-06T11:13:55.593Z',NULL,0,1,NULL,NULL);
INSERT INTO "users" VALUES(42,'ncalamaro+222@gmail.com','Nick','2026-01-06T19:15:41.770Z',NULL,0,1,NULL,NULL);
INSERT INTO "users" VALUES(43,'ncalamaro+test_payment_instrument@gmail.com','Nick','2026-01-06T23:24:39.519Z',NULL,0,1,NULL,NULL);
INSERT INTO "users" VALUES(44,'ncalamaro+testrecurring@gmail.com','Nick','2026-01-07T10:00:17.250Z',NULL,0,1,NULL,NULL);
INSERT INTO "users" VALUES(45,'ncalamaro+testrecur@gmail.com','Nick','2026-01-07T10:09:24.716Z',NULL,0,1,NULL,NULL);
INSERT INTO "users" VALUES(46,'ncalamaro+trest@gmail.com','Nick','2026-01-07T10:21:26.762Z',NULL,0,1,NULL,NULL);
INSERT INTO "users" VALUES(47,'ncalamaro+trest2@gmail.com','Nick','2026-01-07T11:02:30.304Z',NULL,0,1,NULL,NULL);
INSERT INTO "users" VALUES(48,'ncalamaro+trest3@gmail.com','Nick','2026-01-07T11:14:44.523Z',NULL,0,1,NULL,NULL);
INSERT INTO "users" VALUES(49,'ncalamaro+trest4@gmail.com','Nick','2026-01-07T11:32:47.261Z',NULL,0,1,NULL,NULL);
INSERT INTO "users" VALUES(50,'ncalamaro+999@gmail.com','Nick','2026-01-07T11:54:25.300Z',NULL,0,1,NULL,NULL);
INSERT INTO "users" VALUES(51,'ncalamaro+099@gmail.com','Nick','2026-01-07T12:31:53.842Z',NULL,0,1,NULL,NULL);
CREATE TABLE memberships (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  user_id INTEGER NOT NULL,
  plan TEXT NOT NULL CHECK(plan IN ('monthly','quarterly','annual')),
  status TEXT NOT NULL CHECK(status IN ('pending','active','expired')) DEFAULT 'pending',
  start_date TEXT,
  end_date TEXT,
  payment_id TEXT UNIQUE,
  order_ref TEXT UNIQUE,
  auto_renew INTEGER NOT NULL DEFAULT 0,
  created_at TEXT NOT NULL DEFAULT (strftime('%Y-%m-%dT%H:%M:%fZ','now')),
  checkout_id TEXT, amount TEXT, currency TEXT, consent_at TEXT, idempotency_key TEXT, payment_status TEXT, payment_instrument_id TEXT, renewal_failed_at TEXT, renewal_attempts INTEGER DEFAULT 0, renewal_warning_sent INTEGER DEFAULT 0,
  FOREIGN KEY(user_id) REFERENCES users(user_id)
);
INSERT INTO "memberships" VALUES(1,1,'monthly','active','2025-11-11T21:49:57.440Z','2025-12-11T21:49:57.000Z','702897f1-41de-4353-b1d9-ba26bd38d2d9','ffbef01e-4eca-4f6f-9dc2-b76e2d49189e',0,'2025-11-11T21:49:46.408Z','702897f1-41de-4353-b1d9-ba26bd38d2d9','1','GBP','2025-11-11T21:49:46.403Z','00cf3d65-57d8-4c21-98da-e8009bc2fe8d','PAID',NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(2,1,'monthly','active','2025-12-11T21:49:57.000Z','2026-01-11T21:49:57.000Z','06d13295-7507-4b1d-97a7-6ee77a1105eb','9a54cc21-770a-4cea-adeb-700017a33d21',0,'2025-11-12T09:37:24.444Z','06d13295-7507-4b1d-97a7-6ee77a1105eb','1','GBP','2025-11-12T09:37:24.445Z','5da76952-258c-4d9b-baa5-72ec2991e205','PAID',NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(3,1,'monthly','pending',NULL,NULL,NULL,'8b4d2833-3476-43c9-9801-a349182bd685',0,'2025-11-12T10:25:34.178Z','ca6c4a10-d3d1-4910-a958-2ae4ffcbc21a','1','GBP','2025-11-12T10:25:34.172Z','5faf5220-5df1-4ca1-ac3c-f8d1473a9cf9',NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(4,6,'monthly','active','2025-11-26T20:12:38.113Z','2025-12-26T20:12:38.000Z','38715ed7-eab5-4552-8885-c1bd665d3706','3a1eac55-58bc-4e58-a1a0-858a4e1f086c',1,'2025-11-26T20:12:18.396Z','38715ed7-eab5-4552-8885-c1bd665d3706','1','GBP','2025-11-26T20:12:18.391Z','c4bbb8c6-69fc-4896-8143-918818d0cf3c','PAID',NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(5,7,'monthly','active','2025-11-26T22:28:33.505Z','2025-12-26T22:28:33.000Z',NULL,NULL,1,'2025-11-26T22:28:22.255Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(6,8,'monthly','pending',NULL,NULL,NULL,NULL,1,'2025-11-26T22:34:35.160Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(7,8,'monthly','active','2025-11-26T22:35:45.997Z','2025-12-26T22:35:45.000Z',NULL,NULL,1,'2025-11-26T22:35:36.172Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(8,9,'monthly','active','2025-11-26T22:42:03.957Z','2025-12-26T22:42:03.000Z',NULL,NULL,1,'2025-11-26T22:41:16.140Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(9,10,'monthly','active','2025-11-26T22:50:22.350Z','2025-12-26T22:50:22.000Z',NULL,NULL,1,'2025-11-26T22:50:12.168Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(10,11,'monthly','active','2025-11-26T22:53:14.675Z','2025-12-26T22:53:14.000Z',NULL,NULL,1,'2025-11-26T22:53:03.432Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(11,12,'monthly','active','2025-11-26T22:57:25.481Z','2025-12-26T22:57:25.000Z',NULL,NULL,1,'2025-11-26T22:57:15.379Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(12,13,'monthly','active','2025-11-26T23:24:06.858Z','2025-12-26T23:24:06.000Z',NULL,NULL,1,'2025-11-26T23:23:40.645Z',NULL,NULL,NULL,NULL,NULL,NULL,'1cd467b0-968a-43e2-8acf-9b5595cb8c15',NULL,0,0);
INSERT INTO "memberships" VALUES(13,14,'monthly','pending',NULL,NULL,NULL,NULL,1,'2025-11-26T23:53:00.134Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(14,14,'monthly','active','2025-11-26T23:53:34.649Z','2025-12-26T23:53:34.000Z',NULL,NULL,1,'2025-11-26T23:53:08.563Z',NULL,NULL,NULL,NULL,NULL,NULL,'07e81017-0812-4c84-8763-910b90414f88',NULL,0,0);
INSERT INTO "memberships" VALUES(15,15,'monthly','active','2025-11-26T23:56:55.647Z','2025-12-26T23:56:55.000Z',NULL,NULL,1,'2025-11-26T23:56:32.528Z',NULL,NULL,NULL,NULL,NULL,NULL,'884a996a-678b-4fb4-b346-c062b6c868b6',NULL,0,0);
INSERT INTO "memberships" VALUES(16,16,'monthly','active','2025-11-26T23:58:32.611Z','2025-12-26T23:58:32.000Z',NULL,NULL,1,'2025-11-26T23:58:14.997Z',NULL,NULL,NULL,NULL,NULL,NULL,'c8d6eaae-e633-42b6-ac61-66cd095d3116',NULL,0,0);
INSERT INTO "memberships" VALUES(17,17,'monthly','pending',NULL,NULL,NULL,NULL,1,'2025-11-27T00:05:17.112Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(18,17,'monthly','active','2025-11-27T00:05:56.561Z','2025-12-27T00:05:56.000Z',NULL,NULL,1,'2025-11-27T00:05:38.232Z',NULL,NULL,NULL,NULL,NULL,NULL,'04673ca9-a3f5-49e0-a4e4-c3230c4bc902',NULL,0,0);
INSERT INTO "memberships" VALUES(19,18,'monthly','active','2025-11-27T00:08:39.174Z','2025-12-27T00:08:39.000Z',NULL,NULL,1,'2025-11-27T00:08:21.867Z',NULL,NULL,NULL,NULL,NULL,NULL,'4ab7f034-1e77-424a-822d-a88068c73243',NULL,0,0);
INSERT INTO "memberships" VALUES(20,19,'monthly','active','2025-11-27T00:16:44.719Z','2025-12-27T00:16:44.000Z',NULL,NULL,1,'2025-11-27T00:16:23.782Z',NULL,NULL,NULL,NULL,NULL,NULL,'678ee9d4-5eb8-47ed-a82a-80532c69b8d4',NULL,0,0);
INSERT INTO "memberships" VALUES(21,20,'monthly','active','2025-11-27T00:30:57.685Z','2025-12-27T00:30:57.000Z',NULL,NULL,1,'2025-11-27T00:30:36.246Z',NULL,NULL,NULL,NULL,NULL,NULL,'d5dae9b7-3441-4088-ab29-76150b3507e5',NULL,0,0);
INSERT INTO "memberships" VALUES(22,21,'monthly','active','2025-11-27T00:45:12.874Z','2025-12-27T00:45:12.000Z',NULL,NULL,1,'2025-11-27T00:44:50.499Z',NULL,NULL,NULL,NULL,NULL,NULL,'660eb844-04dc-4f63-a2a2-9a012e5d6081',NULL,0,0);
INSERT INTO "memberships" VALUES(23,22,'monthly','active','2025-11-27T00:49:50.923Z','2025-12-27T00:49:50.000Z',NULL,NULL,1,'2025-11-27T00:49:30.788Z',NULL,NULL,NULL,NULL,NULL,NULL,'1d1274c0-bf75-44c8-81f6-d919454caa31','2026-01-06T23:15:42.396Z',1,0);
INSERT INTO "memberships" VALUES(24,23,'monthly','active','2025-11-27T00:58:00.811Z','2026-01-27T00:58:00.000Z',NULL,NULL,1,'2025-11-27T00:57:44.646Z',NULL,NULL,NULL,NULL,NULL,NULL,'b2af7213-3f52-4b9f-8f53-d7fb5f730ee6',NULL,0,0);
INSERT INTO "memberships" VALUES(25,24,'quarterly','pending',NULL,NULL,NULL,NULL,1,'2025-12-17T10:54:36.318Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(26,26,'annual','active','2025-11-27T00:58:00.811Z','2026-11-20T00:58:00.000Z',NULL,NULL,0,'2026-01-05T11:39:54.731Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(27,27,'annual','active','2025-11-27T00:58:00.811Z','2026-03-27T00:58:00.000Z',NULL,NULL,0,'2026-01-05T11:44:06.591Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(28,29,'annual','active','2025-11-11T21:49:57.440Z','2026-04-07T21:49:57.440Z',NULL,NULL,0,'2026-01-05T11:57:52.701Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(29,28,'annual','active','2025-11-27T00:58:00.811Z','2026-11-20T00:58:00.000Z',NULL,NULL,0,'2026-01-05T12:00:37.770Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(30,30,'annual','active',NULL,'2025-12-11T21:49:57.000Z',NULL,NULL,0,'2026-01-05T12:08:31.889Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(31,31,'annual','active',NULL,'2025-12-11T21:49:57.000Z',NULL,NULL,0,'2026-01-05T12:08:44.952Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(33,43,'monthly','pending',NULL,NULL,NULL,'55231281-b798-49e6-81d7-84f11cce0edc',1,'2026-01-06T23:24:40.076Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(34,43,'monthly','pending',NULL,NULL,NULL,'987e160a-190c-48a1-a0d9-5d958c155c28',1,'2026-01-06T23:25:45.374Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(35,43,'monthly','pending',NULL,NULL,NULL,'652a3374-52b5-411b-a587-2df5de364ff0',1,'2026-01-06T23:26:07.559Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(36,43,'monthly','pending',NULL,NULL,NULL,'0f5f9104-0947-4839-9c61-8fdd5ee04ea5',1,'2026-01-06T23:26:07.902Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(37,43,'monthly','pending',NULL,NULL,NULL,'25027589-b37d-4a80-b5c2-f156fb90e08b',1,'2026-01-06T23:26:48.762Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(38,45,'monthly','pending',NULL,NULL,NULL,'42dd80b1-af80-44d8-aa12-b1f71100e94b',1,'2026-01-07T10:09:25.331Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(39,45,'monthly','pending',NULL,NULL,NULL,'eb5f75c0-421e-46d0-b6f7-df235be2108a',1,'2026-01-07T10:14:32.190Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(40,45,'monthly','pending',NULL,NULL,NULL,'eb7e95e2-601e-4ae9-b364-10cb345a93f1',1,'2026-01-07T10:19:27.220Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(41,46,'monthly','pending',NULL,NULL,NULL,'a18cb348-6fa7-40aa-b0c5-b7438f0c4cd0',1,'2026-01-07T10:21:27.276Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(42,46,'monthly','pending',NULL,NULL,NULL,'c2bb5784-0c2e-4475-81db-ad7ec28d1f9f',1,'2026-01-07T10:36:22.519Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(43,46,'monthly','pending',NULL,NULL,NULL,'8401a464-b085-4c14-a9f7-70653d108773',1,'2026-01-07T10:39:05.619Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(44,46,'monthly','active','2026-01-07T11:00:07.453Z','2026-02-07T11:00:07.000Z',NULL,'2bbe209a-384a-45da-b130-b2b867b1dfaf',1,'2026-01-07T10:59:35.837Z',NULL,NULL,NULL,NULL,NULL,NULL,'38d7542f-cdc7-4288-b819-4eb96d0f7cae',NULL,0,0);
INSERT INTO "memberships" VALUES(45,47,'monthly','active','2026-01-07T11:04:00.868Z','2026-02-07T11:04:00.000Z',NULL,'0eae5fe2-0eb5-4714-8cdf-cf69dc5426da',1,'2026-01-07T11:02:30.850Z',NULL,NULL,NULL,NULL,NULL,NULL,'257f6df8-71a6-48d8-8ff3-86daaafedad4',NULL,0,0);
INSERT INTO "memberships" VALUES(46,48,'monthly','active','2026-01-07T11:15:24.188Z','2026-02-07T11:15:24.000Z',NULL,'4080ca61-f5d3-4cff-8c76-3dcf4b39cf38',1,'2026-01-07T11:14:45.165Z',NULL,NULL,NULL,NULL,NULL,NULL,'dd6a8307-8758-4fef-94b2-0702639efe0d',NULL,0,0);
INSERT INTO "memberships" VALUES(47,49,'monthly','active','2026-01-07T11:33:18.636Z','2026-02-07T11:33:18.000Z',NULL,'e4b96298-c35a-41fd-b5cc-8e9fa4bf98e7',1,'2026-01-07T11:32:47.949Z',NULL,NULL,NULL,NULL,NULL,NULL,'8219bf3c-4bfb-4c96-9f5d-b42fa3133ace',NULL,0,0);
INSERT INTO "memberships" VALUES(48,10,'monthly','pending',NULL,NULL,NULL,'835a4a77-ab22-45e4-892e-c7c63494d63e',1,'2026-01-07T11:36:23.869Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(49,10,'monthly','active','2026-01-07T11:37:09.062Z','2026-02-07T11:37:09.000Z',NULL,'ca905200-c98f-4ca2-a500-d8d7282d9334',1,'2026-01-07T11:36:40.597Z',NULL,NULL,NULL,NULL,NULL,NULL,'0e89c0b2-7c3c-469a-96dc-f31a5a27730b',NULL,0,0);
INSERT INTO "memberships" VALUES(50,11,'monthly','active','2026-01-07T11:46:21.547Z','2026-02-07T11:46:21.000Z',NULL,'675f6008-f803-460a-bd8c-9b673ee8b7db',1,'2026-01-07T11:45:49.177Z',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0);
INSERT INTO "memberships" VALUES(51,50,'monthly','active','2026-01-07T11:56:15.743Z','2026-03-07T11:56:15.000Z',NULL,'562ac719-09c9-4c25-b49f-32245115e67e',1,'2026-01-07T11:54:25.927Z',NULL,NULL,NULL,NULL,NULL,NULL,'4251c198-342a-4bf4-ac65-11c74b8a375a',NULL,0,0);
INSERT INTO "memberships" VALUES(52,51,'monthly','active','2026-01-07T12:32:53.213Z','2026-02-07T12:32:53.000Z',NULL,'d636092d-707a-4c4c-82ed-b4b7c20986c3',1,'2026-01-07T12:31:54.537Z',NULL,NULL,NULL,NULL,NULL,NULL,'0bd54a58-cea6-49c5-be52-18113ed0a2e4',NULL,0,0);
CREATE TABLE payment_instruments (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        user_id INTEGER NOT NULL,
        instrument_id TEXT NOT NULL,
        card_type TEXT,
        last_4 TEXT,
        expiry_month INTEGER,
        expiry_year INTEGER,
        created_at TEXT NOT NULL,
        updated_at TEXT NOT NULL,
        is_active INTEGER DEFAULT 1,
        UNIQUE(user_id, instrument_id)
      );
INSERT INTO "payment_instruments" VALUES(1,13,'1cd467b0-968a-43e2-8acf-9b5595cb8c15',NULL,NULL,NULL,NULL,'2025-11-26T23:24:06.940Z','2025-11-26T23:24:06.940Z',1);
INSERT INTO "payment_instruments" VALUES(2,14,'07e81017-0812-4c84-8763-910b90414f88',NULL,NULL,NULL,NULL,'2025-11-26T23:53:34.723Z','2025-11-26T23:53:34.723Z',1);
INSERT INTO "payment_instruments" VALUES(3,15,'884a996a-678b-4fb4-b346-c062b6c868b6',NULL,NULL,NULL,NULL,'2025-11-26T23:56:55.702Z','2025-11-26T23:56:55.702Z',1);
INSERT INTO "payment_instruments" VALUES(4,16,'c8d6eaae-e633-42b6-ac61-66cd095d3116',NULL,NULL,NULL,NULL,'2025-11-26T23:58:32.664Z','2025-11-26T23:58:32.664Z',1);
INSERT INTO "payment_instruments" VALUES(5,17,'04673ca9-a3f5-49e0-a4e4-c3230c4bc902',NULL,NULL,NULL,NULL,'2025-11-27T00:05:56.642Z','2025-11-27T00:05:56.642Z',1);
INSERT INTO "payment_instruments" VALUES(6,18,'4ab7f034-1e77-424a-822d-a88068c73243',NULL,NULL,NULL,NULL,'2025-11-27T00:08:39.257Z','2025-11-27T00:08:39.257Z',1);
INSERT INTO "payment_instruments" VALUES(7,19,'678ee9d4-5eb8-47ed-a82a-80532c69b8d4',NULL,NULL,NULL,NULL,'2025-11-27T00:16:44.777Z','2025-11-27T00:16:44.777Z',1);
INSERT INTO "payment_instruments" VALUES(8,20,'d5dae9b7-3441-4088-ab29-76150b3507e5',NULL,NULL,NULL,NULL,'2025-11-27T00:30:57.750Z','2025-11-27T00:30:57.750Z',1);
INSERT INTO "payment_instruments" VALUES(9,21,'660eb844-04dc-4f63-a2a2-9a012e5d6081',NULL,NULL,NULL,NULL,'2025-11-27T00:45:12.969Z','2025-11-27T00:45:12.969Z',1);
INSERT INTO "payment_instruments" VALUES(10,22,'1d1274c0-bf75-44c8-81f6-d919454caa31',NULL,NULL,NULL,NULL,'2025-11-27T00:49:51.075Z','2025-11-27T00:49:51.075Z',1);
INSERT INTO "payment_instruments" VALUES(11,23,'b2af7213-3f52-4b9f-8f53-d7fb5f730ee6',NULL,NULL,NULL,NULL,'2025-11-27T00:58:00.875Z','2025-11-27T00:58:00.875Z',1);
INSERT INTO "payment_instruments" VALUES(12,46,'38d7542f-cdc7-4288-b819-4eb96d0f7cae',NULL,NULL,NULL,NULL,'2026-01-07T11:00:07.581Z','2026-01-07T11:00:07.581Z',1);
INSERT INTO "payment_instruments" VALUES(13,47,'257f6df8-71a6-48d8-8ff3-86daaafedad4',NULL,NULL,NULL,NULL,'2026-01-07T11:04:00.976Z','2026-01-07T11:04:00.976Z',1);
INSERT INTO "payment_instruments" VALUES(14,48,'dd6a8307-8758-4fef-94b2-0702639efe0d',NULL,NULL,NULL,NULL,'2026-01-07T11:15:24.312Z','2026-01-07T11:15:24.312Z',1);
INSERT INTO "payment_instruments" VALUES(15,49,'8219bf3c-4bfb-4c96-9f5d-b42fa3133ace',NULL,NULL,NULL,NULL,'2026-01-07T11:33:18.769Z','2026-01-07T11:33:18.769Z',1);
INSERT INTO "payment_instruments" VALUES(16,10,'0e89c0b2-7c3c-469a-96dc-f31a5a27730b',NULL,NULL,NULL,NULL,'2026-01-07T11:37:09.187Z','2026-01-07T11:37:09.187Z',1);
INSERT INTO "payment_instruments" VALUES(17,50,'4251c198-342a-4bf4-ac65-11c74b8a375a','VISA','5724',NULL,NULL,'2026-01-07T11:56:15.852Z','2026-01-07T11:56:17.748Z',1);
INSERT INTO "payment_instruments" VALUES(18,51,'0bd54a58-cea6-49c5-be52-18113ed0a2e4','VISA','5724',NULL,NULL,'2026-01-07T12:32:53.347Z','2026-01-07T12:32:55.102Z',1);
CREATE TABLE renewal_log (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        membership_id INTEGER NOT NULL,
        attempt_date TEXT NOT NULL,
        status TEXT NOT NULL,
        payment_id TEXT,
        error_message TEXT,
        amount TEXT,
        currency TEXT
      );
INSERT INTO "renewal_log" VALUES(1,24,'2025-11-27T01:05:19.449Z','success','f5ad1570-0c67-4371-8a9f-fe2ca38e62b0',NULL,'1','GBP');
INSERT INTO "renewal_log" VALUES(2,23,'2026-01-06T23:15:42.452Z','failed',NULL,'Payment processing failed: {"message":"Validation error","error_code":"INVALID","param":"token"}','1','GBP');
INSERT INTO "renewal_log" VALUES(3,51,'2026-01-07T11:57:09.795Z','success','27255afa-6b6c-410a-b354-f3f68a4c1253',NULL,'1','GBP');
CREATE TABLE IF NOT EXISTS "tickets" (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  event_id INTEGER NOT NULL,
  user_id INTEGER NOT NULL,
  status TEXT DEFAULT 'pending',
  amount TEXT,
  currency TEXT,
  consent_at TEXT,
  idempotency_key TEXT,
  payment_status TEXT,
  created_at TEXT DEFAULT CURRENT_TIMESTAMP
);
INSERT INTO "tickets" VALUES(1,42,1,'pending','40','GBP','2025-11-11T21:29:08.928Z','f57f4c44-2b5a-4a34-80d9-37a946adf1aa',NULL,'2025-11-11T21:29:08.928Z');
INSERT INTO "tickets" VALUES(2,42,1,'pending','40','GBP','2025-11-11T21:48:35.445Z','380b2bfc-9347-4d99-a664-b59089595b13',NULL,'2025-11-11T21:48:35.445Z');
INSERT INTO "tickets" VALUES(3,42,1,'pending','35','GBP','2025-11-11T21:50:23.169Z','e7ec1019-f9db-4e34-a472-351f4beaa883',NULL,'2025-11-11T21:50:23.169Z');
INSERT INTO "tickets" VALUES(4,42,1,'pending','35','GBP','2025-11-18T23:57:55.835Z','73e575e9-d1f2-4ade-813b-4e64aa007ae2',NULL,'2025-11-18T23:57:55.835Z');
INSERT INTO "tickets" VALUES(5,42,1,'pending','35','GBP','2025-11-19T00:23:58.630Z','052c0050-4bbc-4456-b5a1-7186f3cb7515',NULL,'2025-11-19T00:23:58.630Z');
INSERT INTO "tickets" VALUES(6,50,25,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T11:31:49.623Z');
INSERT INTO "tickets" VALUES(7,50,25,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T11:31:50.678Z');
INSERT INTO "tickets" VALUES(8,50,25,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T11:31:52.649Z');
INSERT INTO "tickets" VALUES(9,50,25,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T11:31:53.258Z');
INSERT INTO "tickets" VALUES(10,50,25,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T11:31:53.552Z');
INSERT INTO "tickets" VALUES(11,50,25,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T11:31:54.221Z');
INSERT INTO "tickets" VALUES(12,50,25,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T11:31:54.469Z');
INSERT INTO "tickets" VALUES(13,50,25,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T11:31:55.003Z');
INSERT INTO "tickets" VALUES(14,50,25,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T11:31:55.236Z');
INSERT INTO "tickets" VALUES(15,50,25,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T11:31:55.375Z');
INSERT INTO "tickets" VALUES(16,50,25,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T11:31:55.453Z');
INSERT INTO "tickets" VALUES(17,50,25,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T11:31:55.632Z');
INSERT INTO "tickets" VALUES(18,50,25,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T11:31:55.801Z');
INSERT INTO "tickets" VALUES(19,50,26,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T11:33:05.792Z');
INSERT INTO "tickets" VALUES(20,50,27,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T11:38:09.468Z');
INSERT INTO "tickets" VALUES(21,50,25,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T11:38:48.810Z');
INSERT INTO "tickets" VALUES(22,50,25,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T11:38:50.917Z');
INSERT INTO "tickets" VALUES(23,50,25,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T11:38:52.204Z');
INSERT INTO "tickets" VALUES(24,50,25,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T11:38:52.812Z');
INSERT INTO "tickets" VALUES(25,50,25,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T11:38:53.380Z');
INSERT INTO "tickets" VALUES(26,50,25,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T11:38:53.948Z');
INSERT INTO "tickets" VALUES(27,50,28,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T11:44:25.978Z');
INSERT INTO "tickets" VALUES(28,50,29,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T11:44:49.029Z');
INSERT INTO "tickets" VALUES(29,50,27,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T11:45:14.226Z');
INSERT INTO "tickets" VALUES(30,50,27,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T11:45:53.030Z');
INSERT INTO "tickets" VALUES(31,50,29,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T11:54:06.986Z');
INSERT INTO "tickets" VALUES(32,50,29,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T11:55:36.104Z');
INSERT INTO "tickets" VALUES(33,50,25,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T12:07:40.133Z');
INSERT INTO "tickets" VALUES(34,50,25,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T12:08:58.129Z');
INSERT INTO "tickets" VALUES(35,50,1,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T13:01:22.386Z');
INSERT INTO "tickets" VALUES(36,50,32,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T16:29:21.470Z');
INSERT INTO "tickets" VALUES(37,50,33,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T16:29:40.171Z');
INSERT INTO "tickets" VALUES(38,50,17,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T16:43:03.101Z');
INSERT INTO "tickets" VALUES(39,50,34,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T16:43:46.781Z');
INSERT INTO "tickets" VALUES(40,50,35,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T17:09:53.873Z');
INSERT INTO "tickets" VALUES(41,50,36,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T17:12:31.726Z');
INSERT INTO "tickets" VALUES(42,50,37,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T17:15:26.901Z');
INSERT INTO "tickets" VALUES(43,50,37,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T17:16:13.885Z');
INSERT INTO "tickets" VALUES(44,50,37,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T17:17:55.380Z');
INSERT INTO "tickets" VALUES(45,54,1,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T17:19:07.101Z');
INSERT INTO "tickets" VALUES(46,54,1,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-05T17:31:29.387Z');
INSERT INTO "tickets" VALUES(47,54,1,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-06T00:41:09.436Z');
INSERT INTO "tickets" VALUES(48,54,1,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-06T00:44:49.667Z');
INSERT INTO "tickets" VALUES(49,54,1,'active',NULL,NULL,NULL,NULL,NULL,'2026-01-06T09:42:30.551Z');
INSERT INTO "tickets" VALUES(50,54,38,'active',NULL,NULL,NULL,NULL,NULL,'2026-01-06T10:20:16.755Z');
INSERT INTO "tickets" VALUES(51,54,38,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-06T10:33:35.457Z');
INSERT INTO "tickets" VALUES(52,54,1,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-06T10:33:55.592Z');
INSERT INTO "tickets" VALUES(53,54,39,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-06T10:52:27.064Z');
INSERT INTO "tickets" VALUES(54,54,40,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-06T10:56:51.737Z');
INSERT INTO "tickets" VALUES(55,54,40,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-06T10:57:48.281Z');
INSERT INTO "tickets" VALUES(56,54,1,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-06T11:03:05.519Z');
INSERT INTO "tickets" VALUES(57,54,1,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-06T11:03:52.988Z');
INSERT INTO "tickets" VALUES(58,54,1,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-06T11:04:34.674Z');
INSERT INTO "tickets" VALUES(59,54,23,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-06T11:09:13.759Z');
INSERT INTO "tickets" VALUES(60,54,41,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-06T11:13:56.175Z');
INSERT INTO "tickets" VALUES(61,54,41,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-06T11:14:28.587Z');
INSERT INTO "tickets" VALUES(62,54,1,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-06T11:14:44.671Z');
INSERT INTO "tickets" VALUES(63,54,41,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-06T11:14:56.937Z');
INSERT INTO "tickets" VALUES(64,54,42,'pending',NULL,NULL,NULL,NULL,NULL,'2026-01-06T19:15:42.488Z');
INSERT INTO "tickets" VALUES(65,54,1,'active',NULL,NULL,NULL,NULL,NULL,'2026-01-06T19:15:54.781Z');
CREATE TABLE transactions (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        transaction_type TEXT NOT NULL,
        reference_id INTEGER,
        user_id INTEGER,
        email TEXT,
        name TEXT,
        order_ref TEXT UNIQUE,
        checkout_id TEXT,
        payment_id TEXT,
        amount TEXT,
        currency TEXT,
        payment_status TEXT,
        idempotency_key TEXT,
        consent_at TEXT,
        created_at TEXT NOT NULL DEFAULT (strftime('%Y-%m-%dT%H:%M:%fZ','now')),
        updated_at TEXT
      );
INSERT INTO "transactions" VALUES(1,'membership',5,7,'ncalamaro+testtest@gmail.com','Nick','50d9ddde-31e4-4d3b-a5f5-0a64d2b587fa','d70140b2-ab5c-4f8e-94a4-7308c08466d2','d70140b2-ab5c-4f8e-94a4-7308c08466d2','1','GBP','PAID','f37338fc-87f3-4675-9502-838902b52cc3','2025-11-26T22:28:22.465Z','2025-11-26T22:28:22.470Z','2025-11-26T22:28:33.656Z');
INSERT INTO "transactions" VALUES(2,'membership',6,8,'ncalamaro+test3@gmail.com','Nick','b2dfcbaf-25f8-4ccf-9aab-1a57fb7b3908','dc0c0bfd-fae8-4b60-82e4-abb02d2f1493',NULL,'1','GBP','pending','ee6da59a-9929-4295-84d6-912a023ea19b','2025-11-26T22:34:35.362Z','2025-11-26T22:34:35.369Z',NULL);
INSERT INTO "transactions" VALUES(3,'membership',7,8,'ncalamaro+test3@gmail.com','Nick','b40cac8f-dc65-4201-a028-6e4f664be4fd','b82ff6fa-ce70-4943-aa7f-cc89b8663f9c','b82ff6fa-ce70-4943-aa7f-cc89b8663f9c','1','GBP','PAID','59322a0c-0724-4afe-a1a2-4049b5a0b383','2025-11-26T22:35:36.366Z','2025-11-26T22:35:36.364Z','2025-11-26T22:35:46.114Z');
INSERT INTO "transactions" VALUES(4,'membership',8,9,'ncalamaro+test4@gmail.com','Nick','21ce0617-9c6b-457c-ad26-b6b8f9999b38','59c337c6-ae15-4855-b6a1-bdacdd3d841d','59c337c6-ae15-4855-b6a1-bdacdd3d841d','1','GBP','PAID','fac8d436-f54a-487f-9501-a0b507cd7586','2025-11-26T22:41:16.580Z','2025-11-26T22:41:16.587Z','2025-11-26T22:42:04.081Z');
INSERT INTO "transactions" VALUES(5,'membership',9,10,'ncalamaro+test5@gmail.com','Nick','9fe6514a-54b0-42d8-acae-c529e7b030bd','e4e1530e-a97f-455a-b1bc-127839284f98','e4e1530e-a97f-455a-b1bc-127839284f98','1','GBP','PAID','55a39d06-0975-4dc8-a4d0-b9697c91c4e5','2025-11-26T22:50:12.363Z','2025-11-26T22:50:12.373Z','2025-11-26T22:50:22.485Z');
INSERT INTO "transactions" VALUES(6,'membership',10,11,'ncalamaro+test6@gmail.com','Nick','2eebdb51-2722-4fc7-a464-ef0ab79e0058','cdfac776-7b25-4c1a-ad19-e1c31f7253e6','cdfac776-7b25-4c1a-ad19-e1c31f7253e6','1','GBP','PAID','8a55ca1e-1fe5-4adb-9827-4cb28fc7202c','2025-11-26T22:53:03.632Z','2025-11-26T22:53:03.636Z','2025-11-26T22:53:14.814Z');
INSERT INTO "transactions" VALUES(7,'membership',11,12,'ncalamaro+test7@gmail.com','Nick','85b728f4-96a3-4727-88ec-443ae1236037','bb2f98dc-36c2-44f2-af41-ec6c2b953a32','bb2f98dc-36c2-44f2-af41-ec6c2b953a32','1','GBP','PAID','9774c255-0bce-4b1e-b940-5026afc675bf','2025-11-26T22:57:15.595Z','2025-11-26T22:57:15.597Z','2025-11-26T22:57:25.603Z');
INSERT INTO "transactions" VALUES(8,'membership',12,13,'ncalamaro+test8@gmail.com','Nick','2b85ecdf-bf90-4125-8cd4-cc6c327a19eb','570f1dec-8f15-4126-a2f2-b58edb0e7831','570f1dec-8f15-4126-a2f2-b58edb0e7831','1','GBP','PAID','aff62905-0cce-445b-8094-5b96b8a88f6c','2025-11-26T23:23:40.967Z','2025-11-26T23:23:40.978Z','2025-11-26T23:24:07.090Z');
INSERT INTO "transactions" VALUES(9,'membership',13,14,'ncalamaro+test9@gmail.com','Nick','73d58151-9fb2-4b9c-99b6-96a80b842ed2','43f25678-a691-492f-89b6-7d27552f5f22',NULL,'1','GBP','pending','3b60d612-db6d-4da0-9b02-409520aff8d6','2025-11-26T23:53:00.441Z','2025-11-26T23:53:00.449Z',NULL);
INSERT INTO "transactions" VALUES(10,'membership',14,14,'ncalamaro+test9@gmail.com','Nick','3b2b8098-77fc-4e01-b1a6-77368c849aa9','36db7d5b-b9d6-488a-8e77-807751355ad2','36db7d5b-b9d6-488a-8e77-807751355ad2','1','GBP','PAID','1ccfb349-b5d1-4de8-8ec9-ef79ee6517cb','2025-11-26T23:53:08.797Z','2025-11-26T23:53:08.801Z','2025-11-26T23:53:34.887Z');
INSERT INTO "transactions" VALUES(11,'membership',15,15,'ncalamaro+test10@gmail.com','Nick','dbb67441-e9ec-4f63-acf5-f74c87f10ecc','e4f7c682-f3b2-46d4-b2e5-486671f57f40','e4f7c682-f3b2-46d4-b2e5-486671f57f40','1','GBP','PAID','ee6648db-70b6-4035-8722-2c2199e84a8f','2025-11-26T23:56:32.863Z','2025-11-26T23:56:32.870Z','2025-11-26T23:56:55.851Z');
INSERT INTO "transactions" VALUES(12,'membership',16,16,'ncalamaro+test11@gmail.com','Nick','5346e47d-0977-4fc5-9c99-37aa3d0857a9','8128b6e3-7f3a-458a-b35e-9798930a88c6','8128b6e3-7f3a-458a-b35e-9798930a88c6','1','GBP','PAID','704bd10e-9191-402e-820a-bb54bbf050de','2025-11-26T23:58:15.296Z','2025-11-26T23:58:15.304Z','2025-11-26T23:58:32.802Z');
INSERT INTO "transactions" VALUES(13,'membership',17,17,'ncalamaro+333@gmail.com','Nick','634b7e5a-3a83-44cb-be68-524cb3bc56b5','71bf6b23-701e-4ada-a116-79dce60504c1',NULL,'1','GBP','pending','d3bdac87-483b-40c2-b066-3778b459bdb6','2025-11-27T00:05:17.416Z','2025-11-27T00:05:17.419Z',NULL);
INSERT INTO "transactions" VALUES(14,'membership',18,17,'ncalamaro+333@gmail.com','Nick','f2c83130-f181-4c8d-8b30-85e02fb51253','926e4f20-01e9-4686-91a5-d88a236d3b06','926e4f20-01e9-4686-91a5-d88a236d3b06','1','GBP','PAID','919eba6b-b1dd-44ef-8b26-1668541fd094','2025-11-27T00:05:38.486Z','2025-11-27T00:05:38.488Z','2025-11-27T00:05:56.854Z');
INSERT INTO "transactions" VALUES(15,'membership',19,18,'ncalamaro+343@gmail.com','Nick','ec53b81a-652e-44c8-a0a7-8e6ccb131f7a','dddc9309-ddd9-4368-858c-d1b0a3f83d6f','dddc9309-ddd9-4368-858c-d1b0a3f83d6f','1','GBP','PAID','24b5a38b-caed-439c-a986-092c1332b1ea','2025-11-27T00:08:22.156Z','2025-11-27T00:08:22.165Z','2025-11-27T00:08:39.398Z');
INSERT INTO "transactions" VALUES(16,'membership',20,19,'ncalamaro+345@gmail.com','Nick','10880459-1f78-4e07-a234-18fe9ece7422','e9971a7b-a601-45f1-8cc0-567d8f6ac056','e9971a7b-a601-45f1-8cc0-567d8f6ac056','1','GBP','PAID','dd34ccfe-70b5-4ff5-b4ee-05382baf4e26','2025-11-27T00:16:24.079Z','2025-11-27T00:16:24.083Z','2025-11-27T00:16:44.916Z');
INSERT INTO "transactions" VALUES(17,'membership',21,20,'ncalamaro+346@gmail.com','Nick','0cd4c647-3ae1-43b2-9689-12ad7fa0fc89','b28aa48c-c12f-45c0-a39e-5ddad996e203','b28aa48c-c12f-45c0-a39e-5ddad996e203','1','GBP','PAID','f9998833-6bce-4f61-bda6-b732da713037','2025-11-27T00:30:36.590Z','2025-11-27T00:30:36.601Z','2025-11-27T00:30:57.914Z');
INSERT INTO "transactions" VALUES(18,'membership',22,21,'ncalamaro+347@gmail.com','Nick','1fd1c008-996d-45ed-ad54-691dbec3293b','5fe5bdce-3f33-4796-85e7-00a5e5f3a729','5fe5bdce-3f33-4796-85e7-00a5e5f3a729','1','GBP','PAID','714ee6a8-0d6c-45e7-b940-b528534c49cd','2025-11-27T00:44:50.802Z','2025-11-27T00:44:50.811Z','2025-11-27T00:45:13.110Z');
INSERT INTO "transactions" VALUES(19,'membership',23,22,'ncalamaro+447@gmail.com','Nick','2130e2f6-dcf3-4f1f-8a1f-75f0e210e683','df553bdb-2f58-439a-9354-b9d8577b29b0','df553bdb-2f58-439a-9354-b9d8577b29b0','1','GBP','PAID','82c617d9-36ad-44d5-b605-8c7125d9d83f','2025-11-27T00:49:31.084Z','2025-11-27T00:49:31.091Z','2025-11-27T00:49:51.214Z');
INSERT INTO "transactions" VALUES(20,'membership',24,23,'ncalamaro+247@gmail.com','Nick','050ac9d0-0a76-4f9f-9cca-92a1a19cdf96','a2c554d1-c751-473c-aa88-e85cc0365faa','a2c554d1-c751-473c-aa88-e85cc0365faa','1','GBP','PAID','a5068ea3-4daa-4cf4-9f5a-bb5372a87aca','2025-11-27T00:57:44.964Z','2025-11-27T00:57:44.973Z','2025-11-27T00:58:01.032Z');
INSERT INTO "transactions" VALUES(21,'renewal',24,23,'ncalamaro+247@gmail.com','Nick','RENEWAL-24-40e7a42f-e356-48ec-8d6f-b2200614367f',NULL,'f5ad1570-0c67-4371-8a9f-fe2ca38e62b0','1','GBP','PAID',NULL,NULL,'2025-11-27T01:05:19.406Z',NULL);
INSERT INTO "transactions" VALUES(22,'membership',25,24,'ncalamaro+22@gmail.com','Nick','073e2301-72c6-4f85-8041-60403ff5edb3','98ab9c15-c587-4c9a-b8f3-433324a8c8ca',NULL,'25','GBP','pending','349425dc-1cf6-4aca-9b45-8465fee22ae4','2025-12-17T10:54:36.665Z','2025-12-17T10:54:36.663Z',NULL);
INSERT INTO "transactions" VALUES(23,'ticket',6,25,'e.otsason@gmail.com','Edward Otsason','EVT-50-88ace3b9-394f-4b36-9e53-6c3c2d0889c0','1335588d-a04a-44d3-bd30-cc4ab65c5d51',NULL,'35','GBP','pending','10efdb5d-672b-4a26-8754-56a2eb6e68c1','2026-01-05T11:31:51.984Z','2026-01-05T11:31:52.015Z',NULL);
INSERT INTO "transactions" VALUES(24,'ticket',7,25,'e.otsason@gmail.com','Edward Otsason','EVT-50-317f67a3-ec29-4810-a3d8-23a7b79f43b1','f78b5f47-7075-452b-a0fa-7a623c7199fb',NULL,'35','GBP','pending','ee775048-0a51-4669-881e-3951e1acd29d','2026-01-05T11:31:52.701Z','2026-01-05T11:31:53.020Z',NULL);
INSERT INTO "transactions" VALUES(25,'ticket',8,25,'e.otsason@gmail.com','Edward Otsason','EVT-50-36113179-9f74-44ea-8115-704ca8b003e3','99d4fef8-695e-466c-9d06-9b4f447107c2',NULL,'35','GBP','pending','08b19c42-ada8-44e8-b5e7-6df7196fdbda','2026-01-05T11:31:53.985Z','2026-01-05T11:31:53.976Z',NULL);
INSERT INTO "transactions" VALUES(26,'ticket',9,25,'e.otsason@gmail.com','Edward Otsason','EVT-50-8d8334fb-5d65-4b7e-9adf-827106fd40eb','56dc421f-5a4b-4fc5-acfa-474ae0d80d78',NULL,'35','GBP','pending','ce7f051d-dca8-4a45-bd72-efa113e18b53','2026-01-05T11:31:53.986Z','2026-01-05T11:31:53.999Z',NULL);
INSERT INTO "transactions" VALUES(27,'ticket',10,25,'e.otsason@gmail.com','Edward Otsason','EVT-50-8231ee49-95fd-4ad1-b201-72d0db9c4d74','b12b89a8-e5a2-4282-aa76-ed3111241a91',NULL,'35','GBP','pending','458fce7b-c28e-447a-a9a4-292f4979f7f7','2026-01-05T11:31:54.280Z','2026-01-05T11:31:54.273Z',NULL);
INSERT INTO "transactions" VALUES(28,'ticket',11,25,'e.otsason@gmail.com','Edward Otsason','EVT-50-39182ad8-ab06-428b-8314-5168e8195f38','69afc9b2-48c9-4b78-a52b-c0e52237eec3',NULL,'35','GBP','pending','2de34f64-6daa-4c3d-ae9d-bb14f8a758e1','2026-01-05T11:31:54.990Z','2026-01-05T11:31:54.999Z',NULL);
INSERT INTO "transactions" VALUES(29,'ticket',13,25,'e.otsason@gmail.com','Edward Otsason','EVT-50-8f26402c-f4b9-4ee9-adff-08f2b40e8f5b','44f74654-947f-4b7a-a6ad-1c15a05cc08a',NULL,'35','GBP','pending','4660d6a1-a098-4f54-986e-81ea546fc81a','2026-01-05T11:31:55.774Z','2026-01-05T11:31:55.807Z',NULL);
INSERT INTO "transactions" VALUES(30,'ticket',12,25,'e.otsason@gmail.com','Edward Otsason','EVT-50-2ada43df-476b-4f3c-bdef-844e4acca538','119c15fa-fa97-4b3f-a4d9-478ec2a65987',NULL,'35','GBP','pending','d46af456-9daa-418e-a9a0-6e6606c13591','2026-01-05T11:31:55.848Z','2026-01-05T11:31:55.881Z',NULL);
INSERT INTO "transactions" VALUES(31,'ticket',15,25,'e.otsason@gmail.com','Edward Otsason','EVT-50-cbce7d92-9eb6-4940-b15d-f190cde23bca','50269ec9-8e7b-492d-865c-fc0490c2546d',NULL,'35','GBP','pending','60501ce3-7db5-4a1f-a56c-fc0d9c9b827b','2026-01-05T11:31:56.136Z','2026-01-05T11:31:56.189Z',NULL);
INSERT INTO "transactions" VALUES(32,'ticket',16,25,'e.otsason@gmail.com','Edward Otsason','EVT-50-788ac5eb-fa52-41db-a2ac-a7ca1e87df0b','f1e7c530-f19e-421e-913e-411fbbea8223',NULL,'35','GBP','pending','8df3beaa-4324-4265-9013-92f8bb6bbae1','2026-01-05T11:31:56.227Z','2026-01-05T11:31:56.280Z',NULL);
INSERT INTO "transactions" VALUES(33,'ticket',17,25,'e.otsason@gmail.com','Edward Otsason','EVT-50-50a0308d-f1f7-48bf-9d04-94f9adc784bf','6826aa5d-6637-42db-a7d0-7b81a4377eda',NULL,'35','GBP','pending','2766bd84-e178-417b-b645-da160ce52c8e','2026-01-05T11:31:56.419Z','2026-01-05T11:31:56.468Z',NULL);
INSERT INTO "transactions" VALUES(34,'ticket',14,25,'e.otsason@gmail.com','Edward Otsason','EVT-50-7a582d3b-bd3b-4984-ba4c-11060868e555','26314d98-dc49-4d57-adad-21aaeafe95c0',NULL,'35','GBP','pending','c734f760-ce00-4547-9b7d-0929ce77aab4','2026-01-05T11:31:56.629Z','2026-01-05T11:31:56.695Z',NULL);
INSERT INTO "transactions" VALUES(35,'ticket',18,25,'e.otsason@gmail.com','Edward Otsason','EVT-50-bede9d55-9bb2-4ea8-866b-28f0b99d4bb3','acefcca5-30a1-4533-9026-3508f2643460',NULL,'35','GBP','pending','e7b635c3-fdbc-4968-9905-e39e3f1b070a','2026-01-05T11:31:57.109Z','2026-01-05T11:31:57.176Z',NULL);
INSERT INTO "transactions" VALUES(36,'ticket',19,26,'mla88tavares@hotmail.co.uk','Michael Tavares','EVT-50-d88f5b1f-3508-492a-b6c9-87c52091f7d5','51c632f7-f48b-4827-8eba-1e74ef27a72f',NULL,'35','GBP','pending','489ff3a4-1e85-4b9d-a0f0-87abdd4a46d6','2026-01-05T11:33:06.003Z','2026-01-05T11:33:06.004Z',NULL);
INSERT INTO "transactions" VALUES(37,'ticket',20,27,'Colinfabre@hotmail.com','Colin Fabre','EVT-50-f70155a6-a605-4706-8a2b-8bda7332b173','1c323e2b-077c-420e-9e4d-3b55052eb887',NULL,'35','GBP','pending','c14346d9-1edd-4ee5-a80a-6b85b54d845c','2026-01-05T11:38:09.724Z','2026-01-05T11:38:09.721Z',NULL);
INSERT INTO "transactions" VALUES(38,'ticket',21,25,'e.otsason@gmail.com','Edward Otsason','EVT-50-0c659531-dbe2-444a-a0ff-18c40bf606f3','241f1d14-5ebf-445f-b661-677533f5267f',NULL,'35','GBP','pending','58d1f1fd-dcea-4da6-8d97-588752edac62','2026-01-05T11:38:49.714Z','2026-01-05T11:38:49.774Z',NULL);
INSERT INTO "transactions" VALUES(39,'ticket',22,25,'e.otsason@gmail.com','Edward Otsason','EVT-50-45cde209-b014-4cb7-9d1c-2e2861786ace','cd468df8-3cf5-4666-95eb-b3d14bed3812',NULL,'35','GBP','pending','720c6870-b242-4495-af58-1c1cf2dfd514','2026-01-05T11:38:52.619Z','2026-01-05T11:38:52.666Z',NULL);
INSERT INTO "transactions" VALUES(40,'ticket',23,25,'e.otsason@gmail.com','Edward Otsason','EVT-50-3927e8f1-5421-49a8-b577-6f00a7c85e3a','74867331-2d80-467e-90e9-5c4b00670e0e',NULL,'35','GBP','pending','16ba16bd-c680-4a4f-b9d2-570597f819ec','2026-01-05T11:38:52.861Z','2026-01-05T11:38:52.893Z',NULL);
INSERT INTO "transactions" VALUES(41,'ticket',24,25,'e.otsason@gmail.com','Edward Otsason','EVT-50-df420462-83d4-4883-bc17-231803a45a58','4e33be31-9e44-4614-97a1-026d9c0200da',NULL,'35','GBP','pending','5b64cb7d-317f-49c0-8e52-8d49c3482b25','2026-01-05T11:38:53.482Z','2026-01-05T11:38:53.525Z',NULL);
INSERT INTO "transactions" VALUES(42,'ticket',25,25,'e.otsason@gmail.com','Edward Otsason','EVT-50-87bad8ab-4dd0-4c59-8b84-a43412fc964c','cdea4fcd-cfee-43a6-829e-b118752ced8b',NULL,'35','GBP','pending','5b8d434c-3e84-45c6-9ffd-3c752e9258c9','2026-01-05T11:38:54.008Z','2026-01-05T11:38:54.064Z',NULL);
INSERT INTO "transactions" VALUES(43,'ticket',26,25,'e.otsason@gmail.com','Edward Otsason','EVT-50-98515a5b-85ac-4ccd-af73-8d12fb544af0','ede6bc76-811a-4bc4-aa31-36264154dc33',NULL,'35','GBP','pending','8f83fc5b-b1be-45bc-9eab-1044fa5c10fa','2026-01-05T11:38:54.588Z','2026-01-05T11:38:54.647Z',NULL);
INSERT INTO "transactions" VALUES(44,'ticket',27,28,'colinfabre@hotmail.com','Colin Fabre','EVT-50-e6a8c8f6-051e-4d32-8130-e7e55f362724','76b66051-7d1d-43ec-b303-2ed29124b08f',NULL,'35','GBP','pending','19c67c7c-6bbb-4bdd-a2f8-88386f613df8','2026-01-05T11:44:26.247Z','2026-01-05T11:44:26.252Z',NULL);
INSERT INTO "transactions" VALUES(45,'ticket',28,29,'aitch17@gmail.com','Nicholas Hoare','EVT-50-f2a1c8bb-0089-4d1f-8bcf-e49562475dd9','d292299b-cc34-4e3e-b649-b2351558665a',NULL,'35','GBP','pending','99e9e44c-3306-478e-bd4d-f1493a57392c','2026-01-05T11:44:49.204Z','2026-01-05T11:44:49.203Z',NULL);
INSERT INTO "transactions" VALUES(46,'ticket',29,27,'Colinfabre@hotmail.com','Colin Fabre','EVT-50-652a5129-3118-4607-b125-3356f1c2ea1e','e32363fc-ff7b-4dcb-9695-9b92e32d010f',NULL,'30','GBP','pending','a21dce54-1114-4222-b556-4ed0c7f69c54','2026-01-05T11:45:14.445Z','2026-01-05T11:45:14.450Z',NULL);
INSERT INTO "transactions" VALUES(47,'ticket',30,27,'Colinfabre@hotmail.com','Colin Fabre','EVT-50-fba2d90c-6a24-4832-b951-4535fcd2bbdb','afd8d8dc-10b3-4011-a1cb-3bced5bfdb05',NULL,'30','GBP','pending','73b8b8f2-7b33-42f7-8039-bf41b32334d2','2026-01-05T11:45:53.345Z','2026-01-05T11:45:53.350Z',NULL);
INSERT INTO "transactions" VALUES(48,'ticket',31,29,'aitch17@gmail.com','Nicholas Hoare','EVT-50-98911206-3e31-4e1a-9890-e88c230126a6','e02334c8-f7eb-4e99-9093-ab1c1225b4d6',NULL,'35','GBP','pending','777f77c6-3a2a-43ab-8b43-35abc90670dd','2026-01-05T11:54:07.194Z','2026-01-05T11:54:07.200Z',NULL);
INSERT INTO "transactions" VALUES(49,'ticket',32,29,'aitch17@gmail.com','Nicholas Hoare','EVT-50-8d9cc60d-2c1c-415b-8c04-be74a9f05807','0ef8d18d-0240-4fa1-a6a2-536e609706d2',NULL,'35','GBP','pending','e52c8d3a-47a7-4384-9444-ce2dd1cdbd13','2026-01-05T11:55:36.324Z','2026-01-05T11:55:36.331Z',NULL);
INSERT INTO "transactions" VALUES(50,'ticket',33,25,'e.otsason@gmail.com','Edward Otsason','EVT-50-74a0347c-b4da-4287-b733-d83cd866d76c','f17257a5-0322-4e5e-af98-ff5a076e20bd',NULL,'35','GBP','pending','e08a3b61-9a8b-4be2-91be-07048edc0eb0','2026-01-05T12:07:41.449Z','2026-01-05T12:07:41.535Z',NULL);
INSERT INTO "transactions" VALUES(51,'ticket',34,25,'e.otsason@gmail.com','Edward Otsason','EVT-50-708d9c9b-e604-4fab-b388-52b51644a6a3','2811eed9-ee62-4bdb-abd8-6fdbaaafbd12',NULL,'35','GBP','pending','bfcc94e6-f420-489a-80f1-b7ed56073f05','2026-01-05T12:09:00.061Z','2026-01-05T12:09:00.141Z',NULL);
INSERT INTO "transactions" VALUES(52,'ticket',35,1,'ncalamaro@gmail.com','Nick','EVT-50-8c304b5d-47e9-4cca-b728-0df046ad8b4c','5e62ab41-e6b0-42be-a8a4-60d0063cbd98',NULL,'30','GBP','pending','bf2ee0bf-a1a7-473b-adea-ba9edb548794','2026-01-05T13:01:22.639Z','2026-01-05T13:01:22.640Z',NULL);
INSERT INTO "transactions" VALUES(53,'ticket',44,37,'ncalamaro+9@gmail.com','Nick','EVT-50-994f9f6e-a4dc-468c-ac9c-b9f701d5e934','f5b4c6b8-9eee-4adf-a978-7d912564bfc5',NULL,'35','GBP','pending','a1a9f36f-361a-4ec1-9aa5-180964b8e58d',NULL,'2026-01-05T17:17:55.572Z',NULL);
INSERT INTO "transactions" VALUES(54,'ticket',45,1,'ncalamaro@gmail.com','Nick','EVT-54-426a1e47-02cf-4cd0-a3ac-7254b615521f','259f54f2-21fc-4c63-acdb-9d358aaa9085',NULL,'1','GBP','pending','3198b4d1-a8e6-4f00-b9b3-9b3b1c7c65ee',NULL,'2026-01-05T17:19:07.283Z',NULL);
INSERT INTO "transactions" VALUES(55,'ticket',46,1,'ncalamaro@gmail.com','Nick','EVT-54-620af1e1-ab94-46f2-84ab-6bd3150505eb','5c0600ca-27d9-4351-944d-1530042f14f4',NULL,'1','GBP','pending','8e5d90a1-db0c-41f3-b659-32dfce34dcee',NULL,'2026-01-05T17:31:29.623Z',NULL);
INSERT INTO "transactions" VALUES(56,'ticket',47,1,'ncalamaro@gmail.com','Nick','EVT-54-bf0f5317-288d-48f3-8b04-a261c38c02f6','8e9fb68b-9ce3-426a-98d7-0b0f0792df95',NULL,'1','GBP','pending','38d32f3f-9017-4f99-84a9-7a2d8b34e170',NULL,'2026-01-06T00:41:09.706Z',NULL);
INSERT INTO "transactions" VALUES(57,'ticket',48,1,'ncalamaro@gmail.com','Nick','EVT-54-4a796417-81d5-45ce-bab1-60f3df3a06fe','f9276b02-5179-4ea9-8fd9-b5ce83731e38',NULL,'1','GBP','pending','3b39b1f0-9ff3-47b5-83aa-522b528d3ac0',NULL,'2026-01-06T00:44:49.963Z',NULL);
INSERT INTO "transactions" VALUES(58,'ticket',49,1,'ncalamaro@gmail.com','Nick','EVT-54-011ee3aa-1a84-4559-8463-74cccf72c027','7b56a6be-d4c1-4de3-bc09-baf84ba6cf15','7b56a6be-d4c1-4de3-bc09-baf84ba6cf15','1','GBP','PAID','a9d5706b-bed6-42ef-9d9c-7b3705bd7a7e',NULL,'2026-01-06T09:42:30.801Z','2026-01-06T10:16:26.287Z');
INSERT INTO "transactions" VALUES(59,'ticket',50,38,'ncalamaro+qkwkhtrbe@gmail.com','Nick','EVT-54-9f87be0d-ce48-4e77-968c-605120489a9f','fc385b52-4f0c-436b-b4cf-dd4ffead3675','fc385b52-4f0c-436b-b4cf-dd4ffead3675','1.5','GBP','PAID','d2c5e958-2f3c-4598-9bfe-67548ff2cced',NULL,'2026-01-06T10:20:16.990Z','2026-01-06T10:20:28.261Z');
INSERT INTO "transactions" VALUES(60,'ticket',51,38,'ncalamaro+qkwkhtrbe@gmail.com','Nick','EVT-54-c988e6b2-d71f-41eb-adb5-54a414b0bc4e','2edd9696-b17f-4830-a64e-e80e124ed41f',NULL,'1.5','GBP','pending','e5ff83c6-6471-458c-8856-406ec1b34d27',NULL,'2026-01-06T10:33:35.698Z',NULL);
INSERT INTO "transactions" VALUES(61,'ticket',52,1,'ncalamaro@gmail.com','Nick','EVT-54-6392c802-8db3-4c36-b1ac-7b9670b59186','ade77519-4ff9-4801-a846-cb9fd3fbed0d',NULL,'1','GBP','pending','2f910d0d-5bbd-48a0-b9b8-0371449fbb1d',NULL,'2026-01-06T10:33:55.808Z',NULL);
INSERT INTO "transactions" VALUES(62,'ticket',53,39,'ncalamaro+12247@gmail.com','Nick','EVT-54-4e13ac9a-4ad3-4c56-93ab-42605de6286c','9ba88c8e-befb-4603-8433-d4b573557cba',NULL,'1.5','GBP','pending','923553ba-1445-4e12-9dea-00d24191a0a7',NULL,'2026-01-06T10:52:27.306Z',NULL);
INSERT INTO "transactions" VALUES(63,'ticket',54,40,'ncalamaro+2121211247@gmail.com','Nick','EVT-54-b265c215-9108-443c-b940-9f23243b13bc','19b4a06f-dc0a-4a04-a761-54458281c5fc',NULL,'1.5','GBP','pending','5c302f18-6a9c-4bbd-bc76-739e159f24e5',NULL,'2026-01-06T10:56:52.005Z',NULL);
INSERT INTO "transactions" VALUES(64,'ticket',55,40,'ncalamaro+2121211247@gmail.com','Nick','EVT-54-1e4ba0c5-be6c-411d-a3a8-d40450cc315f','83285394-6717-468f-a7bc-3f8a0f534de0',NULL,'1.5','GBP','pending','2e0cf19e-4a9e-4169-a92f-29b027e8386f',NULL,'2026-01-06T10:57:48.688Z',NULL);
INSERT INTO "transactions" VALUES(65,'ticket',56,1,'ncalamaro@gmail.com','Nick','EVT-54-e9a272e7-bf05-4e7d-a70d-8dead5bf2cc9','bacec2ae-5119-4823-b646-6dcb4531f93b',NULL,'1','GBP','pending','e73e5ddb-2dd6-40f4-b564-3f70979e631e',NULL,'2026-01-06T11:03:05.786Z',NULL);
INSERT INTO "transactions" VALUES(66,'ticket',57,1,'ncalamaro@gmail.com','Nick','EVT-54-a981e380-e34b-4e38-bd26-2d207d75a530','a81b2ed8-52e8-424d-9a77-ea0574ef73ca',NULL,'1','GBP','pending','e1bd32e9-ff75-4e28-9669-771871c7490e',NULL,'2026-01-06T11:03:53.246Z',NULL);
INSERT INTO "transactions" VALUES(67,'ticket',58,1,'ncalamaro@gmail.com','Nick','EVT-54-97b29b12-2e63-4846-8af7-76e943eff1a8','8c9c79c6-e39b-4aa4-a862-a993499ead11',NULL,'1','GBP','pending','5c88cf49-dd5a-4be3-ab72-d7890957082d',NULL,'2026-01-06T11:04:34.930Z',NULL);
INSERT INTO "transactions" VALUES(68,'ticket',59,23,'ncalamaro+247@gmail.com','Nick','EVT-54-9be6e30a-85ec-48d0-adae-c2593a508e32','a4fe51b9-835c-4713-8e5d-4d4af4eb1540',NULL,'1','GBP','pending','1d7554a8-3fe5-477f-bff6-6aa7d343ee74',NULL,'2026-01-06T11:09:14.038Z',NULL);
INSERT INTO "transactions" VALUES(69,'ticket',60,41,'ncalamaro+ftg@gmail.com','Nick','EVT-54-ae33d7b5-4014-4ab5-b870-275cce240820','06a885cc-988c-49f4-a512-3a8dc1ef6936',NULL,'1.5','GBP','pending','306f0529-90f5-4e10-87df-e165eb0c4e03',NULL,'2026-01-06T11:13:56.426Z',NULL);
INSERT INTO "transactions" VALUES(70,'ticket',61,41,'ncalamaro+ftg@gmail.com','Nick','EVT-54-ea43aaa5-8231-42d2-b692-0c9b2fa48cfb','a3be5000-8305-42b1-bac5-fbc39197f3dd',NULL,'1.5','GBP','pending','6b596b99-2711-4e1a-9fa1-94d35e898489',NULL,'2026-01-06T11:14:28.837Z',NULL);
INSERT INTO "transactions" VALUES(71,'ticket',62,1,'ncalamaro@gmail.com','Nick','EVT-54-a0c405b8-07db-4c95-966d-abcc7fd10bc9','fb622fad-6363-424c-82d1-78f35a783ae0',NULL,'1','GBP','pending','7b6762b1-192f-4cd1-b121-11850c62aab2',NULL,'2026-01-06T11:14:44.893Z',NULL);
INSERT INTO "transactions" VALUES(72,'ticket',63,41,'ncalamaro+ftg@gmail.com','Nick','EVT-54-88ba6c22-362c-4267-be32-3478c2366a18','37220e61-3211-4cf1-8660-f5546164e972',NULL,'1.5','GBP','pending','97c95509-e327-4466-9de1-43a2a18c59c3',NULL,'2026-01-06T11:14:57.158Z',NULL);
INSERT INTO "transactions" VALUES(73,'ticket',64,42,'ncalamaro+222@gmail.com','Nick','EVT-54-8efa8565-6b8a-4c4d-b806-e0d63fd760db','1112ac0a-804f-4cad-8355-524cdaa1d9b0',NULL,'1.5','GBP','pending','74948e1a-7b0d-4a4f-8843-b04c46613030',NULL,'2026-01-06T19:15:42.822Z',NULL);
INSERT INTO "transactions" VALUES(74,'ticket',65,1,'ncalamaro@gmail.com','Nick','EVT-54-a7137254-ef0d-4d47-b101-50be5deab3d5','b2f2182a-aace-4daa-9b5d-c4278b946b7a','b2f2182a-aace-4daa-9b5d-c4278b946b7a','1','GBP','PAID','7b5c9345-de2c-4262-9661-e5dc79a0823d',NULL,'2026-01-06T19:15:55.013Z','2026-01-06T19:16:06.765Z');
INSERT INTO "transactions" VALUES(75,'membership',44,46,'ncalamaro+trest@gmail.com','nick','2bbe209a-384a-45da-b130-b2b867b1dfaf','dfc449d6-1849-4a2b-871c-53316347db2a','dfc449d6-1849-4a2b-871c-53316347db2a','1','GBP','PAID',NULL,'2026-01-07T10:59:36.257Z','2026-01-07T10:59:36.270Z','2026-01-07T11:00:07.748Z');
INSERT INTO "transactions" VALUES(76,'membership',45,47,'ncalamaro+trest2@gmail.com','Nick','0eae5fe2-0eb5-4714-8cdf-cf69dc5426da','38c86e6f-47b8-451f-af4f-5cf838bc8319','38c86e6f-47b8-451f-af4f-5cf838bc8319','1','GBP','PAID',NULL,'2026-01-07T11:02:31.374Z','2026-01-07T11:02:31.389Z','2026-01-07T11:04:01.112Z');
INSERT INTO "transactions" VALUES(77,'membership',46,48,'ncalamaro+trest3@gmail.com','Nick','4080ca61-f5d3-4cff-8c76-3dcf4b39cf38','41388dd0-0a3b-4d1b-a07f-4d206b57de28','8bd2a2cb-7bb1-4109-861f-2919e0e1dbb6','1','GBP','PAID',NULL,'2026-01-07T11:14:45.687Z','2026-01-07T11:14:45.692Z','2026-01-07T11:15:26.023Z');
INSERT INTO "transactions" VALUES(78,'membership_charge',46,48,'ncalamaro+trest3@gmail.com','Nick','4080ca61-f5d3-4cff-8c76-3dcf4b39cf38-charge',NULL,'8bd2a2cb-7bb1-4109-861f-2919e0e1dbb6','1','GBP','PAID',NULL,NULL,'2026-01-07T11:15:25.912Z',NULL);
INSERT INTO "transactions" VALUES(79,'membership',47,49,'ncalamaro+trest4@gmail.com','Nick','e4b96298-c35a-41fd-b5cc-8e9fa4bf98e7','1a7acc55-a099-45d0-b2d7-a49611130ddd','c432f9d9-0552-4a9d-b5e7-ddbf659c86ff','1','GBP','PAID',NULL,'2026-01-07T11:32:48.494Z','2026-01-07T11:32:48.499Z','2026-01-07T11:33:20.448Z');
INSERT INTO "transactions" VALUES(80,'membership_charge',47,49,'ncalamaro+trest4@gmail.com','Nick','e4b96298-c35a-41fd-b5cc-8e9fa4bf98e7-charge',NULL,'c432f9d9-0552-4a9d-b5e7-ddbf659c86ff','1','GBP','PAID',NULL,NULL,'2026-01-07T11:33:20.318Z',NULL);
INSERT INTO "transactions" VALUES(81,'membership',48,10,'ncalamaro+test5@gmail.com','Nick','835a4a77-ab22-45e4-892e-c7c63494d63e','90a3c5eb-0c08-47b0-b0c3-80323db0c179',NULL,'1','GBP','pending',NULL,'2026-01-07T11:36:24.353Z','2026-01-07T11:36:24.364Z',NULL);
INSERT INTO "transactions" VALUES(82,'membership',49,10,'ncalamaro+test5@gmail.com','Nicky','ca905200-c98f-4ca2-a500-d8d7282d9334','ada8867b-2b54-49d4-83a6-7b8ead3653a6','ccc3199d-51b5-4610-bf0f-9f173302950d','1','GBP','PAID',NULL,'2026-01-07T11:36:41.020Z','2026-01-07T11:36:41.034Z','2026-01-07T11:37:11.286Z');
INSERT INTO "transactions" VALUES(83,'membership_charge',49,10,'ncalamaro+test5@gmail.com','Nicky','ca905200-c98f-4ca2-a500-d8d7282d9334-charge',NULL,'ccc3199d-51b5-4610-bf0f-9f173302950d','1','GBP','PAID',NULL,NULL,'2026-01-07T11:37:11.173Z',NULL);
INSERT INTO "transactions" VALUES(84,'membership',50,11,'ncalamaro+test6@gmail.com','Nick','675f6008-f803-460a-bd8c-9b673ee8b7db','53ee7df3-8271-44d7-915c-964aee3391ef','53ee7df3-8271-44d7-915c-964aee3391ef','1','GBP','PAID',NULL,'2026-01-07T11:45:49.712Z','2026-01-07T11:45:49.732Z','2026-01-07T11:46:21.818Z');
INSERT INTO "transactions" VALUES(85,'membership',51,50,'ncalamaro+999@gmail.com','Nick','562ac719-09c9-4c25-b49f-32245115e67e','0640af76-b4e0-48d5-b4b5-17e6f2323d62','57c66ac3-4269-4cd8-aabd-de5ed30e1994','1','GBP','PAID',NULL,'2026-01-07T11:54:26.413Z','2026-01-07T11:54:26.435Z','2026-01-07T11:56:17.914Z');
INSERT INTO "transactions" VALUES(86,'membership_charge',51,50,'ncalamaro+999@gmail.com','Nick','562ac719-09c9-4c25-b49f-32245115e67e-charge',NULL,'57c66ac3-4269-4cd8-aabd-de5ed30e1994','1','GBP','PAID',NULL,NULL,'2026-01-07T11:56:17.807Z',NULL);
INSERT INTO "transactions" VALUES(87,'renewal',51,50,'ncalamaro+999@gmail.com','Nick','RENEWAL-51-1bc11180-326d-4c6f-9651-b8d38cb99df4',NULL,'27255afa-6b6c-410a-b354-f3f68a4c1253','1','GBP','PAID',NULL,NULL,'2026-01-07T11:57:09.738Z',NULL);
INSERT INTO "transactions" VALUES(88,'membership',52,51,'ncalamaro+099@gmail.com','Nick','d636092d-707a-4c4c-82ed-b4b7c20986c3','e727a5bd-6c27-4aa8-a9b2-52409b88d50e','12d3695a-f281-4d4e-94a1-e97be7eacb42','1','GBP','PAID',NULL,'2026-01-07T12:31:55.016Z','2026-01-07T12:31:55.013Z','2026-01-07T12:32:55.315Z');
INSERT INTO "transactions" VALUES(89,'membership_charge',52,51,'ncalamaro+099@gmail.com','Nick','d636092d-707a-4c4c-82ed-b4b7c20986c3-charge',NULL,'12d3695a-f281-4d4e-94a1-e97be7eacb42','1','GBP','PAID',NULL,NULL,'2026-01-07T12:32:55.180Z',NULL);
CREATE TABLE products (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        name TEXT NOT NULL,
        slug TEXT UNIQUE NOT NULL,
        description TEXT,
        price INTEGER NOT NULL,
        currency TEXT DEFAULT 'GBP',
        stock_quantity INTEGER DEFAULT 0,
        image_url TEXT,
        category TEXT,
        is_active INTEGER DEFAULT 1,
        created_at TEXT NOT NULL DEFAULT (strftime('%Y-%m-%dT%H:%M:%fZ','now')),
        updated_at TEXT NOT NULL DEFAULT (strftime('%Y-%m-%dT%H:%M:%fZ','now'))
      , summary TEXT, full_description TEXT, release_date TEXT);
INSERT INTO "products" VALUES(1,'Warhammer 40K Starter Set','wh40k-starter-set','Complete starter set',8500,'GBP',5,NULL,'Miniatures',0,'2025-11-27T18:19:56.474Z','2025-12-11T14:52:33.126Z','Complete starter set',NULL,NULL);
INSERT INTO "products" VALUES(2,'Premium Metal Dice Set','metal-dice-set','High-quality metal dice set',100,'GBP',17,NULL,'Accessories',0,'2025-11-27T18:19:56.932Z','2025-12-11T12:33:03.765Z','High-quality metal dice set',NULL,NULL);
INSERT INTO "products" VALUES(3,'Deep Sea Adventure','deep-sea-adventure','Classic strategy game',2000,'GBP',1,'https://pub-631ca6f207ca4661ac9cb2ba9371ba31.r2.dev/1765469220468-xfm04e.jpg','Board Games',1,'2025-11-27T18:19:57.420Z','2025-12-11T16:07:02.470Z','Risky treasure hunting in the depths of the sea...','<div>A group of adventurers got together on a submarine to try and gather the treasures that sleep at the bottom of the sea. Everyone geared up in diver suits, but having a very old submarine means sharing the same oxygen tank. If one of them dives too deep, the other divers'' lives will be on the line! Will the adventurers make it back to the submarine safely?</div>',NULL);
INSERT INTO "products" VALUES(4,'Avatar: The Last Airbender  Play Booster Box','avatar-the-last-airbender-play-booster-box',NULL,14000,'GBP',3,'https://pub-631ca6f207ca4661ac9cb2ba9371ba31.r2.dev/1765464324755-qinp81.jpg','Card Games,Magic: The Gathering',1,'2025-12-11T13:39:54.644Z','2025-12-11T16:07:45.915Z','Sealed Box Containing 30x Play Boosters from Avatar: The Last Airbender','<div>Team Avatar is back! The action, adventure, and spirit of Avatar: The Last Airbender awaken in Magic: The Gathering. Master new mechanics Earthbending, Airbendending, Waterbending and Firebending to tell your version of the story and discover your Magic playstyle. Bend the elements. Master the game. Play Boosters are the ideal way to experience Magic: The Gathering | Avatar: The Last Airbender in a play setting. Perfect for Limited events or casual games with friends, each pack supports fun deck building and play-and includes at least one foil card to discover.</div>',NULL);
INSERT INTO "products" VALUES(5,'Lorwyn Eclipsed - Play Booster Box','lorwyn-eclipsed-play-booster-box',NULL,13500,'GBP',3,'https://pub-631ca6f207ca4661ac9cb2ba9371ba31.r2.dev/1765465386231-wind3l.jpg','Card Games,Magic: The Gathering',1,'2025-12-11T15:03:09.149Z','2025-12-11T16:08:01.254Z','Sealed Box Containing 30x Play Boosters From Lorwyn Eclipsed','<div>Dare to enter the ever-changing plane of Lorwyn and Shadowmoor. Summon beloved Kithkin, boggarts, merrow, and Elves, that feature new and returning mechanics as well as art from new and returning Lorwyn artists! Discover your true self by crossing the boundary of eternal day into eternal night and rise triumphant as a master of order and chaos.</div><div><br></div><div>Play Boosters are the ideal booster for the play environment, especially Limited format events. Whether players are drafting with friends, questing for Booster Fun, or simply expanding their collection, they''ll find that Play Boosters have something for everyone.</div><div><br></div>','2026-01-23');
INSERT INTO "products" VALUES(6,'Nana 25th Anniversary - Volume 1','nana-25th-anniversary-volume-1',NULL,2000,'GBP',1,'https://pub-631ca6f207ca4661ac9cb2ba9371ba31.r2.dev/1765467013387-9dl4lz.jpg','Books,Manga',1,'2025-12-11T15:30:17.560Z','2025-12-11T16:05:39.880Z','The hit manga returns for the 25th anniversary!','',NULL);
INSERT INTO "products" VALUES(7,'Gunslinger in the Abyss Booster Box','gunslinger-in-the-abyss-booster-box',NULL,6000,'GBP',1,'https://pub-631ca6f207ca4661ac9cb2ba9371ba31.r2.dev/1765469902717-93upkz.jpg','Card Games,Final Fantasy TCG',1,'2025-12-11T16:18:31.598Z','2025-12-11T16:18:31.598Z','Sealed Box Containing 18x Booster Packs for Final Fantasy TCG ','<div>Packed with attractive cards ranging from striking centerpieces to great supporting units while improving further on the Limit Break system, Gunslinger in the Abyss is here to hit the mark.</div><div><br></div><div>Many emblematic characters will be making their grand entrance, like The Twelve &amp; The First Brood from FINAL FANTASY XIV, along with new Primals expanding the game universe and allowing you to experiment with exciting new deck archetypes.</div><div><br></div><div>This edition also comes with a whopping 38 newly illustrated cards, the largest number seen in FFTCG history to date. As an extremely rare Special Card, weve included Bartz [26-053L], newly illustrated by Toshiyuki Itahana. This marks the first time that Itahana-sans signature was foil-stamped.</div><div><br></div><div>Furthermore, 3 previous Legend cards will return as special Legacy full-arts which can be added to your collection and also used to add that extra bit of flair to your deck during tournaments.</div><div><br></div><div>Gunslinger in the Abyss takes FFTCG to new heights and is sure to resonate with many FINAL FANTASY fans and card game players.</div>',NULL);
CREATE TABLE orders (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        order_number TEXT UNIQUE NOT NULL,
        user_id INTEGER,
        email TEXT NOT NULL,
        name TEXT NOT NULL,
        status TEXT DEFAULT 'pending',
        subtotal INTEGER NOT NULL,
        tax INTEGER DEFAULT 0,
        shipping INTEGER DEFAULT 0,
        total INTEGER NOT NULL,
        currency TEXT DEFAULT 'GBP',
        checkout_id TEXT,
        payment_id TEXT,
        payment_status TEXT,
        shipping_address TEXT,
        billing_address TEXT,
        notes TEXT,
        created_at TEXT NOT NULL DEFAULT (strftime('%Y-%m-%dT%H:%M:%fZ','now')),
        updated_at TEXT NOT NULL DEFAULT (strftime('%Y-%m-%dT%H:%M:%fZ','now')),
        completed_at TEXT
      );
INSERT INTO "orders" VALUES(1,'ORD-1764273300695-6T8YOF',NULL,'ncalamaro@gmail.com','Nicholas Calamaro','pending',4200,0,0,4200,'GBP','4f8aa66d-e28d-4d1e-9a49-d681ea2b9db4',NULL,'pending',NULL,NULL,NULL,'2025-11-27T19:55:00.838Z','2025-11-27T19:55:00.838Z',NULL);
INSERT INTO "orders" VALUES(2,'ORD-1764274096392-NBUC6K',NULL,'ncalamaro@gmail.com','Nicholas Calamaro','pending',4200,0,0,4200,'GBP',NULL,NULL,'pending',NULL,NULL,NULL,'2025-11-27T20:08:16.392Z','2025-11-27T20:08:16.392Z',NULL);
INSERT INTO "orders" VALUES(3,'ORD-1764277284934-V4DPJE',NULL,'ncalamaro@gmail.com','Nicholas Calamaro','pending',3500,0,0,3500,'GBP',NULL,NULL,'pending',NULL,NULL,NULL,'2025-11-27T21:01:24.934Z','2025-11-27T21:01:24.934Z',NULL);
INSERT INTO "orders" VALUES(4,'ORD-1764279892395-LL96FX',NULL,'ncalamaro@gmail.com','Nicholas Calamaro','pending',100,0,0,100,'GBP',NULL,NULL,'pending',NULL,NULL,NULL,'2025-11-27T21:44:52.395Z','2025-11-27T21:44:52.395Z',NULL);
INSERT INTO "orders" VALUES(5,'ORD-1764279948702-ZQ1J1K',NULL,'ncalamaro@gmail.com','Nicholas Calamaro','pending',100,0,0,100,'GBP',NULL,NULL,'pending',NULL,NULL,NULL,'2025-11-27T21:45:48.702Z','2025-11-27T21:45:48.702Z',NULL);
INSERT INTO "orders" VALUES(6,'ORD-1764280135471-XVIV2Y',NULL,'ncalamaro@gmail.com','Nicholas Calamaro','pending',100,0,0,100,'GBP',NULL,NULL,'pending',NULL,NULL,NULL,'2025-11-27T21:48:55.471Z','2025-11-27T21:48:55.471Z',NULL);
INSERT INTO "orders" VALUES(7,'ORD-1764280150282-7JFM4N',NULL,'ncalamaro@gmail.com','Nicholas Calamaro','pending',100,0,0,100,'GBP',NULL,NULL,'pending',NULL,NULL,NULL,'2025-11-27T21:49:10.282Z','2025-11-27T21:49:10.282Z',NULL);
INSERT INTO "orders" VALUES(8,'ORD-1764280167605-8XKEU8',NULL,'ncalamaro@gmail.com','Nicholas Calamaro','pending',100,0,0,100,'GBP',NULL,NULL,'pending',NULL,NULL,NULL,'2025-11-27T21:49:27.605Z','2025-11-27T21:49:27.605Z',NULL);
INSERT INTO "orders" VALUES(9,'ORD-1764280252199-T5M2SX',NULL,'ncalamaro@gmail.com','Nicholas Calamaro','pending',100,0,0,100,'GBP',NULL,NULL,'pending',NULL,NULL,NULL,'2025-11-27T21:50:52.199Z','2025-11-27T21:50:52.199Z',NULL);
INSERT INTO "orders" VALUES(10,'ORD-1764280295181-P2GC1V',NULL,'ncalamaro@gmail.com','Nicholas Calamaro','completed',100,0,0,100,'GBP','d4ed55ce-b69a-460b-b131-ef15177273d6',NULL,'paid',NULL,NULL,NULL,'2025-11-27T21:51:35.181Z','2025-11-27T21:53:59.063Z','2025-11-27T21:53:59.063Z');
INSERT INTO "orders" VALUES(11,'ORD-1764280513247-H5KY62',NULL,'ncalamaro@gmail.com','Nicholas Calamaro','completed',100,0,0,100,'GBP','81635a11-f364-49f3-ad01-a2e667e05104',NULL,'paid',NULL,NULL,NULL,'2025-11-27T21:55:13.247Z','2025-11-27T21:56:03.739Z','2025-11-27T21:56:03.739Z');
INSERT INTO "orders" VALUES(12,'ORD-1764347326060-WJQ970',NULL,'ncalamaro@gmail.com','Nicholas Nicholas','completed',100,0,0,100,'GBP','3ee79a39-93b4-4827-8026-0884cf4f2351',NULL,'paid',NULL,NULL,NULL,'2025-11-28T16:28:46.060Z','2025-11-28T16:29:13.625Z','2025-11-28T16:29:13.625Z');
INSERT INTO "orders" VALUES(13,'ORD-1765228802634-GCKCXM',NULL,'ncalamaro@gmail.com','Nicholas Nicholas','pending',100,0,0,100,'GBP','66f805d0-941b-4add-bd11-65500587a297',NULL,'pending',NULL,NULL,NULL,'2025-12-08T21:20:02.634Z','2025-12-08T21:20:02.634Z',NULL);
INSERT INTO "orders" VALUES(14,'ORD-1765481296903-KIBVSG',NULL,'ncalamaro@gmail.com','Nicholas Nicholas','pending',42000,0,400,42400,'GBP','c61505a0-77fd-40c3-b2cc-71913375b606',NULL,'pending','{"line1":"4 Artificer House","line2":"Tarik Views","city":"Gibraltar","postcode":"GX11 1AA","country":"GI"}','{"line1":"4 Artificer House","line2":"Tarik Views","city":"Gibraltar","postcode":"GX11 1AA","country":"GI"}',NULL,'2025-12-11T19:28:16.903Z','2025-12-11T19:28:16.903Z',NULL);
INSERT INTO "orders" VALUES(15,'ORD-1766178829684-WU4BFT',NULL,'ncalamaro@gmail.com','Nicholas Nicholas','pending',14000,0,0,14000,'GBP','9f3a3353-996d-4134-8f67-59c05c132e3a',NULL,'pending',NULL,NULL,NULL,'2025-12-19T21:13:49.684Z','2025-12-19T21:13:49.684Z',NULL);
CREATE TABLE order_items (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        order_id INTEGER NOT NULL,
        product_id INTEGER NOT NULL,
        product_name TEXT NOT NULL,
        quantity INTEGER NOT NULL,
        unit_price INTEGER NOT NULL,
        subtotal INTEGER NOT NULL,
        FOREIGN KEY (order_id) REFERENCES orders(id),
        FOREIGN KEY (product_id) REFERENCES products(id)
      );
INSERT INTO "order_items" VALUES(1,1,3,'Catan Board Game',1,4200,4200);
INSERT INTO "order_items" VALUES(2,2,3,'Catan Board Game',1,4200,4200);
INSERT INTO "order_items" VALUES(3,3,2,'Premium Metal Dice Set',1,3500,3500);
INSERT INTO "order_items" VALUES(4,4,2,'Premium Metal Dice Set',1,100,100);
INSERT INTO "order_items" VALUES(5,5,2,'Premium Metal Dice Set',1,100,100);
INSERT INTO "order_items" VALUES(6,6,2,'Premium Metal Dice Set',1,100,100);
INSERT INTO "order_items" VALUES(7,7,2,'Premium Metal Dice Set',1,100,100);
INSERT INTO "order_items" VALUES(8,8,2,'Premium Metal Dice Set',1,100,100);
INSERT INTO "order_items" VALUES(9,9,2,'Premium Metal Dice Set',1,100,100);
INSERT INTO "order_items" VALUES(10,10,2,'Premium Metal Dice Set',1,100,100);
INSERT INTO "order_items" VALUES(11,11,2,'Premium Metal Dice Set',1,100,100);
INSERT INTO "order_items" VALUES(12,12,2,'Premium Metal Dice Set',1,100,100);
INSERT INTO "order_items" VALUES(13,13,2,'Premium Metal Dice Set',1,100,100);
INSERT INTO "order_items" VALUES(14,14,4,'Avatar: The Last Airbender  Play Booster Box',3,14000,42000);
INSERT INTO "order_items" VALUES(15,15,4,'Avatar: The Last Airbender  Play Booster Box',1,14000,14000);
CREATE TABLE cart_items (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        session_id TEXT NOT NULL,
        product_id INTEGER NOT NULL,
        quantity INTEGER NOT NULL DEFAULT 1,
        created_at TEXT NOT NULL DEFAULT (strftime('%Y-%m-%dT%H:%M:%fZ','now')),
        updated_at TEXT NOT NULL DEFAULT (strftime('%Y-%m-%dT%H:%M:%fZ','now')),
        UNIQUE(session_id, product_id),
        FOREIGN KEY (product_id) REFERENCES products(id)
      );
CREATE TABLE user_sessions (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  user_id INTEGER NOT NULL,
  session_token TEXT UNIQUE NOT NULL,
  expires_at TEXT NOT NULL,
  created_at TEXT NOT NULL DEFAULT (strftime('%Y-%m-%dT%H:%M:%fZ','now')), last_activity TEXT,
  FOREIGN KEY (user_id) REFERENCES users(user_id) ON DELETE CASCADE
);
INSERT INTO "user_sessions" VALUES(1,1,'8371d726fdf97b631ab6d6d78e85ffb0ad99e0381ebd3c781a4d77be2d177a12','2025-12-18T12:17:15.385Z','2025-12-11T12:17:15.385Z','2025-12-11T12:17:15.385Z');
INSERT INTO "user_sessions" VALUES(2,1,'8f3dde815ad4a5c990dcb3b13ee6801a0a476fd2fec2eea58a56d394166f0b6d','2025-12-18T12:19:25.546Z','2025-12-11T12:19:25.546Z','2025-12-11T12:19:25.546Z');
INSERT INTO "user_sessions" VALUES(3,1,'4501f2cede0124489659be8f7f4ea7aba053094c3469996299802fdd43d849d2','2025-12-18T12:19:34.394Z','2025-12-11T12:19:34.394Z','2025-12-11T12:19:34.394Z');
INSERT INTO "user_sessions" VALUES(4,1,'54dece0558541540a82e446d3c390d384734f70e96c5d074d0c9e9ca9ef77c86','2025-12-18T12:19:36.635Z','2025-12-11T12:19:36.635Z','2025-12-11T12:19:36.635Z');
INSERT INTO "user_sessions" VALUES(10,1,'000ce928eea296bfe034c8a87843addfc38183a2acd3f499d240e8c4dd6bb12d','2025-12-18T14:33:28.063Z','2025-12-11T14:33:28.063Z','2025-12-11T14:33:28.063Z');
INSERT INTO "user_sessions" VALUES(12,1,'a060320d657b63c9c7dd7a83fd82029f14882ed2dddd093611180a34f7a26918','2025-12-18T15:29:23.908Z','2025-12-11T15:29:23.908Z','2025-12-11T15:29:23.908Z');
INSERT INTO "user_sessions" VALUES(15,1,'eaa45ee0cf79e239879c33d6a9114e99a3b9699f3ec211af7dbc0feeade92a23','2025-12-19T13:13:40.116Z','2025-12-12T13:13:40.116Z','2025-12-12T13:13:40.116Z');
INSERT INTO "user_sessions" VALUES(16,1,'49f9f8e636458901a264d1d02ee5ffa945020374dd0627cee43ba1bc2fa49003','2025-12-22T15:39:17.466Z','2025-12-15T15:39:17.466Z','2025-12-15T15:39:17.466Z');
INSERT INTO "user_sessions" VALUES(17,1,'ad8504832194d2cfb45adaad59b9e8379a6b9860af03e7820e20a0653fa94270','2026-01-01T12:14:24.584Z','2025-12-25T12:14:24.584Z','2025-12-25T12:14:24.584Z');
INSERT INTO "user_sessions" VALUES(18,1,'a33076fd9bb3dd2d3221d4482cf43077f84bb24c5439a38c647279fcf135cf42','2026-01-10T18:45:05.457Z','2026-01-03T18:45:05.457Z','2026-01-03T18:45:05.457Z');
INSERT INTO "user_sessions" VALUES(19,1,'934c4514bf1a8ce2a9ba535202d5e57dc36c53e10e824fcc38475ca06e79a763','2026-01-12T11:14:55.013Z','2026-01-05T11:14:55.013Z','2026-01-05T11:14:55.013Z');
INSERT INTO "user_sessions" VALUES(20,1,'92d0663759b80688cc8eb584f3ce81084f3414a548f8042e3bcd6fa868f784fe','2026-01-12T17:18:11.056Z','2026-01-05T17:18:11.056Z','2026-01-05T17:18:11.056Z');
INSERT INTO "user_sessions" VALUES(23,1,'03e752cd-5e10-40b0-92d1-88a0b655b3c2','2026-01-13T12:59:19.779Z','2026-01-06T12:59:19.779Z','2026-01-06T12:59:19.779Z');
INSERT INTO "user_sessions" VALUES(24,1,'28d6c963-2434-4526-a3a9-089e601cfc4c','2026-01-13T12:59:34.203Z','2026-01-06T12:59:34.203Z','2026-01-06T12:59:34.203Z');
INSERT INTO "user_sessions" VALUES(25,1,'3b08b04c-bc8e-40fc-8913-dd98186cbdbb','2026-01-13T12:59:52.328Z','2026-01-06T12:59:52.328Z','2026-01-06T12:59:52.328Z');
INSERT INTO "user_sessions" VALUES(26,1,'37e898eb-19f2-46f5-b3f2-ff5292d801f0','2026-01-13T13:36:45.251Z','2026-01-06T13:36:45.251Z','2026-01-06T13:36:45.251Z');
INSERT INTO "user_sessions" VALUES(27,1,'54dd72f2-94bc-49ed-950a-8d91a2cd1778','2026-01-13T13:36:50.941Z','2026-01-06T13:36:50.941Z','2026-01-06T13:36:50.941Z');
INSERT INTO "user_sessions" VALUES(28,1,'ac271f4c-bcb1-4cfc-985f-7fb9a30ba756','2026-01-13T13:37:01.786Z','2026-01-06T13:37:01.786Z','2026-01-06T13:37:01.786Z');
INSERT INTO "user_sessions" VALUES(29,1,'1d7b2bd3-8094-4f11-80dd-7cd60967afb3','2026-01-13T13:38:09.490Z','2026-01-06T13:38:09.490Z','2026-01-06T13:38:09.490Z');
INSERT INTO "user_sessions" VALUES(30,1,'7f76b04b-932d-4f3c-8d22-b74666874f2b','2026-01-13T13:38:27.342Z','2026-01-06T13:38:27.342Z','2026-01-06T13:38:27.342Z');
INSERT INTO "user_sessions" VALUES(31,1,'c7d82765-6628-4e6b-9cc2-1176c5d12b77','2026-01-13T14:31:07.757Z','2026-01-06T14:31:07.757Z','2026-01-06T14:31:07.757Z');
INSERT INTO "user_sessions" VALUES(34,3,'e018bdb1-2e38-4fe1-bf69-2a7ece12b4e0','2026-01-13T14:55:03.142Z','2026-01-06T14:55:03.142Z','2026-01-06T14:55:03.142Z');
INSERT INTO "user_sessions" VALUES(35,3,'d1969dbd-2577-43b3-bc5b-2180db557a8e','2026-01-13T14:55:42.430Z','2026-01-06T14:55:42.430Z','2026-01-06T14:55:42.430Z');
INSERT INTO "user_sessions" VALUES(39,3,'357e02a7-31e8-4dc1-856b-4b0ce1917644','2026-01-14T00:09:56.953Z','2026-01-07T00:09:56.953Z','2026-01-07T00:09:56.953Z');
INSERT INTO "user_sessions" VALUES(42,1,'e55d2053-8ab6-4590-bcff-3a443c6a8144','2026-01-14T08:50:20.423Z','2026-01-07T08:50:20.423Z','2026-01-07T09:03:11.594Z');
CREATE TABLE d1_migrations(
		id         INTEGER PRIMARY KEY AUTOINCREMENT,
		name       TEXT UNIQUE,
		applied_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL
);
CREATE TABLE IF NOT EXISTS "events" (
    event_id INTEGER PRIMARY KEY AUTOINCREMENT,
    event_name TEXT NOT NULL,
    description TEXT,
    event_datetime TEXT NOT NULL,
    location TEXT,
    membership_price REAL NOT NULL DEFAULT 0,
    non_membership_price REAL NOT NULL DEFAULT 0,
    capacity INTEGER,
    tickets_sold INTEGER DEFAULT 0,
    category TEXT,
    image_url TEXT,
    created_at TEXT DEFAULT CURRENT_TIMESTAMP,
    updated_at TEXT DEFAULT CURRENT_TIMESTAMP,
    slug TEXT,
    full_description TEXT,
    requires_purchase INTEGER DEFAULT 1,
    is_active INTEGER DEFAULT 1
, is_recurring INTEGER DEFAULT 0, recurrence_pattern TEXT, recurrence_end_date TEXT);
INSERT INTO "events" VALUES(44,'MTG - Standard Showdown',NULL,'2026-02-07T10:00:00',NULL,5,10,NULL,0,NULL,'https://pub-631ca6f207ca4661ac9cb2ba9371ba31.r2.dev/1765545496497-w0s9bv.jpg','2025-12-12 10:15:17','2025-12-12 10:15:17','mtg-standard-showdown',NULL,1,1,0,NULL,NULL);
INSERT INTO "events" VALUES(46,'Board Game Open Day',NULL,'2025-01-01T14:00:00',NULL,0,0,NULL,0,NULL,'https://pub-631ca6f207ca4661ac9cb2ba9371ba31.r2.dev/1765618622505-sjw1ow.jpg','2025-12-13 09:37:04','2025-12-13 09:37:04','board-game-open-day',NULL,0,1,1,'{"type":"monthly_day","time":"14:00","week":1,"day":0}',NULL);
INSERT INTO "events" VALUES(47,'Weekly Club Night',NULL,'2025-01-01T18:00:00',NULL,0,0,NULL,0,NULL,'https://pub-631ca6f207ca4661ac9cb2ba9371ba31.r2.dev/1765620240073-4pbe19.jpg','2025-12-13 10:04:04','2025-12-13 10:04:04','weekly-club-night',NULL,0,1,1,'{"type":"weekly","time":"18:00","day":5}',NULL);
INSERT INTO "events" VALUES(50,'MTG - Lorwyn Eclipsed Release Event','Dare to enter the ever-changing plane of Lorwyn and Shadowmoor. Get 6 boosters from the new set featuring new and returning mechanics as well as art from new and returning Lorwyn artists! Compete for prizes as you cross boundary of eternal day into eternal night and rise triumphant as a master of order and chaos.','2026-01-23T18:00:00',NULL,30,35,NULL,0,NULL,'https://pub-631ca6f207ca4661ac9cb2ba9371ba31.r2.dev/1765637576339-qinjoq.jpg','2025-12-13 12:45:30','2025-12-13 12:45:30','mtg-lorwyn-eclipsed-release-event',NULL,1,1,0,NULL,NULL);
INSERT INTO "events" VALUES(51,'Pokemon Day! ',replace('Our annual Pokmon Day celebration in aid of Childline Gibraltar. \n\nPokmon themed activities, board games, snacks and fun for the whole family! ','\n',char(10)),'2026-02-28T11:00:00',NULL,0,0,NULL,0,NULL,'https://pub-631ca6f207ca4661ac9cb2ba9371ba31.r2.dev/1765639087919-1ubcfv.jpg','2025-12-13 14:44:37','2025-12-13 14:44:37','pokemon-day','Join us for our annual Pokmon Day celebration down at the Gibraltar Warhammer club.<div><br></div><div>We''ll have Pokmon themed activities, board games, snacks and fun for the whole family!&nbsp;</div><div><br></div><div>All proceeds raised on the day go to Childline who provide listening services for children and teenagers, appropriate adult services for young people dealing with the authorities, and family support for parents and guardians.</div><div><br></div><div>Check them out now at&nbsp;<a href="https://childline.gi/">https://childline.gi/</a></div>',0,1,0,NULL,NULL);
INSERT INTO "events" VALUES(52,'Unmatched Battle Royale','A miniature fighting game where everyone can play completely different characters and where every box is mix-and-matchable.','2026-01-18T16:00:00',NULL,0,0,NULL,0,NULL,'https://pub-631ca6f207ca4661ac9cb2ba9371ba31.r2.dev/1767612051736-myffs3.jpg','2026-01-03 18:47:59','2026-01-03 18:47:59','unmatched-battle-royale','<b> 20 - 120 Minutes</b><div><b> 2 - 8 Players</b></div><div><br></div><div>A miniature fighting game where everyone can play completely different characters and where every box is mix-and-matchable. You move your fighters across the board and can fight players using attack, defence or versatile cards, plus instant cards with some fun effects. Every character has a unique play style, and the games are quick and easy. There are team-mode options too.</div><div><br></div><div><b>Characters available: </b>Shakespeare, The Wayward Sisters, Hamlet, and Titania. King Arthur, Alice from Wonderland, Medusa and Sinbad. Velociraptors, Muldoon, Ellie Sattler and T. Rex, Little Red Riding Hood and Beowulf.</div>',0,1,0,NULL,NULL);
INSERT INTO "events" VALUES(53,'Horusy Heresy - Forge of War',replace('3000pts <br>\n3 (3 Hour) Games <br>\nNo Allies <br>\nNo Primarchs','\n',char(10)),'2026-01-17T10:00:00',NULL,0,0,NULL,0,NULL,'https://pub-631ca6f207ca4661ac9cb2ba9371ba31.r2.dev/1767611835491-9sce25.jpg','2026-01-05 11:17:42','2026-01-05 11:17:42','horusy-heresy-forge-of-war','We will be playing the Gibraltar Grand Tournament rules and some of the missions of the event as well. Missions will be published after list submission with is on the 10th.<div><br></div><div><div>Ticket 30 or 15 (SN Patreons)&nbsp;</div></div><div><br></div><div>Please contact Steven Pardo for tickets.</div>',0,1,0,NULL,NULL);
INSERT INTO "events" VALUES(54,'Test Event',NULL,'2030-12-31T10:00:00',NULL,1,1.5,NULL,3,NULL,NULL,'2026-01-05 17:18:34','2026-01-05 17:18:34','test-event',NULL,1,1,0,NULL,NULL);
CREATE TABLE email_history (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        email_type TEXT NOT NULL,
        recipient_email TEXT NOT NULL,
        recipient_name TEXT,
        subject TEXT NOT NULL,
        template_used TEXT NOT NULL,
        related_id INTEGER,
        related_type TEXT,
        sent_at TEXT NOT NULL DEFAULT (strftime('%Y-%m-%dT%H:%M:%fZ','now')),
        status TEXT DEFAULT 'sent',
        error_message TEXT,
        metadata TEXT
      );
INSERT INTO "email_history" VALUES(1,'test','nick@dicebastion.com',NULL,' Test Email from Dice Bastion Worker','test',NULL,'test','2026-01-05T23:55:51.564Z','sent',NULL,NULL);
INSERT INTO "email_history" VALUES(2,'event_ticket_confirmation','ncalamaro@gmail.com',NULL,'Ticket Confirmed: Test Event','event_ticket_confirmation',49,'ticket','2026-01-06T10:16:26.796Z','sent',NULL,'{"event_name":"Test Event"}');
INSERT INTO "email_history" VALUES(3,'admin_event_notification','admin@dicebastion.com',NULL,' ADMIN ALERT:  New Event Ticket Purchase: Test Event','admin_event_notification',49,'ticket','2026-01-06T10:16:27.115Z','sent',NULL,'{"event_name":"Test Event"}');
INSERT INTO "email_history" VALUES(4,'event_ticket_confirmation','ncalamaro+qkwkhtrbe@gmail.com',NULL,'Ticket Confirmed: Test Event','event_ticket_confirmation',50,'ticket','2026-01-06T10:20:28.614Z','sent',NULL,'{"event_name":"Test Event"}');
INSERT INTO "email_history" VALUES(5,'admin_event_notification','admin@dicebastion.com',NULL,' ADMIN ALERT:  New Event Ticket Purchase: Test Event','admin_event_notification',50,'ticket','2026-01-06T10:20:28.881Z','sent',NULL,'{"event_name":"Test Event"}');
INSERT INTO "email_history" VALUES(6,'event_ticket_confirmation','ncalamaro@gmail.com',NULL,'Ticket Confirmed: Test Event','event_ticket_confirmation',65,'ticket','2026-01-06T19:16:07.231Z','sent',NULL,'{"event_name":"Test Event"}');
INSERT INTO "email_history" VALUES(7,'admin_event_notification','admin@dicebastion.com',NULL,' ADMIN ALERT:  New Event Ticket Purchase: Test Event','admin_event_notification',65,'ticket','2026-01-06T19:16:07.510Z','sent',NULL,'{"event_name":"Test Event"}');
INSERT INTO "email_history" VALUES(8,'membership_renewal_failed','ncalamaro+447@gmail.com',NULL,'Action Required: Dice Bastion Membership Renewal Failed (Attempt 1/3)','membership_renewal_failed',23,'membership','2026-01-06T23:15:42.813Z','sent',NULL,'{"plan":"monthly","attempt_number":1}');
INSERT INTO "email_history" VALUES(9,'membership_welcome','ncalamaro+trest@gmail.com',NULL,'Welcome to Dice Bastion Monthly Membership!','membership_welcome',44,'membership','2026-01-07T11:00:08.198Z','sent',NULL,'{"plan":"monthly","auto_renew":1}');
INSERT INTO "email_history" VALUES(10,'admin_membership_notification','admin@dicebastion.com',NULL,' ADMIN ALERT:  New Membership Purchase: monthly Plan','admin_membership_notification',44,'membership','2026-01-07T11:00:08.443Z','sent',NULL,'{"plan":"monthly","amount":"1"}');
INSERT INTO "email_history" VALUES(11,'membership_welcome','ncalamaro+trest2@gmail.com',NULL,'Welcome to Dice Bastion Monthly Membership!','membership_welcome',45,'membership','2026-01-07T11:04:01.480Z','sent',NULL,'{"plan":"monthly","auto_renew":1}');
INSERT INTO "email_history" VALUES(12,'admin_membership_notification','admin@dicebastion.com',NULL,' ADMIN ALERT:  New Membership Purchase: monthly Plan','admin_membership_notification',45,'membership','2026-01-07T11:04:01.744Z','sent',NULL,'{"plan":"monthly","amount":"1"}');
INSERT INTO "email_history" VALUES(13,'membership_welcome','ncalamaro+trest3@gmail.com',NULL,'Welcome to Dice Bastion Monthly Membership!','membership_welcome',46,'membership','2026-01-07T11:15:26.409Z','sent',NULL,'{"plan":"monthly","auto_renew":1}');
INSERT INTO "email_history" VALUES(14,'admin_membership_notification','admin@dicebastion.com',NULL,' ADMIN ALERT:  New Membership Purchase: monthly Plan','admin_membership_notification',46,'membership','2026-01-07T11:15:26.647Z','sent',NULL,'{"plan":"monthly","amount":"1"}');
INSERT INTO "email_history" VALUES(15,'membership_welcome','ncalamaro+trest4@gmail.com',NULL,'Welcome to Dice Bastion Monthly Membership!','membership_welcome',47,'membership','2026-01-07T11:33:20.902Z','sent',NULL,'{"plan":"monthly","auto_renew":1}');
INSERT INTO "email_history" VALUES(16,'admin_membership_notification','admin@dicebastion.com',NULL,' ADMIN ALERT:  New Membership Purchase: monthly Plan','admin_membership_notification',47,'membership','2026-01-07T11:33:21.149Z','sent',NULL,'{"plan":"monthly","amount":"1"}');
INSERT INTO "email_history" VALUES(17,'membership_welcome','ncalamaro+test5@gmail.com',NULL,'Welcome to Dice Bastion Monthly Membership!','membership_welcome',49,'membership','2026-01-07T11:37:11.615Z','sent',NULL,'{"plan":"monthly","auto_renew":1}');
INSERT INTO "email_history" VALUES(18,'admin_membership_notification','admin@dicebastion.com',NULL,' ADMIN ALERT:  New Membership Purchase: monthly Plan','admin_membership_notification',49,'membership','2026-01-07T11:37:11.865Z','sent',NULL,'{"plan":"monthly","amount":"1"}');
INSERT INTO "email_history" VALUES(19,'membership_welcome','ncalamaro+test6@gmail.com',NULL,'Welcome to Dice Bastion Monthly Membership!','membership_welcome',50,'membership','2026-01-07T11:46:22.126Z','sent',NULL,'{"plan":"monthly","auto_renew":1}');
INSERT INTO "email_history" VALUES(20,'admin_membership_notification','admin@dicebastion.com',NULL,' ADMIN ALERT:  New Membership Purchase: monthly Plan','admin_membership_notification',50,'membership','2026-01-07T11:46:22.412Z','sent',NULL,'{"plan":"monthly","amount":"1"}');
INSERT INTO "email_history" VALUES(21,'membership_welcome','ncalamaro+999@gmail.com',NULL,'Welcome to Dice Bastion Monthly Membership!','membership_welcome',51,'membership','2026-01-07T11:56:18.357Z','sent',NULL,'{"plan":"monthly","auto_renew":1}');
INSERT INTO "email_history" VALUES(22,'admin_membership_notification','admin@dicebastion.com',NULL,' ADMIN ALERT:  New Membership Purchase: monthly Plan','admin_membership_notification',51,'membership','2026-01-07T11:56:18.625Z','sent',NULL,'{"plan":"monthly","amount":"1"}');
INSERT INTO "email_history" VALUES(23,'membership_renewal_success','ncalamaro+999@gmail.com',NULL,'Your Dice Bastion Monthly Membership Has Been Renewed','membership_renewal_success',51,'membership','2026-01-07T11:57:10.151Z','sent',NULL,'{"plan":"monthly","new_end_date":"2026-03-07T11:56:15.000Z"}');
INSERT INTO "email_history" VALUES(24,'membership_welcome','ncalamaro+099@gmail.com',NULL,'Welcome to Dice Bastion Monthly Membership!','membership_welcome',52,'membership','2026-01-07T12:32:55.770Z','sent',NULL,'{"plan":"monthly","auto_renew":1}');
INSERT INTO "email_history" VALUES(25,'admin_membership_notification','admin@dicebastion.com',NULL,' ADMIN ALERT:  New Membership Purchase: monthly Plan','admin_membership_notification',52,'membership','2026-01-07T12:32:56.042Z','sent',NULL,'{"plan":"monthly","amount":"1"}');
CREATE TABLE email_preferences (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  user_id INTEGER NOT NULL UNIQUE,
  essential_emails BOOLEAN DEFAULT 1,
  marketing_emails BOOLEAN DEFAULT 0,
  consent_given BOOLEAN DEFAULT 0,
  consent_date TEXT,
  last_updated TEXT NOT NULL DEFAULT (strftime('%Y-%m-%dT%H:%M:%fZ','now')),
  FOREIGN KEY (user_id) REFERENCES users(user_id)
);
CREATE TABLE cron_job_log (
  log_id INTEGER PRIMARY KEY AUTOINCREMENT,
  job_name TEXT NOT NULL,              -- e.g., 'auto_renewals', 'event_reminders', 'payment_reconciliation'
  started_at TEXT NOT NULL,            -- ISO timestamp when job started
  completed_at TEXT,                   -- ISO timestamp when job completed
  status TEXT NOT NULL DEFAULT 'running', -- 'running', 'completed', 'failed', 'partial'
  records_processed INTEGER DEFAULT 0, -- Count of items processed
  records_succeeded INTEGER DEFAULT 0, -- Count of successful operations
  records_failed INTEGER DEFAULT 0,    -- Count of failed operations
  error_message TEXT,                  -- Error details if status is 'failed'
  details TEXT,                        -- JSON string with additional details
  created_at TEXT NOT NULL DEFAULT (datetime('now'))
);
INSERT INTO "cron_job_log" VALUES(1,'auto_renewals','2026-01-07T02:00:28.601Z','2026-01-07T02:00:28.919Z','failed',0,0,0,'D1_ERROR: no such column: m.member_id at offset 56: SQLITE_ERROR','{"warnings_sent":0,"expired_count":0}','2026-01-07 02:00:28');
INSERT INTO "cron_job_log" VALUES(2,'event_reminders','2026-01-07T02:00:29.080Z','2026-01-07T02:00:29.119Z','failed',0,0,0,'D1_ERROR: no such table: event_tickets: SQLITE_ERROR','{}','2026-01-07 02:00:29');
INSERT INTO "cron_job_log" VALUES(3,'payment_reconciliation','2026-01-07T02:00:29.178Z','2026-01-07T02:00:29.214Z','failed',0,0,0,'D1_ERROR: no such table: checkout_sessions: SQLITE_ERROR','{}','2026-01-07 02:00:29');
INSERT INTO "cron_job_log" VALUES(4,'cron_master','2026-01-07T02:00:28.601Z','2026-01-07T02:00:29.273Z','completed',3,3,0,NULL,'{"auto_renewals":"completed","event_reminders":"completed","payment_reconciliation":"completed"}','2026-01-07 02:00:29');
DELETE FROM sqlite_sequence;
INSERT INTO "sqlite_sequence" VALUES('services',3);
INSERT INTO "sqlite_sequence" VALUES('users',51);
INSERT INTO "sqlite_sequence" VALUES('memberships',52);
INSERT INTO "sqlite_sequence" VALUES('tickets',65);
INSERT INTO "sqlite_sequence" VALUES('transactions',89);
INSERT INTO "sqlite_sequence" VALUES('payment_instruments',18);
INSERT INTO "sqlite_sequence" VALUES('renewal_log',3);
INSERT INTO "sqlite_sequence" VALUES('products',7);
INSERT INTO "sqlite_sequence" VALUES('orders',15);
INSERT INTO "sqlite_sequence" VALUES('order_items',15);
INSERT INTO "sqlite_sequence" VALUES('user_sessions',42);
INSERT INTO "sqlite_sequence" VALUES('events',54);
INSERT INTO "sqlite_sequence" VALUES('email_history',25);
INSERT INTO "sqlite_sequence" VALUES('cron_job_log',4);
CREATE INDEX idx_services_code ON services(code);
CREATE INDEX idx_memberships_idem ON memberships(idempotency_key);
CREATE INDEX idx_memberships_payment_status ON memberships(payment_status);
CREATE INDEX idx_memberships_user ON memberships(user_id);
CREATE INDEX idx_user_sessions_token ON user_sessions(session_token);
CREATE INDEX idx_user_sessions_expires ON user_sessions(expires_at);
CREATE UNIQUE INDEX idx_events_slug ON events(slug);
CREATE INDEX idx_cron_job_log_name_date 
  ON cron_job_log(job_name, started_at DESC);
CREATE INDEX idx_cron_job_log_status 
  ON cron_job_log(status, started_at DESC);
